<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="907px" preserveAspectRatio="none" style="width:2065px;height:907px;" version="1.1" viewBox="0 0 2065 907" width="2065px" zoomAndPan="magnify"><defs><filter height="300%" id="f1vjmits4kxfwy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="500" x="783.5" y="23.5352">1.1.4. Send notification to Participant (Payer/Payee) (batch messages)</text><rect fill="#D3D3D3" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="179" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="7" y="47.0566">Financial Service Provider</text><rect fill="#ADD8E6" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="241" x="476" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="518" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="862.1641" style="stroke: #A80036; stroke-width: 1.0;" width="1040" x="984" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="1453.5" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="619.9004" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="591.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="209.0859"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1207" y="317.0176"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="179.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1207" y="552.1914"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1411" y="346.3281"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1644" y="581.502"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="173.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1967" y="610.8125"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="605.9004" style="stroke: #000000; stroke-width: 2.0;" width="2020" x="34" y="170.7754"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="515.2793" style="stroke: #000000; stroke-width: 2.0;" width="2000" x="44" y="254.3965"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="1008.5" x="470" y="278.707"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="596" x2="596" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1061" x2="1061" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1212" x2="1212" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1415.5" x2="1415.5" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1529" x2="1529" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1649" x2="1649" y1="153.7754" y2="793.6758"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1972" x2="1972" y1="153.7754" y2="793.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="134.334">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="150.8223">Participant</text><ellipse cx="93.5" cy="63.7988" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,71.7988 L93.5,98.7988 M80.5,79.7988 L106.5,79.7988 M93.5,98.7988 L80.5,113.7988 M93.5,98.7988 L106.5,113.7988 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="64" y="806.2109">DFSP(n)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="54" y="822.6992">Participant</text><ellipse cx="93.5" cy="835.6523" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93.5,843.6523 L93.5,870.6523 M80.5,851.6523 L106.5,851.6523 M93.5,870.6523 L80.5,885.6523 M93.5,870.6523 L106.5,885.6523 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="480" y="150.8223">ML API Notification Event Handler</text><ellipse cx="596.5" cy="121.2871" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="592.5,109.2871,598.5,104.2871,596.5,109.2871,598.5,114.2871,592.5,109.2871" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="480" y="806.2109">ML API Notification Event Handler</text><ellipse cx="596.5" cy="825.1641" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="592.5,813.1641,598.5,808.1641,596.5,813.1641,598.5,818.1641,592.5,813.1641" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="992" y="114.2871"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="988" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="995" y="138.8223">Notification-Topic</text><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="992" y="792.6758"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="988" y="796.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="995" y="817.2109">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1145" y="150.8223">Central Service API</text><path d="M1191.5,109.2871 L1191.5,133.2871 M1191.5,121.2871 L1208.5,121.2871 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1220.5" cy="121.2871" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1145" y="806.2109">Central Service API</text><path d="M1191.5,813.1641 L1191.5,837.1641 M1191.5,825.1641 L1208.5,825.1641 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1220.5" cy="825.1641" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1367.5" y="114.2871"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1363.5" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1370.5" y="138.8223">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1367.5" y="792.6758"/><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1363.5" y="796.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="1370.5" y="817.2109">Event-Topic</text><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="1479" y="118.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1486" y="138.8223">EVENT_DAO</text><rect fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="96" x="1479" y="792.6758"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="1486" y="813.2109">EVENT_DAO</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1589" y="150.8223">Notification DAO</text><ellipse cx="1649" cy="121.2871" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1637" x2="1661" y1="135.2871" y2="135.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="1589" y="806.2109">Notification DAO</text><ellipse cx="1649" cy="825.1641" fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1637" x2="1661" y1="839.1641" y2="839.1641"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1924" y="150.8223">Central Store</text><path d="M1954,101.2871 C1954,91.2871 1972,91.2871 1972,91.2871 C1972,91.2871 1990,91.2871 1990,101.2871 L1990,127.2871 C1990,137.2871 1972,137.2871 1972,137.2871 C1972,137.2871 1954,137.2871 1954,127.2871 L1954,101.2871 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1954,101.2871 C1954,111.2871 1972,111.2871 1972,111.2871 C1972,111.2871 1990,111.2871 1990,101.2871 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="1924" y="806.2109">Central Store</text><path d="M1954,819.1641 C1954,809.1641 1972,809.1641 1972,809.1641 C1972,809.1641 1990,809.1641 1990,819.1641 L1990,845.1641 C1990,855.1641 1972,855.1641 1972,855.1641 C1972,855.1641 1954,855.1641 1954,845.1641 L1954,819.1641 " fill="#FEFECE" filter="url(#f1vjmits4kxfwy)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1954,819.1641 C1954,829.1641 1972,829.1641 1972,829.1641 C1972,829.1641 1990,829.1641 1990,819.1641 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="619.9004" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="591.5" y="163.7754"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1056.5" y="209.0859"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="198.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1207" y="317.0176"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="179.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1207" y="552.1914"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="140.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1411" y="346.3281"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="121.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1644" y="581.502"/><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="173.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1967" y="610.8125"/><rect fill="none" height="605.9004" style="stroke: #000000; stroke-width: 2.0;" width="2020" x="34" y="170.7754"/><polygon fill="#EEEEEE" points="34,170.7754,286,170.7754,286,177.7754,276,187.7754,34,187.7754,34,170.7754" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="49" y="184.3438">Send notification to Participant</text><polygon fill="#A80036" points="1044.5,205.0859,1054.5,209.0859,1044.5,213.0859,1048.5,209.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="601.5" x2="1050.5" y1="209.0859" y2="209.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="608.5" y="204.6543">1</text><text fill="#FF0000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="423" x="621.5" y="204.6543">Consume Notifications event batch of messages for Participant</text><rect fill="none" height="515.2793" style="stroke: #000000; stroke-width: 2.0;" width="2000" x="44" y="254.3965"/><polygon fill="#EEEEEE" points="44,254.3965,118,254.3965,118,261.3965,108,271.3965,44,271.3965,44,254.3965" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="59" y="267.9648">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="133" y="267.0313">[for each message in batch]</text><rect fill="none" height="245.4844" style="stroke: #000000; stroke-width: 2.0;" width="1008.5" x="470" y="278.707"/><polygon fill="#EEEEEE" points="470,278.707,685,278.707,685,285.707,675,295.707,470,295.707,470,278.707" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="485" y="292.2754">Persist Event Information</text><polygon fill="#A80036" points="1195,313.0176,1205,317.0176,1195,321.0176,1199,317.0176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="601.5" x2="1201" y1="317.0176" y2="317.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="608.5" y="312.5859">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="393" x="621.5" y="312.5859">Request to persist event information - POST - HTTP://events/</text><polygon fill="#A80036" points="1399,342.3281,1409,346.3281,1399,350.3281,1403,346.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1217" x2="1405" y1="346.3281" y2="346.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1224" y="341.8965">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1237" y="341.8965">Publish event information</text><rect fill="#FFFFFF" filter="url(#f1vjmits4kxfwy)" height="55.9316" style="stroke: #000000; stroke-width: 2.0;" width="210" x="1360.5" y="379.6387"/><polygon fill="#EEEEEE" points="1360.5,379.6387,1424.5,379.6387,1424.5,386.6387,1414.5,396.6387,1360.5,396.6387,1360.5,379.6387" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="1373.5" y="394.207">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="198" x="1366.5" y="413.207">Event Handler Consume {9.1.0.}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="1370.5" y="428.5176"/><polygon fill="#A80036" points="1228,482.5703,1218,486.5703,1228,490.5703,1224,486.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1222" x2="1415" y1="486.5703" y2="486.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1234" y="482.1387">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1247" y="482.1387">Return success</text><polygon fill="#A80036" points="612.5,511.8809,602.5,515.8809,612.5,519.8809,608.5,515.8809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="606.5" x2="1211" y1="515.8809" y2="515.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="618.5" y="511.4492">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="631.5" y="511.4492">Return success</text><polygon fill="#A80036" points="1195,548.1914,1205,552.1914,1195,556.1914,1199,552.1914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="601.5" x2="1201" y1="552.1914" y2="552.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="608.5" y="547.7598">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="516" x="621.5" y="547.7598">Request Notifications details for Participant - GET - HTTP://notifications/DFPS(n)</text><polygon fill="#A80036" points="1632,577.502,1642,581.502,1632,585.502,1636,581.502" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1217" x2="1638" y1="581.502" y2="581.502"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1224" y="577.0703">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="1237" y="577.0703">Fetch Notifications details for Participant</text><polygon fill="#A80036" points="1955,606.8125,1965,610.8125,1955,614.8125,1959,610.8125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1654" x2="1961" y1="610.8125" y2="610.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1661" y="606.3809">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="1674" y="606.3809">Fetch Notifications details for Participant</text><polygon fill="#FFFFE0" filter="url(#f1vjmits4kxfwy)" points="1920,624.123,2024,624.123,2034,635.123,2024,647.123,1920,647.123,1910,635.123,1920,624.123" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="1922" y="640.6914">transferPosition</text><polygon fill="#A80036" points="1665,669.4336,1655,673.4336,1665,677.4336,1661,673.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1659" x2="1966" y1="673.4336" y2="673.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1671" y="669.002">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="276" x="1684" y="669.002">Retrieved Notification details for Participant</text><polygon fill="#A80036" points="1228,698.7441,1218,702.7441,1228,706.7441,1224,702.7441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1222" x2="1648" y1="702.7441" y2="702.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1234" y="698.3125">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="1256" y="698.3125">Return Notifications details for Participant</text><polygon fill="#A80036" points="612.5,728.0547,602.5,732.0547,612.5,736.0547,608.5,732.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="606.5" x2="1211" y1="732.0547" y2="732.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="618.5" y="727.623">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="640.5" y="727.623">Return Notifications details for Participant</text><polygon fill="#A80036" points="104.5,757.3652,94.5,761.3652,104.5,765.3652,100.5,761.3652" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="98.5" x2="590.5" y1="761.3652" y2="761.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="110.5" y="756.9336">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="132.5" y="756.9336">HTTP Callback with Prepare result to Participant to specified URL</text><!--
@startuml
' declate title
title 1.1.4. Send notification to Participant (Payer/Payee) (batch messages)

autonumber

' Actor Keys:
'   boundary - APIs/Interfaces, etc
'   collections - Kafka Topics
'   control - Kafka Consumers
'   entity - Database Access Objects
'   database - Database Persistance Store

' declare actors
actor "DFSP(n)\nParticipant" as DFSP
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Notification-Topic" as TOPIC_NOTIFICATIONS
collections "Event-Topic" as TOPIC_EVENTS
entity "Notification DAO" as NOTIFY_DAO
database "Central Store" as DB

box "Financial Service Provider" #lightGray
	participant DFSP
end box

box "ML API Adapter Service" #LightBlue
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
participant TOPIC_NOTIFICATIONS
    participant CSAPI
    participant TOPIC_EVENTS
    participant EVENT_DAO
    participant NOTIFY_DAO
    participant DB
end box

' start flow
activate NOTIFY_HANDLER
group Send notification to Participant
    TOPIC_NOTIFICATIONS <- NOTIFY_HANDLER: <color #FF0000>**Consume Notifications event batch of messages for Participant**</color>
    activate TOPIC_NOTIFICATIONS
    deactivate TOPIC_NOTIFICATIONS
    loop for each message in batch
        group Persist Event Information
            NOTIFY_HANDLER -> CSAPI: Request to persist event information - POST - HTTP://events/
            activate CSAPI
            CSAPI -> TOPIC_EVENTS: Publish event information
            activate TOPIC_EVENTS
            |||
            ref over TOPIC_EVENTS :  Event Handler Consume {9.1.0.} \n
            |||
            TOPIC_EVENTS - -> CSAPI: Return success
            deactivate TOPIC_EVENTS
            CSAPI - -> NOTIFY_HANDLER: Return success
            deactivate CSAPI
        end
        NOTIFY_HANDLER -> CSAPI: Request Notifications details for Participant - GET - HTTP://notifications/DFPS(n)
        activate CSAPI
        CSAPI -> NOTIFY_DAO: Fetch Notifications details for Participant
        activate NOTIFY_DAO
        NOTIFY_DAO -> DB: Fetch Notifications details for Participant
        activate DB
        hnote over DB #lightyellow
            transferPosition
        end note
        DB -> NOTIFY_DAO: Retrieved Notification details for Participant
        'deactivate DB
        NOTIFY_DAO - -> CSAPI: Return Notifications details for Participant
        deactivate NOTIFY_DAO
        CSAPI - -> NOTIFY_HANDLER: Return Notifications details for Participant
        deactivate CSAPI
        NOTIFY_HANDLER -> DFSP: HTTP Callback with Prepare result to Participant to specified URL
    end
end
deactivate NOTIFY_HANDLER
@enduml

PlantUML version 1.2017.18(Fri Oct 06 17:56:32 BST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_152-b16
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>