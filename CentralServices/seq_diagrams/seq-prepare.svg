<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2569px" preserveAspectRatio="none" style="width:3723px;height:2569px;" version="1.1" viewBox="0 0 3723 2569" width="3723px" zoomAndPan="magnify"><defs><filter height="300%" id="f1pkyai84ur5et" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="359" x="1682.75" y="23.5352">DFSP1 sends a Prepare Transfer request to DFSP2</text><rect fill="#ADD8E6" height="2524.2461" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#90EE90" height="2524.2461" style="stroke: #A80036; stroke-width: 1.0;" width="361" x="295.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="397.5" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="2524.2461" style="stroke: #A80036; stroke-width: 1.0;" width="2907.5" x="763" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="2166.25" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="175.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="174.5078" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="1195.5352"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="721.7871" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="1741.459"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="205.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="990.3613"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="146.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="1594.9063"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="104.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="2359.0039"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="185.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="322.8398"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="224.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="1370.043"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="185.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="1915.9668"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="306.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2076.5" y="508.3926"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="257.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2076.5" y="2101.5195"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="2300.959" style="stroke: #000000; stroke-width: 2.0;" width="3643.5" x="33" y="154.2871"/><rect fill="#FFFFFF" height="545.9238" style="stroke: none; stroke-width: 1.0;" width="3643.5" x="33" y="1203.8457"/><rect fill="#FFFFFF" height="705.4766" style="stroke: none; stroke-width: 1.0;" width="3643.5" x="33" y="1749.7695"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="354.5" x2="354.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="535.5" x2="535.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="834" x2="834" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1025" x2="1025" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1418.5" x2="1418.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1747" x2="1747" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2081.5" x2="2081.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2522" x2="2522" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2728" x2="2728" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3023.5" x2="3023.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3185.5" x2="3185.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3282.5" x2="3282.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3380.5" x2="3380.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3500.5" x2="3500.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3618.5" x2="3618.5" y1="137.2871" y2="2472.2461"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3696.5" x2="3696.5" y1="137.2871" y2="2472.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="2484.7813">DFSP1</text><ellipse cx="67.5" cy="2497.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,2505.7344 L67.5,2532.7344 M54.5,2513.7344 L80.5,2513.7344 M67.5,2532.7344 L54.5,2547.7344 M67.5,2532.7344 L80.5,2547.7344 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="2484.7813">DFSP2</text><ellipse cx="126.5" cy="2497.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,2505.7344 L126.5,2532.7344 M113.5,2513.7344 L139.5,2513.7344 M126.5,2532.7344 L113.5,2547.7344 M126.5,2532.7344 L139.5,2547.7344 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="299.5" y="134.334">ML API Adapter</text><path d="M334,92.7988 L334,116.7988 M334,104.7988 L351,104.7988 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="363" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="299.5" y="2484.7813">ML API Adapter</text><path d="M334,2491.7344 L334,2515.7344 M334,2503.7344 L351,2503.7344 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="363" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="419.5" y="134.334">ML API Notification Event Handler</text><ellipse cx="536" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="532,92.7988,538,87.7988,536,92.7988,538,97.7988,532,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="419.5" y="2484.7813">ML API Notification Event Handler</text><ellipse cx="536" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="532,2491.7344,538,2486.7344,536,2491.7344,538,2496.7344,532,2491.7344" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="767" y="134.334">Central Service API</text><path d="M813.5,92.7988 L813.5,116.7988 M813.5,104.7988 L830.5,104.7988 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="842.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="767" y="2484.7813">Central Service API</text><path d="M813.5,2491.7344 L813.5,2515.7344 M813.5,2503.7344 L830.5,2503.7344 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="842.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="915" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="911" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="207" x="918" y="122.334">Prepare-Topic-handler-dfsp1</text><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="915" y="2471.2461"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="911" y="2475.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="207" x="918" y="2495.7813">Prepare-Topic-handler-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1339.5" y="134.334">Prepare Event Handler</text><ellipse cx="1418.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1414.5,92.7988,1420.5,87.7988,1418.5,92.7988,1420.5,97.7988,1414.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1339.5" y="2484.7813">Prepare Event Handler</text><ellipse cx="1418.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1414.5,2491.7344,1420.5,2486.7344,1418.5,2491.7344,1420.5,2496.7344,1414.5,2491.7344" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1636" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1632" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="209" x="1639" y="122.334">Position-Topic-handler-dfsp1</text><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1636" y="2471.2461"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1632" y="2475.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="209" x="1639" y="2495.7813">Position-Topic-handler-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2001.5" y="134.334">Position Event Handler</text><ellipse cx="2081.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2077.5,92.7988,2083.5,87.7988,2081.5,92.7988,2083.5,97.7988,2077.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2001.5" y="2484.7813">Position Event Handler</text><ellipse cx="2081.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2077.5,2491.7344,2083.5,2486.7344,2081.5,2491.7344,2083.5,2496.7344,2077.5,2491.7344" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2433" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2429" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="2436" y="122.334">Transfer-Topic-handler</text><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2433" y="2471.2461"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2429" y="2475.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="2436" y="2495.7813">Transfer-Topic-handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="2647" y="134.334">Transfer Event Handler</text><ellipse cx="2728.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2724.5,92.7988,2730.5,87.7988,2728.5,92.7988,2730.5,97.7988,2724.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="2647" y="2484.7813">Transfer Event Handler</text><ellipse cx="2728.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2724.5,2491.7344,2730.5,2486.7344,2728.5,2491.7344,2730.5,2496.7344,2724.5,2491.7344" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="2923.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="2919.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="2926.5" y="122.334">Notification-Topic-handler</text><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="2923.5" y="2471.2461"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="2919.5" y="2475.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="2926.5" y="2495.7813">Notification-Topic-handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3137.5" y="134.334">Position DAO</text><ellipse cx="3185.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3173.5" x2="3197.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3137.5" y="2484.7813">Position DAO</text><ellipse cx="3185.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3173.5" x2="3197.5" y1="2517.7344" y2="2517.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3243.5" y="134.334">Event DAO</text><ellipse cx="3282.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3270.5" x2="3294.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3243.5" y="2484.7813">Event DAO</text><ellipse cx="3282.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3270.5" x2="3294.5" y1="2517.7344" y2="2517.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="3331.5" y="134.334">Transfer DAO</text><ellipse cx="3381" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3369" x2="3393" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="3331.5" y="2484.7813">Transfer DAO</text><ellipse cx="3381" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3369" x2="3393" y1="2517.7344" y2="2517.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="3440.5" y="134.334">Notification DAO</text><ellipse cx="3500.5" cy="104.7988" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3488.5" x2="3512.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="3440.5" y="2484.7813">Notification DAO</text><ellipse cx="3500.5" cy="2503.7344" fill="#FEFECE" filter="url(#f1pkyai84ur5et)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3488.5" x2="3512.5" y1="2517.7344" y2="2517.7344"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3570.5" y="134.334">Central Store</text><path d="M3600.5,84.7988 C3600.5,74.7988 3618.5,74.7988 3618.5,74.7988 C3618.5,74.7988 3636.5,74.7988 3636.5,84.7988 L3636.5,110.7988 C3636.5,120.7988 3618.5,120.7988 3618.5,120.7988 C3618.5,120.7988 3600.5,120.7988 3600.5,110.7988 L3600.5,84.7988 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M3600.5,84.7988 C3600.5,94.7988 3618.5,94.7988 3618.5,94.7988 C3618.5,94.7988 3636.5,94.7988 3636.5,84.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3570.5" y="2484.7813">Central Store</text><path d="M3600.5,2497.7344 C3600.5,2487.7344 3618.5,2487.7344 3618.5,2487.7344 C3618.5,2487.7344 3636.5,2487.7344 3636.5,2497.7344 L3636.5,2523.7344 C3636.5,2533.7344 3618.5,2533.7344 3618.5,2533.7344 C3618.5,2533.7344 3600.5,2533.7344 3600.5,2523.7344 L3600.5,2497.7344 " fill="#FEFECE" filter="url(#f1pkyai84ur5et)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M3600.5,2497.7344 C3600.5,2507.7344 3618.5,2507.7344 3618.5,2507.7344 C3618.5,2507.7344 3636.5,2507.7344 3636.5,2497.7344 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="3676.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="3683.5" y="122.334">API</text><rect fill="#FEFECE" filter="url(#f1pkyai84ur5et)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="3676.5" y="2471.2461"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="3683.5" y="2491.7813">API</text><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="175.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="174.5078" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="1195.5352"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="721.7871" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="349.5" y="1741.459"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="205.1738" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="990.3613"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="146.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="1594.9063"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="104.2422" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="531" y="2359.0039"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="185.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="322.8398"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="224.8633" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="1370.043"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="185.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1413.5" y="1915.9668"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="306.1055" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2076.5" y="508.3926"/><rect fill="#FFFFFF" filter="url(#f1pkyai84ur5et)" height="257.4844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2076.5" y="2101.5195"/><rect fill="none" height="2300.959" style="stroke: #000000; stroke-width: 2.0;" width="3643.5" x="33" y="154.2871"/><polygon fill="#EEEEEE" points="33,154.2871,95,154.2871,95,161.2871,85,171.2871,33,171.2871,33,154.2871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="48" y="167.8555">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="110" y="166.9219">[DFSP1 sends a Prepare Transfer request to DFSP2]</text><polygon fill="#A80036" points="337.5,188.5977,347.5,192.5977,337.5,196.5977,341.5,192.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="343.5" y1="192.5977" y2="192.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="74.5" y="188.166">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="87.5" y="188.166">POST - http://transfers</text><polygon fill="#A80036" points="1013.5,217.9082,1023.5,221.9082,1013.5,225.9082,1017.5,221.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="359.5" x2="1019.5" y1="221.9082" y2="221.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="366.5" y="217.4766">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="379.5" y="217.4766">Routes &amp; Publishes Prepare event for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1067.5" y1="251.5293" y2="251.5293"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1067.5" x2="1067.5" y1="251.5293" y2="264.5293"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1026.5" x2="1067.5" y1="264.5293" y2="264.5293"/><polygon fill="#A80036" points="1036.5,260.5293,1026.5,264.5293,1036.5,268.5293,1032.5,264.5293" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1032.5" y="246.7871">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1045.5" y="246.7871">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="370.5,289.5293,360.5,293.5293,370.5,297.5293,366.5,293.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364.5" x2="1024.5" y1="293.5293" y2="293.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="376.5" y="289.0977">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="389.5" y="289.0977">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="78.5,318.8398,68.5,322.8398,78.5,326.8398,74.5,322.8398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="353.5" y1="322.8398" y2="322.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="84.5" y="318.4082">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="97.5" y="318.4082">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="1401.5,348.1504,1411.5,352.1504,1401.5,356.1504,1405.5,352.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1407.5" y1="352.1504" y2="352.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1032.5" y="347.7188">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1045.5" y="347.7188">Consumes Prepare event message for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="381.7715" y2="381.7715"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="381.7715" y2="394.7715"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="394.7715" y2="394.7715"/><polygon fill="#A80036" points="1434.5,390.7715,1424.5,394.7715,1434.5,398.7715,1430.5,394.7715" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1430.5" y="377.0293">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="1443.5" y="377.0293">Validates from - DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="424.082" y2="424.082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="424.082" y2="437.082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="437.082" y2="437.082"/><polygon fill="#A80036" points="1434.5,433.082,1424.5,437.082,1434.5,441.082,1430.5,437.082" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1430.5" y="419.3398">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1443.5" y="419.3398">Validates to - DFSP2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="466.3926" y2="466.3926"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="466.3926" y2="479.3926"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="479.3926" y2="479.3926"/><polygon fill="#A80036" points="1434.5,475.3926,1424.5,479.3926,1434.5,483.3926,1430.5,479.3926" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1430.5" y="461.6504">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1443.5" y="461.6504">Validates message signature</text><polygon fill="#A80036" points="1735.5,504.3926,1745.5,508.3926,1735.5,512.3926,1739.5,508.3926" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1418.5" x2="1741.5" y1="508.3926" y2="508.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1425.5" y="503.9609">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1447.5" y="503.9609">Routes &amp; Publishes Position event for DFSP1</text><polygon fill="#A80036" points="2064.5,533.7031,2074.5,537.7031,2064.5,541.7031,2068.5,537.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1747.5" x2="2070.5" y1="537.7031" y2="537.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1754.5" y="533.2715">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="1776.5" y="533.2715">Consumes Position event message for DFSP1</text><polygon fill="#A80036" points="3270.5,563.0137,3280.5,567.0137,3270.5,571.0137,3274.5,567.0137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2086.5" x2="3276.5" y1="567.0137" y2="567.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2093.5" y="562.582">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="2115.5" y="562.582">Request to persist event information</text><polygon fill="#A80036" points="3293.5,592.3242,3283.5,596.3242,3293.5,600.3242,3289.5,596.3242" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,592.3242,3616.5,596.3242,3606.5,600.3242,3610.5,596.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3287.5" x2="3612.5" y1="596.3242" y2="596.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3299.5" y="591.8926">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="3321.5" y="591.8926">Persist event information</text><polygon fill="#A80036" points="2097.5,621.6348,2087.5,625.6348,2097.5,629.6348,2093.5,625.6348" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2091.5" x2="3281.5" y1="625.6348" y2="625.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2103.5" y="621.2031">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2125.5" y="621.2031">return success</text><polygon fill="#A80036" points="2097.5,650.9453,2087.5,654.9453,2097.5,658.9453,2093.5,654.9453" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,650.9453,3616.5,654.9453,3606.5,658.9453,3610.5,654.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2091.5" x2="3612.5" y1="654.9453" y2="654.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2103.5" y="650.5137">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="2125.5" y="650.5137">Retrieves latest position from DB for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2086.5" x2="2128.5" y1="684.5664" y2="684.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2128.5" x2="2128.5" y1="684.5664" y2="697.5664"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2087.5" x2="2128.5" y1="697.5664" y2="697.5664"/><polygon fill="#A80036" points="2097.5,693.5664,2087.5,697.5664,2097.5,701.5664,2093.5,697.5664" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2093.5" y="679.8242">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="395" x="2115.5" y="679.8242">Calculates latest position by decrementing transfer for prepare</text><polygon fill="#A80036" points="3173.5,722.5664,3183.5,726.5664,3173.5,730.5664,3177.5,726.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2086.5" x2="3179.5" y1="726.5664" y2="726.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2093.5" y="722.1348">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="2115.5" y="722.1348">Request to persist latest position for DFSP1</text><polygon fill="#A80036" points="3196.5,751.877,3186.5,755.877,3196.5,759.877,3192.5,755.877" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,751.877,3616.5,755.877,3606.5,759.877,3610.5,755.877" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3190.5" x2="3612.5" y1="755.877" y2="755.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3202.5" y="751.4453">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="3224.5" y="751.4453">Persists latest position to DB for DFSP1</text><polygon fill="#A80036" points="2097.5,781.1875,2087.5,785.1875,2097.5,789.1875,2093.5,785.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2091.5" x2="3184.5" y1="785.1875" y2="785.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2103.5" y="780.7559">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2125.5" y="780.7559">return success</text><polygon fill="#A80036" points="2510.5,810.498,2520.5,814.498,2510.5,818.498,2514.5,814.498" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2081.5" x2="2516.5" y1="814.498" y2="814.498"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2088.5" y="810.0664">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="2110.5" y="810.0664">Publishes Transfer event</text><polygon fill="#A80036" points="2716.5,839.8086,2726.5,843.8086,2716.5,847.8086,2720.5,843.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2522.5" x2="2722.5" y1="843.8086" y2="843.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2529.5" y="839.377">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="2551.5" y="839.377">Consumes Transfer event</text><polygon fill="#A80036" points="3369,869.1191,3379,873.1191,3369,877.1191,3373,873.1191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2728.5" x2="3375" y1="873.1191" y2="873.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2735.5" y="868.6875">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="2757.5" y="868.6875">Request to Transfer status to DB</text><polygon fill="#A80036" points="3392,898.4297,3382,902.4297,3392,906.4297,3388,902.4297" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,898.4297,3616.5,902.4297,3606.5,906.4297,3610.5,902.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3386" x2="3612.5" y1="902.4297" y2="902.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3398" y="897.998">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3420" y="897.998">return success</text><polygon fill="#A80036" points="2739.5,927.7402,2729.5,931.7402,2739.5,935.7402,2735.5,931.7402" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2733.5" x2="3380" y1="931.7402" y2="931.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2745.5" y="927.3086">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="2767.5" y="927.3086">Persists Transfer status to DB</text><polygon fill="#A80036" points="3011.5,957.0508,3021.5,961.0508,3011.5,965.0508,3015.5,961.0508" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2728.5" x2="3017.5" y1="961.0508" y2="961.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2735.5" y="956.6191">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="2757.5" y="956.6191">Publishes Notifications event for DFSP1</text><polygon fill="#A80036" points="3011.5,986.3613,3021.5,990.3613,3011.5,994.3613,3015.5,990.3613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2728.5" x2="3017.5" y1="990.3613" y2="990.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2735.5" y="985.9297">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="2757.5" y="985.9297">Publishes Notifications event for DFSP2</text><polygon fill="#A80036" points="552,1015.6719,542,1019.6719,552,1023.6719,548,1019.6719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3022.5" y1="1019.6719" y2="1019.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1015.2402">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="580" y="1015.2402">Consumes Notifications event</text><polygon fill="#A80036" points="822,1044.9824,832,1048.9824,822,1052.9824,826,1048.9824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="541" x2="828" y1="1048.9824" y2="1048.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="548" y="1044.5508">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="570" y="1044.5508">Requests Notification details for DFSP1</text><polygon fill="#A80036" points="845,1074.293,835,1078.293,845,1082.293,841,1078.293" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3488.5,1074.293,3498.5,1078.293,3488.5,1082.293,3492.5,1078.293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="839" x2="3494.5" y1="1078.293" y2="1078.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="851" y="1073.8613">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="873" y="1073.8613">Fetches Notifications details for DFSP1</text><polygon fill="#A80036" points="552,1103.6035,542,1107.6035,552,1111.6035,548,1107.6035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="833" y1="1107.6035" y2="1107.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1103.1719">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="580" y="1103.1719">Returns Notifications details for DFSP1</text><polygon fill="#A80036" points="78.5,1132.9141,68.5,1136.9141,78.5,1140.9141,74.5,1136.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="530" y1="1136.9141" y2="1136.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="1132.4824">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="106.5" y="1132.4824">HTTP Callback with Prepare result to DFSP1</text><polygon fill="#A80036" points="552,1162.2246,542,1166.2246,552,1170.2246,548,1166.2246" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3488.5,1162.2246,3498.5,1166.2246,3488.5,1170.2246,3492.5,1166.2246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3494.5" y1="1166.2246" y2="1166.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1161.793">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="580" y="1161.793">Fetches Notifications details for DFSP2</text><polygon fill="#A80036" points="137.5,1191.5352,127.5,1195.5352,137.5,1199.5352,133.5,1195.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="535" y1="1195.5352" y2="1195.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="1191.1035">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="165.5" y="1191.1035">HTTP Callback with Prepare result to DFSP2</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="3676.5" y1="1204.8457" y2="1204.8457"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="38" y="1215.4805">[Prepare Validation Failure]</text><polygon fill="#A80036" points="337.5,1235.8008,347.5,1239.8008,337.5,1243.8008,341.5,1239.8008" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="343.5" y1="1239.8008" y2="1239.8008"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="74.5" y="1235.3691">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="96.5" y="1235.3691">POST - http://transfers</text><polygon fill="#A80036" points="1013.5,1265.1113,1023.5,1269.1113,1013.5,1273.1113,1017.5,1269.1113" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="359.5" x2="1019.5" y1="1269.1113" y2="1269.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="366.5" y="1264.6797">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="388.5" y="1264.6797">Routes &amp; Publishes Prepare event for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1067.5" y1="1298.7324" y2="1298.7324"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1067.5" x2="1067.5" y1="1298.7324" y2="1311.7324"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1026.5" x2="1067.5" y1="1311.7324" y2="1311.7324"/><polygon fill="#A80036" points="1036.5,1307.7324,1026.5,1311.7324,1036.5,1315.7324,1032.5,1311.7324" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1032.5" y="1293.9902">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1054.5" y="1293.9902">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="370.5,1336.7324,360.5,1340.7324,370.5,1344.7324,366.5,1340.7324" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364.5" x2="1024.5" y1="1340.7324" y2="1340.7324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="376.5" y="1336.3008">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="398.5" y="1336.3008">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="78.5,1366.043,68.5,1370.043,78.5,1374.043,74.5,1370.043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="353.5" y1="1370.043" y2="1370.043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="1365.6113">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="106.5" y="1365.6113">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="1401.5,1395.3535,1411.5,1399.3535,1401.5,1403.3535,1405.5,1399.3535" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1407.5" y1="1399.3535" y2="1399.3535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1032.5" y="1394.9219">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1054.5" y="1394.9219">Consumes Prepare event message for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="1428.9746" y2="1428.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="1428.9746" y2="1441.9746"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="1441.9746" y2="1441.9746"/><polygon fill="#A80036" points="1434.5,1437.9746,1424.5,1441.9746,1434.5,1445.9746,1430.5,1441.9746" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="1424.2324">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="1452.5" y="1424.2324">Validates from - DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="1471.2852" y2="1471.2852"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="1471.2852" y2="1484.2852"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="1484.2852" y2="1484.2852"/><polygon fill="#A80036" points="1434.5,1480.2852,1424.5,1484.2852,1434.5,1488.2852,1430.5,1484.2852" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="1466.543">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1452.5" y="1466.543">Validates to - DFSP2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="1513.5957" y2="1513.5957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="1513.5957" y2="1526.5957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="1526.5957" y2="1526.5957"/><polygon fill="#A80036" points="1434.5,1522.5957,1424.5,1526.5957,1434.5,1530.5957,1430.5,1526.5957" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="1508.8535">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1452.5" y="1508.8535">Validates message signature</text><polygon fill="#FF0000" filter="url(#f1pkyai84ur5et)" points="1428,1539.5957,1428,1564.5957,1560,1564.5957,1560,1549.5957,1550,1539.5957,1428,1539.5957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1550" x2="1550" y1="1539.5957" y2="1549.5957"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1560" x2="1550" y1="1549.5957" y2="1549.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1434" y="1557.1641">Validation failure!</text><polygon fill="#A80036" points="3011.5,1590.9063,3021.5,1594.9063,3011.5,1598.9063,3015.5,1594.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1418.5" x2="3017.5" y1="1594.9063" y2="1594.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1425.5" y="1590.4746">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="1447.5" y="1590.4746">Publishes Notification (failure) event for DFSP1</text><polygon fill="#A80036" points="552,1620.2168,542,1624.2168,552,1628.2168,548,1624.2168" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3022.5" y1="1624.2168" y2="1624.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1619.7852">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="580" y="1619.7852">Consumes Notifications event</text><polygon fill="#A80036" points="552,1649.5273,542,1653.5273,552,1657.5273,548,1653.5273" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3488.5,1649.5273,3498.5,1653.5273,3488.5,1657.5273,3492.5,1653.5273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3494.5" y1="1653.5273" y2="1653.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1649.0957">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="580" y="1649.0957">Fetches Notifications details for DFSP1</text><polygon fill="#A80036" points="78.5,1678.8379,68.5,1682.8379,78.5,1686.8379,74.5,1682.8379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="530" y1="1682.8379" y2="1682.8379"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="1678.4063">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="106.5" y="1678.4063">HTTP Callback with Prepare result to DFSP1</text><polygon fill="#A80036" points="552,1708.1484,542,1712.1484,552,1716.1484,548,1712.1484" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3488.5,1708.1484,3498.5,1712.1484,3488.5,1716.1484,3492.5,1712.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3494.5" y1="1712.1484" y2="1712.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="1707.7168">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="580" y="1707.7168">Fetches Notifications details for DFSP2</text><polygon fill="#A80036" points="137.5,1737.459,127.5,1741.459,137.5,1745.459,133.5,1741.459" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="535" y1="1741.459" y2="1741.459"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="1737.0273">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="165.5" y="1737.0273">HTTP Callback with Prepare result to DFSP2</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="3676.5" y1="1750.7695" y2="1750.7695"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="38" y="1761.4043">[Prepare Position Failure]</text><polygon fill="#A80036" points="337.5,1781.7246,347.5,1785.7246,337.5,1789.7246,341.5,1785.7246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="343.5" y1="1785.7246" y2="1785.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="74.5" y="1781.293">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="96.5" y="1781.293">POST - http://transfers</text><polygon fill="#A80036" points="1013.5,1811.0352,1023.5,1815.0352,1013.5,1819.0352,1017.5,1815.0352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="359.5" x2="1019.5" y1="1815.0352" y2="1815.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="366.5" y="1810.6035">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="388.5" y="1810.6035">Routes &amp; Publishes Prepare event for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1067.5" y1="1844.6563" y2="1844.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1067.5" x2="1067.5" y1="1844.6563" y2="1857.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1026.5" x2="1067.5" y1="1857.6563" y2="1857.6563"/><polygon fill="#A80036" points="1036.5,1853.6563,1026.5,1857.6563,1036.5,1861.6563,1032.5,1857.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1032.5" y="1839.9141">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1054.5" y="1839.9141">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="370.5,1882.6563,360.5,1886.6563,370.5,1890.6563,366.5,1886.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="364.5" x2="1024.5" y1="1886.6563" y2="1886.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="376.5" y="1882.2246">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="398.5" y="1882.2246">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="78.5,1911.9668,68.5,1915.9668,78.5,1919.9668,74.5,1915.9668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="348.5" y1="1915.9668" y2="1915.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="1911.5352">53</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="106.5" y="1911.5352">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="1401.5,1941.2773,1411.5,1945.2773,1401.5,1949.2773,1405.5,1945.2773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1025.5" x2="1407.5" y1="1945.2773" y2="1945.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1032.5" y="1940.8457">54</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1054.5" y="1940.8457">Consumes Prepare event message for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="1974.8984" y2="1974.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="1974.8984" y2="1987.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="1987.8984" y2="1987.8984"/><polygon fill="#A80036" points="1434.5,1983.8984,1424.5,1987.8984,1434.5,1991.8984,1430.5,1987.8984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="1970.1563">55</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="1452.5" y="1970.1563">Validates from - DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="2017.209" y2="2017.209"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="2017.209" y2="2030.209"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="2030.209" y2="2030.209"/><polygon fill="#A80036" points="1434.5,2026.209,1424.5,2030.209,1434.5,2034.209,1430.5,2030.209" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="2012.4668">56</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1452.5" y="2012.4668">Validates to - DFSP2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1423.5" x2="1465.5" y1="2059.5195" y2="2059.5195"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1465.5" x2="1465.5" y1="2059.5195" y2="2072.5195"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1424.5" x2="1465.5" y1="2072.5195" y2="2072.5195"/><polygon fill="#A80036" points="1434.5,2068.5195,1424.5,2072.5195,1434.5,2076.5195,1430.5,2072.5195" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1430.5" y="2054.7773">57</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1452.5" y="2054.7773">Validates message signature</text><polygon fill="#A80036" points="1735.5,2097.5195,1745.5,2101.5195,1735.5,2105.5195,1739.5,2101.5195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1418.5" x2="1741.5" y1="2101.5195" y2="2101.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1425.5" y="2097.0879">58</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1447.5" y="2097.0879">Routes &amp; Publishes Position event for DFSP1</text><polygon fill="#A80036" points="2064.5,2126.8301,2074.5,2130.8301,2064.5,2134.8301,2068.5,2130.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1747.5" x2="2070.5" y1="2130.8301" y2="2130.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1754.5" y="2126.3984">59</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="1776.5" y="2126.3984">Consumes Position event message for DFSP1</text><polygon fill="#A80036" points="3270.5,2156.1406,3280.5,2160.1406,3270.5,2164.1406,3274.5,2160.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2086.5" x2="3276.5" y1="2160.1406" y2="2160.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2093.5" y="2155.709">60</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="2115.5" y="2155.709">Request to persist event information</text><polygon fill="#A80036" points="3293.5,2185.4512,3283.5,2189.4512,3293.5,2193.4512,3289.5,2189.4512" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,2185.4512,3616.5,2189.4512,3606.5,2193.4512,3610.5,2189.4512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3287.5" x2="3612.5" y1="2189.4512" y2="2189.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3299.5" y="2185.0195">61</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="3321.5" y="2185.0195">Persist event information</text><polygon fill="#A80036" points="2097.5,2214.7617,2087.5,2218.7617,2097.5,2222.7617,2093.5,2218.7617" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2091.5" x2="3281.5" y1="2218.7617" y2="2218.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2103.5" y="2214.3301">62</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2125.5" y="2214.3301">return success</text><polygon fill="#A80036" points="2097.5,2244.0723,2087.5,2248.0723,2097.5,2252.0723,2093.5,2248.0723" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3606.5,2244.0723,3616.5,2248.0723,3606.5,2252.0723,3610.5,2248.0723" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2091.5" x2="3612.5" y1="2248.0723" y2="2248.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2103.5" y="2243.6406">63</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="2125.5" y="2243.6406">Retrieves latest position from DB for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2086.5" x2="2128.5" y1="2277.6934" y2="2277.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2128.5" x2="2128.5" y1="2277.6934" y2="2290.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2087.5" x2="2128.5" y1="2290.6934" y2="2290.6934"/><polygon fill="#A80036" points="2097.5,2286.6934,2087.5,2290.6934,2097.5,2294.6934,2093.5,2290.6934" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2093.5" y="2272.9512">64</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="395" x="2115.5" y="2272.9512">Calculates latest position by decrementing transfer for prepare</text><polygon fill="#FF0000" filter="url(#f1pkyai84ur5et)" points="2091,2303.6934,2091,2328.6934,2223,2328.6934,2223,2313.6934,2213,2303.6934,2091,2303.6934" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2213" x2="2213" y1="2303.6934" y2="2313.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2223" x2="2213" y1="2313.6934" y2="2313.6934"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="2097" y="2321.2617">Validation failure!</text><polygon fill="#A80036" points="3011.5,2355.0039,3021.5,2359.0039,3011.5,2363.0039,3015.5,2359.0039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2081.5" x2="3017.5" y1="2359.0039" y2="2359.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2088.5" y="2354.5723">65</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="303" x="2110.5" y="2354.5723">Publishes Notifications (Failure) event for DFSP2</text><polygon fill="#A80036" points="552,2384.3145,542,2388.3145,552,2392.3145,548,2388.3145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3022.5" y1="2388.3145" y2="2388.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="2383.8828">66</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="580" y="2383.8828">Consumes Notifications event</text><polygon fill="#A80036" points="552,2413.625,542,2417.625,552,2421.625,548,2417.625" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3488.5,2413.625,3498.5,2417.625,3488.5,2421.625,3492.5,2417.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="546" x2="3494.5" y1="2417.625" y2="2417.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="558" y="2413.1934">67</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="580" y="2413.1934">Fetches Notifications details for DFSP1</text><polygon fill="#A80036" points="78.5,2442.9355,68.5,2446.9355,78.5,2450.9355,74.5,2446.9355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="530" y1="2446.9355" y2="2446.9355"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2442.5039">68</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="106.5" y="2442.5039">HTTP Callback with Prepare result to DFSP1</text><!--
@startuml
' declate title
title DFSP1 sends a Prepare Transfer request to DFSP2

autonumber

' Actor Keys:
'   boundary - APIs/Interfaces, etc
'   collections - Kafka Topics
'   control - Kafka Consumers
'   entity - Database Access Objects
'   database - Database Persistance Store

' declare actors
actor DFSP1
actor DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Prepare-Topic-handler-dfsp1" as TOPIC_PREPARE_DFSP1
control "Prepare Event Handler" as PREP_HANDLER
collections "Position-Topic-handler-dfsp1" as TOPIC_POSITION_DFSP1
control "Position Event Handler" as POS_HANDLER
collections "Transfer-Topic-handler" as TOPIC_TRANSFERS
control "Transfer Event Handler" as TRANS_HANDLER
collections "Notification-Topic-handler" as TOPIC_NOTIFICATIONS
entity "Position DAO" as POS_DAO
entity "Event DAO" as EVENT_DAO
entity "Transfer DAO" as TRANS_DAO
entity "Notification DAO" as NOTIFY_DAO
database "Central Store" as DB

box "Financial Service Providers" #LightBlue
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightGreen
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_PREPARE_DFSP1
    participant PREP_HANDLER
    participant TOPIC_POSITION_DFSP1
    participant POS_HANDLER
    participant TOPIC_TRANSFERS
    participant TRANS_HANDLER
    participant TOPIC_NOTIFICATIONS
    participant POS_DAO
    participant EVENT_DAO
    participant TRANS_DAO
    participant NOTIFY_DAO
    participant DB
end box

' start flow
alt DFSP1 sends a Prepare Transfer request to DFSP2
    activate MLAPI
    DFSP1 -> MLAPI: POST - http://transfers
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for DFSP1
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI
    activate PREP_HANDLER
    TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates from - DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates to - DFSP2
    PREP_HANDLER <-> PREP_HANDLER: Validates message signature
    PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for DFSP1
    deactivate PREP_HANDLER
    activate POS_HANDLER
    TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event message for DFSP1
    POS_HANDLER -> EVENT_DAO: Request to persist event information
    EVENT_DAO <-> DB: Persist event information
    EVENT_DAO -> POS_HANDLER: return success
    POS_HANDLER <-> DB: Retrieves latest position from DB for DFSP1
    POS_HANDLER <-> POS_HANDLER: Calculates latest position by decrementing transfer for prepare
    POS_HANDLER -> POS_DAO: Request to persist latest position for DFSP1
    POS_DAO <-> DB: Persists latest position to DB for DFSP1
    POS_DAO -> POS_HANDLER: return success
    POS_HANDLER -> TOPIC_TRANSFERS: Publishes Transfer event
    deactivate POS_HANDLER
    deactivate TRANS_HANDLER
    TOPIC_TRANSFERS -> TRANS_HANDLER: Consumes Transfer event
    TRANS_HANDLER -> TRANS_DAO: Request to Transfer status to DB
    TRANS_DAO <-> DB: return success
    TRANS_DAO -> TRANS_HANDLER: Persists Transfer status to DB
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for DFSP1
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for DFSP2
    deactivate TRANS_HANDLER
    activate NOTIFY_HANDLER
    TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
    NOTIFY_HANDLER -> CSAPI: Requests Notification details for DFSP1
    CSAPI <-> NOTIFY_DAO: Fetches Notifications details for DFSP1
    CSAPI -> NOTIFY_HANDLER: Returns Notifications details for DFSP1
    NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to DFSP1
    NOTIFY_HANDLER <-> NOTIFY_DAO: Fetches Notifications details for DFSP2
    NOTIFY_HANDLER -> DFSP2: HTTP Callback with Prepare result to DFSP2
    deactivate NOTIFY_HANDLER
else Prepare Validation Failure
    activate MLAPI
    DFSP1 -> MLAPI: POST - http://transfers
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for DFSP1
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI
    activate PREP_HANDLER
    TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates from - DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates to - DFSP2
    PREP_HANDLER <-> PREP_HANDLER: Validates message signature
    note right of PREP_HANDLER #red: Validation failure!
    PREP_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notification (failure) event for DFSP1
    deactivate PREP_HANDLER
    activate NOTIFY_HANDLER
    TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
    NOTIFY_HANDLER <-> NOTIFY_DAO: Fetches Notifications details for DFSP1
    NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to DFSP1
    NOTIFY_HANDLER <-> NOTIFY_DAO: Fetches Notifications details for DFSP2
    NOTIFY_HANDLER -> DFSP2: HTTP Callback with Prepare result to DFSP2
    deactivate NOTIFY_HANDLER
else Prepare Position Failure
    activate MLAPI
    DFSP1 -> MLAPI: POST - http://transfers
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for DFSP1
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate API
    activate PREP_HANDLER
    TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates from - DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates to - DFSP2
    PREP_HANDLER <-> PREP_HANDLER: Validates message signature
    PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for DFSP1
    deactivate PREP_HANDLER
    activate POS_HANDLER
    TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event message for DFSP1
    POS_HANDLER -> EVENT_DAO: Request to persist event information
    EVENT_DAO <-> DB: Persist event information
    EVENT_DAO -> POS_HANDLER: return success
    POS_HANDLER <-> DB: Retrieves latest position from DB for DFSP1
    POS_HANDLER <-> POS_HANDLER: Calculates latest position by decrementing transfer for prepare
    note right of POS_HANDLER #red: Validation failure!
    POS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications (Failure) event for DFSP2
    deactivate POS_HANDLER
    activate NOTIFY_HANDLER
    TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
    NOTIFY_HANDLER <-> NOTIFY_DAO: Fetches Notifications details for DFSP1
    NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to DFSP1
end
@enduml

PlantUML version 1.2017.18(Fri Oct 06 18:56:32 SAST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_152-b16
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>