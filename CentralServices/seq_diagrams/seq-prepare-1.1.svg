<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="5496px" preserveAspectRatio="none" style="width:4692px;height:5496px;" version="1.1" viewBox="0 0 4692 5496" width="4692px" zoomAndPan="magnify"><defs><filter height="300%" id="falvgq7rmgcqk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="385" x="2154.5" y="23.5352">1.1 DFSP1 sends a Prepare Transfer request to DFSP2</text><rect fill="#D3D3D3" height="5451.4395" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="5451.4395" style="stroke: #A80036; stroke-width: 1.0;" width="590.5" x="293.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="510.25" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="5451.4395" style="stroke: #A80036; stroke-width: 1.0;" width="3437.5" x="1217.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="2885.75" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1138.5645" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="347.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="407.3477" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="758.5" y="4545.4336"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1169.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1828.5" y="1285.8516"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="980.3535" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2631.5" y="2455.7578"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1109.3223" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3459.5" y="3436.1113"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="5228.1523" style="stroke: #000000; stroke-width: 2.0;" width="4653" x="28" y="154.2871"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1330.4727"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="586.5898" style="stroke: #000000; stroke-width: 2.0;" width="2936.5" x="1734.5" y="1449.7148"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1474.0254"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1635.5781"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1797.1309"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2500.3789"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2619.6211"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2738.8633"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3373" y="3480.7324"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3373" y="3599.9746"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="400.3477" style="stroke: #000000; stroke-width: 2.0;" width="4633" x="38" y="4560.7441"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4024" x="637" y="4614.3652"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="400.3477" style="stroke: #000000; stroke-width: 2.0;" width="4580" x="91" y="4975.0918"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4024" x="637" y="5028.7129"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="69" x2="69" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="123" x2="123" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="352.5" x2="352.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="763" x2="763" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1288.5" x2="1288.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1449.5" x2="1449.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1833.5" x2="1833.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2308.5" x2="2308.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2636.5" x2="2636.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3253.5" x2="3253.5" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3464" x2="3464" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3760" x2="3760" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3892" x2="3892" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3989" x2="3989" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4087" x2="4087" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4207" x2="4207" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4334" x2="4334" y1="137.2871" y2="5399.4395"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4603" x2="4603" y1="137.2871" y2="5399.4395"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="48" y="134.334">Payer</text><ellipse cx="69.5" cy="63.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,71.7988 L69.5,98.7988 M56.5,79.7988 L82.5,79.7988 M69.5,98.7988 L56.5,113.7988 M69.5,98.7988 L82.5,113.7988 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="48" y="5411.9746">Payer</text><ellipse cx="69.5" cy="5424.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M69.5,5432.9277 L69.5,5459.9277 M56.5,5440.9277 L82.5,5440.9277 M69.5,5459.9277 L56.5,5474.9277 M69.5,5459.9277 L82.5,5474.9277 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="101" y="134.334">Payee</text><ellipse cx="123.5" cy="63.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M123.5,71.7988 L123.5,98.7988 M110.5,79.7988 L136.5,79.7988 M123.5,98.7988 L110.5,113.7988 M123.5,98.7988 L136.5,113.7988 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="101" y="5411.9746">Payee</text><ellipse cx="123.5" cy="5424.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M123.5,5432.9277 L123.5,5459.9277 M110.5,5440.9277 L136.5,5440.9277 M123.5,5459.9277 L110.5,5474.9277 M123.5,5459.9277 L136.5,5474.9277 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="297.5" y="134.334">ML API Adapter</text><path d="M332,92.7988 L332,116.7988 M332,104.7988 L349,104.7988 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="361" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="297.5" y="5411.9746">ML API Adapter</text><path d="M332,5418.9277 L332,5442.9277 M332,5430.9277 L349,5430.9277 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="361" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="647" y="134.334">ML API Notification Event Handler</text><ellipse cx="763.5" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="759.5,92.7988,765.5,87.7988,763.5,92.7988,765.5,97.7988,759.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="647" y="5411.9746">ML API Notification Event Handler</text><ellipse cx="763.5" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="759.5,5418.9277,765.5,5413.9277,763.5,5418.9277,765.5,5423.9277,759.5,5418.9277" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1221.5" y="134.334">Central Service API</text><path d="M1268,92.7988 L1268,116.7988 M1268,104.7988 L1285,104.7988 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1297" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1221.5" y="5411.9746">Central Service API</text><path d="M1268,5418.9277 L1268,5442.9277 M1268,5430.9277 L1285,5430.9277 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1297" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1369.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1365.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="1372.5" y="122.334">Prepare-Topic-dfsp1</text><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1369.5" y="5398.4395"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1365.5" y="5402.4395"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="1372.5" y="5422.9746">Prepare-Topic-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1754.5" y="134.334">Prepare Event Handler</text><ellipse cx="1833.5" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1829.5,92.7988,1835.5,87.7988,1833.5,92.7988,1835.5,97.7988,1829.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1754.5" y="5411.9746">Prepare Event Handler</text><ellipse cx="1833.5" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1829.5,5418.9277,1835.5,5413.9277,1833.5,5418.9277,1835.5,5423.9277,1829.5,5418.9277" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2227.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2223.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="148" x="2230.5" y="122.334">Position-Topic-dfsp1</text><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2227.5" y="5398.4395"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2223.5" y="5402.4395"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="148" x="2230.5" y="5422.9746">Position-Topic-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2556.5" y="134.334">Position Event Handler</text><ellipse cx="2636.5" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2632.5,92.7988,2638.5,87.7988,2636.5,92.7988,2638.5,97.7988,2632.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2556.5" y="5411.9746">Position Event Handler</text><ellipse cx="2636.5" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2632.5,5418.9277,2638.5,5413.9277,2636.5,5418.9277,2638.5,5423.9277,2632.5,5418.9277" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3194.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3190.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="3197.5" y="122.334">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3194.5" y="5398.4395"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3190.5" y="5402.4395"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="3197.5" y="5422.9746">Transfer-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="3383" y="134.334">Transfer Event Handler</text><ellipse cx="3464.5" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="3460.5,92.7988,3466.5,87.7988,3464.5,92.7988,3466.5,97.7988,3460.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="3383" y="5411.9746">Transfer Event Handler</text><ellipse cx="3464.5" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="3460.5,5418.9277,3466.5,5413.9277,3464.5,5418.9277,3466.5,5423.9277,3460.5,5418.9277" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="3691" y="97.7988"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="3687" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="3694" y="122.334">Notification-Topic</text><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="3691" y="5398.4395"/><rect fill="#FEFECE" filter="url(#falvgq7rmgcqk)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="3687" y="5402.4395"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="3694" y="5422.9746">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3844" y="134.334">Position DAO</text><ellipse cx="3892" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3880" x2="3904" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3844" y="5411.9746">Position DAO</text><ellipse cx="3892" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3880" x2="3904" y1="5444.9277" y2="5444.9277"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3950" y="134.334">Event DAO</text><ellipse cx="3989" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3977" x2="4001" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3950" y="5411.9746">Event DAO</text><ellipse cx="3989" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3977" x2="4001" y1="5444.9277" y2="5444.9277"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="4038" y="134.334">Transfer DAO</text><ellipse cx="4087.5" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4075.5" x2="4099.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="4038" y="5411.9746">Transfer DAO</text><ellipse cx="4087.5" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4075.5" x2="4099.5" y1="5444.9277" y2="5444.9277"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="4147" y="134.334">Notification DAO</text><ellipse cx="4207" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4195" x2="4219" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="4147" y="5411.9746">Notification DAO</text><ellipse cx="4207" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4195" x2="4219" y1="5444.9277" y2="5444.9277"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="4277" y="134.334">Participant DAO</text><ellipse cx="4334" cy="104.7988" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4322" x2="4346" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="4277" y="5411.9746">Participant DAO</text><ellipse cx="4334" cy="5430.9277" fill="#FEFECE" filter="url(#falvgq7rmgcqk)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4322" x2="4346" y1="5444.9277" y2="5444.9277"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4555" y="134.334">Central Store</text><path d="M4585,84.7988 C4585,74.7988 4603,74.7988 4603,74.7988 C4603,74.7988 4621,74.7988 4621,84.7988 L4621,110.7988 C4621,120.7988 4603,120.7988 4603,120.7988 C4603,120.7988 4585,120.7988 4585,110.7988 L4585,84.7988 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M4585,84.7988 C4585,94.7988 4603,94.7988 4603,94.7988 C4603,94.7988 4621,94.7988 4621,84.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4555" y="5411.9746">Central Store</text><path d="M4585,5424.9277 C4585,5414.9277 4603,5414.9277 4603,5414.9277 C4603,5414.9277 4621,5414.9277 4621,5424.9277 L4621,5450.9277 C4621,5460.9277 4603,5460.9277 4603,5460.9277 C4603,5460.9277 4585,5460.9277 4585,5450.9277 L4585,5424.9277 " fill="#FEFECE" filter="url(#falvgq7rmgcqk)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M4585,5424.9277 C4585,5434.9277 4603,5434.9277 4603,5434.9277 C4603,5434.9277 4621,5434.9277 4621,5424.9277 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1138.5645" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="347.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="407.3477" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="758.5" y="4545.4336"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1169.9063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1828.5" y="1285.8516"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="980.3535" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2631.5" y="2455.7578"/><rect fill="#FFFFFF" filter="url(#falvgq7rmgcqk)" height="1109.3223" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3459.5" y="3436.1113"/><rect fill="none" height="5228.1523" style="stroke: #000000; stroke-width: 2.0;" width="4653" x="28" y="154.2871"/><polygon fill="#EEEEEE" points="28,154.2871,90,154.2871,90,161.2871,80,171.2871,28,171.2871,28,154.2871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="43" y="167.8555">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="282" x="105" y="166.9219">[DFSP1 sends a Prepare Transfer request to Payee]</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="74,176.5977,74,706.5977,415,706.5977,415,186.5977,405,176.5977,74,176.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="405" x2="405" y1="176.5977" y2="186.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="415" x2="405" y1="186.5977" y2="186.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="80" y="194.166">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="96" y="209.4766">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="96" y="224.7871">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="96" y="240.0977">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="96" y="255.4082">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="96" y="270.7188">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="96" y="286.0293">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="96" y="301.3398">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="96" y="316.6504">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="96" y="331.9609">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="96" y="347.2715">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="80" y="362.582">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="84" y="377.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="80" y="393.2031">Payload - transferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="80" y="408.5137">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="96" y="423.8242">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="96" y="439.1348">"payeeFsp": dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="96" y="454.4453">"payerFsp": dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="96" y="469.7559">"amount": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="112" y="485.0664">"currency": "AED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="112" y="500.377">"amount": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="96" y="515.6875">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="96" y="530.998">"ilpPacket": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="96" y="546.3086">"condition": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="96" y="561.6191">"expiration": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="96" y="576.9297">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="112" y="592.2402">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="128" y="607.5508">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="144" y="622.8613">"key": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="144" y="638.1719">"value": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="128" y="653.4824">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="112" y="668.793">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="96" y="684.1035">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="80" y="699.4141">}</text><polygon fill="#A80036" points="335.5,733.1563,345.5,737.1563,335.5,741.1563,339.5,737.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="69.5" x2="341.5" y1="737.1563" y2="737.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="76.5" y="732.7246">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="89.5" y="732.7246">POST - http://transfers</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="357.5" x2="399.5" y1="766.7773" y2="766.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="399.5" x2="399.5" y1="766.7773" y2="779.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="358.5" x2="399.5" y1="779.7773" y2="779.7773"/><polygon fill="#A80036" points="368.5,775.7773,358.5,779.7773,368.5,783.7773,364.5,779.7773" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="364.5" y="762.0352">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="377.5" y="762.0352">validates incoming token, and the originator matches Payer</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="362,792.7773,362,1154.7773,624,1154.7773,624,802.7773,614,792.7773,362,792.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="614" x2="614" y1="792.7773" y2="802.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="624" x2="614" y1="802.7773" y2="802.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="368" y="810.3457">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="368" y="825.6563">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="384" y="840.9668">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="384" y="856.2773">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="384" y="871.5879">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="384" y="886.8984">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="384" y="902.209">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="400" y="917.5195">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="400" y="932.8301">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="384" y="948.1406">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="384" y="963.4512">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="400" y="978.7617">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="416" y="994.0723">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="416" y="1009.3828">type: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="416" y="1024.6934">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="416" y="1040.0039">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="416" y="1055.3145">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="432" y="1070.625">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="432" y="1085.9355">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="416" y="1101.2461">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="400" y="1116.5566">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="384" y="1131.8672">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="368" y="1147.1777">}</text><polygon fill="#A80036" points="1437.5,1180.9199,1447.5,1184.9199,1437.5,1188.9199,1441.5,1184.9199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357.5" x2="1443.5" y1="1184.9199" y2="1184.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="364.5" y="1180.4883">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="377.5" y="1180.4883">Routes &amp; Publishes Prepare event for Payer</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1449.5" x2="1491.5" y1="1214.541" y2="1214.541"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1491.5" x2="1491.5" y1="1214.541" y2="1227.541"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1450.5" x2="1491.5" y1="1227.541" y2="1227.541"/><polygon fill="#A80036" points="1460.5,1223.541,1450.5,1227.541,1460.5,1231.541,1456.5,1227.541" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1456.5" y="1209.7988">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1469.5" y="1209.7988">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="368.5,1252.541,358.5,1256.541,368.5,1260.541,364.5,1256.541" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1448.5" y1="1256.541" y2="1256.541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="374.5" y="1252.1094">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="387.5" y="1252.1094">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="80.5,1281.8516,70.5,1285.8516,80.5,1289.8516,76.5,1285.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74.5" x2="351.5" y1="1285.8516" y2="1285.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="86.5" y="1281.4199">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="99.5" y="1281.4199">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="1816.5,1311.1621,1826.5,1315.1621,1816.5,1319.1621,1820.5,1315.1621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1449.5" x2="1822.5" y1="1315.1621" y2="1315.1621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1456.5" y="1310.7305">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="1469.5" y="1310.7305">Consumes Prepare event message for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1330.4727"/><polygon fill="#EEEEEE" points="1744.5,1330.4727,1806.5,1330.4727,1806.5,1337.4727,1796.5,1347.4727,1744.5,1347.4727,1744.5,1330.4727" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1759.5" y="1344.041">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="1821.5" y="1343.1074">[Persist Event Information]</text><polygon fill="#A80036" points="3977,1364.7832,3987,1368.7832,3977,1372.7832,3981,1368.7832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="3983" y1="1368.7832" y2="1368.7832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1845.5" y="1364.3516">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1858.5" y="1364.3516">Request to persist event information</text><polygon fill="#A80036" points="4000,1394.0938,3990,1398.0938,4000,1402.0938,3996,1398.0938" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,1394.0938,4601,1398.0938,4591,1402.0938,4595,1398.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3994" x2="4597" y1="1398.0938" y2="1398.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="4006" y="1393.6621">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4019" y="1393.6621">Persist event information</text><polygon fill="#A80036" points="1849.5,1423.4043,1839.5,1427.4043,1849.5,1431.4043,1845.5,1427.4043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1843.5" x2="3988" y1="1427.4043" y2="1427.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1855.5" y="1422.9727">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1877.5" y="1422.9727">return success</text><rect fill="none" height="586.5898" style="stroke: #000000; stroke-width: 2.0;" width="2936.5" x="1734.5" y="1449.7148"/><polygon fill="#EEEEEE" points="1734.5,1449.7148,1796.5,1449.7148,1796.5,1456.7148,1786.5,1466.7148,1734.5,1466.7148,1734.5,1449.7148" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1749.5" y="1463.2832">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="151" x="1811.5" y="1462.3496">[Validate Prepare Transfer]</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1474.0254"/><polygon fill="#EEEEEE" points="1744.5,1474.0254,1806.5,1474.0254,1806.5,1481.0254,1796.5,1491.0254,1744.5,1491.0254,1744.5,1474.0254" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1759.5" y="1487.5938">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="1821.5" y="1486.6602">[Validate Payer]</text><polygon fill="#A80036" points="4322,1508.3359,4332,1512.3359,4322,1516.3359,4326,1512.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="4328" y1="1512.3359" y2="1512.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1507.9043">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="348" x="1867.5" y="1507.9043">Request to retrieve Payer Participant details (if it exists)</text><polygon fill="#A80036" points="4345,1537.6465,4335,1541.6465,4345,1545.6465,4341,1541.6465" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,1537.6465,4601,1541.6465,4591,1545.6465,4595,1541.6465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4339" x2="4597" y1="1541.6465" y2="1541.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4351" y="1537.2148">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4373" y="1537.2148">return Participant details if it exists</text><polygon fill="#A80036" points="1849.5,1566.957,1839.5,1570.957,1849.5,1574.957,1845.5,1570.957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1843.5" x2="4333" y1="1570.957" y2="1570.957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1855.5" y="1566.5254">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1877.5" y="1566.5254">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="1880.5" y1="1600.5781" y2="1600.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1880.5" x2="1880.5" y1="1600.5781" y2="1613.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1839.5" x2="1880.5" y1="1613.5781" y2="1613.5781"/><polygon fill="#A80036" points="1849.5,1609.5781,1839.5,1613.5781,1849.5,1617.5781,1845.5,1613.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1595.8359">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1867.5" y="1595.8359">Validates payer</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1635.5781"/><polygon fill="#EEEEEE" points="1744.5,1635.5781,1806.5,1635.5781,1806.5,1642.5781,1796.5,1652.5781,1744.5,1652.5781,1744.5,1635.5781" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1759.5" y="1649.1465">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="1821.5" y="1648.2129">[Validate Payee]</text><polygon fill="#A80036" points="4322,1669.8887,4332,1673.8887,4322,1677.8887,4326,1673.8887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="4328" y1="1673.8887" y2="1673.8887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1669.457">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="350" x="1867.5" y="1669.457">Request to retrieve Payee Participant details (if it exists)</text><polygon fill="#A80036" points="4345,1699.1992,4335,1703.1992,4345,1707.1992,4341,1703.1992" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,1699.1992,4601,1703.1992,4591,1707.1992,4595,1703.1992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4339" x2="4597" y1="1703.1992" y2="1703.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4351" y="1698.7676">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4373" y="1698.7676">return Participant details if it exists</text><polygon fill="#A80036" points="1849.5,1728.5098,1839.5,1732.5098,1849.5,1736.5098,1845.5,1732.5098" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1843.5" x2="4333" y1="1732.5098" y2="1732.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1855.5" y="1728.0781">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1877.5" y="1728.0781">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="1880.5" y1="1762.1309" y2="1762.1309"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1880.5" x2="1880.5" y1="1762.1309" y2="1775.1309"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1839.5" x2="1880.5" y1="1775.1309" y2="1775.1309"/><polygon fill="#A80036" points="1849.5,1771.1309,1839.5,1775.1309,1849.5,1779.1309,1845.5,1775.1309" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1757.3887">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="1867.5" y="1757.3887">Validates payee</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="2916.5" x="1744.5" y="1797.1309"/><polygon fill="#EEEEEE" points="1744.5,1797.1309,1806.5,1797.1309,1806.5,1804.1309,1796.5,1814.1309,1744.5,1814.1309,1744.5,1797.1309" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1759.5" y="1810.6992">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="1821.5" y="1809.7656">[Duplicate check]</text><polygon fill="#A80036" points="4075.5,1831.4414,4085.5,1835.4414,4075.5,1839.4414,4079.5,1835.4414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="4081.5" y1="1835.4414" y2="1835.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1831.0098">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="1867.5" y="1831.0098">Request to retrieve Transfer (if it exists)</text><polygon fill="#A80036" points="4098.5,1860.752,4088.5,1864.752,4098.5,1868.752,4094.5,1864.752" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,1860.752,4601,1864.752,4591,1868.752,4595,1864.752" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4092.5" x2="4597" y1="1864.752" y2="1864.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4104.5" y="1860.3203">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="4126.5" y="1860.3203">return Transfer if it exists</text><polygon fill="#A80036" points="1849.5,1890.0625,1839.5,1894.0625,1849.5,1898.0625,1845.5,1894.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1843.5" x2="4086.5" y1="1894.0625" y2="1894.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1855.5" y="1889.6309">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1877.5" y="1889.6309">return Transfer if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="1880.5" y1="1923.6836" y2="1923.6836"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1880.5" x2="1880.5" y1="1923.6836" y2="1936.6836"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1839.5" x2="1880.5" y1="1936.6836" y2="1936.6836"/><polygon fill="#A80036" points="1849.5,1932.6836,1839.5,1936.6836,1849.5,1940.6836,1845.5,1936.6836" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1918.9414">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1867.5" y="1918.9414">Validates duplicate Check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="1880.5" y1="1972.9941" y2="1972.9941"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1880.5" x2="1880.5" y1="1972.9941" y2="1985.9941"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1839.5" x2="1880.5" y1="1985.9941" y2="1985.9941"/><polygon fill="#A80036" points="1849.5,1981.9941,1839.5,1985.9941,1849.5,1989.9941,1845.5,1985.9941" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="1968.252">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1867.5" y="1968.252">Validates crypto-condition</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1838.5" x2="1880.5" y1="2015.3047" y2="2015.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1880.5" x2="1880.5" y1="2015.3047" y2="2028.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1839.5" x2="1880.5" y1="2028.3047" y2="2028.3047"/><polygon fill="#A80036" points="1849.5,2024.3047,1839.5,2028.3047,1849.5,2032.3047,1845.5,2028.3047" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1845.5" y="2010.5625">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="1867.5" y="2010.5625">Validates message signature (to be confirmed in future requirement)</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="1843,2048.3047,1843,2425.3047,2105,2425.3047,2105,2058.3047,2095,2048.3047,1843,2048.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2095" x2="2095" y1="2048.3047" y2="2058.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2105" x2="2095" y1="2058.3047" y2="2058.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="1849" y="2065.873">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1849" y="2081.1836">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="1865" y="2096.4941">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="1865" y="2111.8047">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1865" y="2127.1152">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1865" y="2142.4258">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="1865" y="2157.7363">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="1881" y="2173.0469">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="1881" y="2188.3574">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1865" y="2203.668">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1865" y="2218.9785">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1881" y="2234.2891">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1897" y="2249.5996">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1897" y="2264.9102">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="1897" y="2280.2207">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="1897" y="2295.5313">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="1897" y="2310.8418">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1897" y="2326.1523">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1913" y="2341.4629">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1913" y="2356.7734">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1897" y="2372.084">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1881" y="2387.3945">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1865" y="2402.7051">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1849" y="2418.0156">}</text><polygon fill="#A80036" points="2296.5,2451.7578,2306.5,2455.7578,2296.5,2459.7578,2300.5,2455.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1833.5" x2="2302.5" y1="2455.7578" y2="2455.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1840.5" y="2451.3262">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="1862.5" y="2451.3262">Routes &amp; Publishes Position event for Payer</text><polygon fill="#A80036" points="2619.5,2481.0684,2629.5,2485.0684,2619.5,2489.0684,2623.5,2485.0684" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2308.5" x2="2625.5" y1="2485.0684" y2="2485.0684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2315.5" y="2480.6367">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="2337.5" y="2480.6367">Consumes Position event message for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2500.3789"/><polygon fill="#EEEEEE" points="2546.5,2500.3789,2608.5,2500.3789,2608.5,2507.3789,2598.5,2517.3789,2546.5,2517.3789,2546.5,2500.3789" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="2561.5" y="2513.9473">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="2623.5" y="2513.0137">[Persist Event Information]</text><polygon fill="#A80036" points="3977,2534.6895,3987,2538.6895,3977,2542.6895,3981,2538.6895" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="3983" y1="2538.6895" y2="2538.6895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2534.2578">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="2670.5" y="2534.2578">Request to persist event information</text><polygon fill="#A80036" points="4000,2564,3990,2568,4000,2572,3996,2568" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,2564,4601,2568,4591,2572,4595,2568" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3994" x2="4597" y1="2568" y2="2568"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4006" y="2563.5684">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4028" y="2563.5684">Persist event information</text><polygon fill="#A80036" points="2652.5,2593.3105,2642.5,2597.3105,2652.5,2601.3105,2648.5,2597.3105" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2646.5" x2="3988" y1="2597.3105" y2="2597.3105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2658.5" y="2592.8789">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2680.5" y="2592.8789">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2619.6211"/><polygon fill="#EEEEEE" points="2546.5,2619.6211,2608.5,2619.6211,2608.5,2626.6211,2598.5,2636.6211,2546.5,2636.6211,2546.5,2619.6211" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="2561.5" y="2633.1895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="336" x="2623.5" y="2632.2559">[Persist Prepare Transfer State with transferState='pending']</text><polygon fill="#A80036" points="4075.5,2653.9316,4085.5,2657.9316,4075.5,2661.9316,4079.5,2657.9316" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="4081.5" y1="2657.9316" y2="2657.9316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2653.5">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="2670.5" y="2653.5">Request to persist transfer</text><polygon fill="#A80036" points="4098.5,2683.2422,4088.5,2687.2422,4098.5,2691.2422,4094.5,2687.2422" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,2683.2422,4601,2687.2422,4591,2691.2422,4595,2687.2422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4092.5" x2="4597" y1="2687.2422" y2="2687.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4104.5" y="2682.8105">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="4126.5" y="2682.8105">Persist transfer</text><polygon fill="#A80036" points="2652.5,2712.5527,2642.5,2716.5527,2652.5,2720.5527,2648.5,2716.5527" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2646.5" x2="4086.5" y1="2716.5527" y2="2716.5527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2658.5" y="2712.1211">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2680.5" y="2712.1211">return success</text><rect fill="none" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2114.5" x="2546.5" y="2738.8633"/><polygon fill="#EEEEEE" points="2546.5,2738.8633,2608.5,2738.8633,2608.5,2745.8633,2598.5,2755.8633,2546.5,2755.8633,2546.5,2738.8633" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="2561.5" y="2752.4316">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="218" x="2623.5" y="2751.498">[Calculate position and persist change]</text><polygon fill="#A80036" points="3880,2773.1738,3890,2777.1738,3880,2781.1738,3884,2777.1738" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="3886" y1="2777.1738" y2="2777.1738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2772.7422">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="2670.5" y="2772.7422">Request latest position from DB for Payer</text><polygon fill="#A80036" points="3903,2802.4844,3893,2806.4844,3903,2810.4844,3899,2806.4844" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,2802.4844,4601,2806.4844,4591,2810.4844,4595,2806.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3897" x2="4597" y1="2806.4844" y2="2806.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3909" y="2802.0527">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="3931" y="2802.0527">Retrieves latest position from DB for Payer</text><polygon fill="#A80036" points="2652.5,2831.7949,2642.5,2835.7949,2652.5,2839.7949,2648.5,2835.7949" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2646.5" x2="3891" y1="2835.7949" y2="2835.7949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2658.5" y="2831.3633">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="2680.5" y="2831.3633">Return latest position</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="2683.5" y1="2865.416" y2="2865.416"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2683.5" x2="2683.5" y1="2865.416" y2="2878.416"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2642.5" x2="2683.5" y1="2878.416" y2="2878.416"/><polygon fill="#A80036" points="2652.5,2874.416,2642.5,2878.416,2652.5,2882.416,2648.5,2878.416" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2860.6738">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="2670.5" y="2860.6738">Calculates latest position (lpos) by incrementing transfer for prepare</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="2683.5" y1="2907.7266" y2="2907.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2683.5" x2="2683.5" y1="2907.7266" y2="2920.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2642.5" x2="2683.5" y1="2920.7266" y2="2920.7266"/><polygon fill="#A80036" points="2652.5,2916.7266,2642.5,2920.7266,2652.5,2924.7266,2648.5,2920.7266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2902.9844">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="571" x="2670.5" y="2902.9844">Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos &lt; netcap</text><polygon fill="#A80036" points="3880,2945.7266,3890,2949.7266,3880,2953.7266,3884,2949.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2641.5" x2="3886" y1="2949.7266" y2="2949.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2648.5" y="2945.2949">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="2670.5" y="2945.2949">Request to persist latest position for Payer</text><polygon fill="#A80036" points="3903,2975.0371,3893,2979.0371,3903,2983.0371,3899,2979.0371" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,2975.0371,4601,2979.0371,4591,2983.0371,4595,2979.0371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3897" x2="4597" y1="2979.0371" y2="2979.0371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3909" y="2974.6055">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="3931" y="2974.6055">Persists latest position to DB for Payer</text><polygon fill="#A80036" points="2652.5,3004.3477,2642.5,3008.3477,2652.5,3012.3477,2648.5,3008.3477" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2646.5" x2="3891" y1="3008.3477" y2="3008.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2658.5" y="3003.916">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2680.5" y="3003.916">return success</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="2646,3028.6582,2646,3405.6582,2908,3405.6582,2908,3038.6582,2898,3028.6582,2646,3028.6582" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2898" x2="2898" y1="3028.6582" y2="3038.6582"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2908" x2="2898" y1="3038.6582" y2="3038.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2652" y="3046.2266">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2652" y="3061.5371">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="2668" y="3076.8477">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="2668" y="3092.1582">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="2668" y="3107.4688">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="2668" y="3122.7793">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="2668" y="3138.0898">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="2684" y="3153.4004">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="2684" y="3168.7109">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="2668" y="3184.0215">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2668" y="3199.332">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2684" y="3214.6426">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="2700" y="3229.9531">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="2700" y="3245.2637">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="2700" y="3260.5742">type: transfer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="2700" y="3275.8848">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2700" y="3291.1953">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="2700" y="3306.5059">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="2716" y="3321.8164">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2716" y="3337.127">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2700" y="3352.4375">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2684" y="3367.748">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2668" y="3383.0586">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2652" y="3398.3691">}</text><polygon fill="#A80036" points="3241.5,3432.1113,3251.5,3436.1113,3241.5,3440.1113,3245.5,3436.1113" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2636.5" x2="3247.5" y1="3436.1113" y2="3436.1113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2643.5" y="3431.6797">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="2665.5" y="3431.6797">Publishes Transfer event</text><polygon fill="#A80036" points="3447.5,3461.4219,3457.5,3465.4219,3447.5,3469.4219,3451.5,3465.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3253.5" x2="3453.5" y1="3465.4219" y2="3465.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3260.5" y="3460.9902">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="3282.5" y="3460.9902">Consumes Transfer event</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3373" y="3480.7324"/><polygon fill="#EEEEEE" points="3373,3480.7324,3435,3480.7324,3435,3487.7324,3425,3497.7324,3373,3497.7324,3373,3480.7324" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="3388" y="3494.3008">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="3450" y="3493.3672">[Persist Event Information]</text><polygon fill="#A80036" points="3977,3515.043,3987,3519.043,3977,3523.043,3981,3519.043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3469.5" x2="3983" y1="3519.043" y2="3519.043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3476.5" y="3514.6113">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="3498.5" y="3514.6113">Request to persist event information</text><polygon fill="#A80036" points="4000,3544.3535,3990,3548.3535,4000,3552.3535,3996,3548.3535" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,3544.3535,4601,3548.3535,4591,3552.3535,4595,3548.3535" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3994" x2="4597" y1="3548.3535" y2="3548.3535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4006" y="3543.9219">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4028" y="3543.9219">Persist event information</text><polygon fill="#A80036" points="3480.5,3573.6641,3470.5,3577.6641,3480.5,3581.6641,3476.5,3577.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3474.5" x2="3988" y1="3577.6641" y2="3577.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3486.5" y="3573.2324">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3508.5" y="3573.2324">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3373" y="3599.9746"/><polygon fill="#EEEEEE" points="3373,3599.9746,3435,3599.9746,3435,3606.9746,3425,3616.9746,3373,3616.9746,3373,3599.9746" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="3388" y="3613.543">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="339" x="3450" y="3612.6094">[Update Prepare Transfer State with transferState='accepted']</text><polygon fill="#A80036" points="4075.5,3634.2852,4085.5,3638.2852,4075.5,3642.2852,4079.5,3638.2852" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3469.5" x2="4081.5" y1="3638.2852" y2="3638.2852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3476.5" y="3633.8535">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="3498.5" y="3633.8535">Request to update transfer</text><polygon fill="#A80036" points="4098.5,3663.5957,4088.5,3667.5957,4098.5,3671.5957,4094.5,3667.5957" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,3663.5957,4601,3667.5957,4591,3671.5957,4595,3667.5957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4092.5" x2="4597" y1="3667.5957" y2="3667.5957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4104.5" y="3663.1641">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="4126.5" y="3663.1641">Update transfer</text><polygon fill="#A80036" points="3480.5,3692.9063,3470.5,3696.9063,3480.5,3700.9063,3476.5,3696.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3474.5" x2="4086.5" y1="3696.9063" y2="3696.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3486.5" y="3692.4746">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3508.5" y="3692.4746">return success</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="3474,3717.2168,3474,4094.2168,3736,4094.2168,3736,3727.2168,3726,3717.2168,3474,3717.2168" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3726" x2="3726" y1="3717.2168" y2="3727.2168"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3736" x2="3726" y1="3727.2168" y2="3727.2168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3480" y="3734.7852">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3480" y="3750.0957">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3496" y="3765.4063">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3496" y="3780.7168">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3496" y="3796.0273">to: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3496" y="3811.3379">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3496" y="3826.6484">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3512" y="3841.959">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3512" y="3857.2695">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3496" y="3872.5801">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3496" y="3887.8906">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3512" y="3903.2012">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3528" y="3918.5117">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3528" y="3933.8223">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3528" y="3949.1328">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3528" y="3964.4434">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3528" y="3979.7539">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3528" y="3995.0645">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3544" y="4010.375">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3544" y="4025.6855">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3528" y="4040.9961">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3512" y="4056.3066">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3496" y="4071.6172">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3480" y="4086.9277">}</text><polygon fill="#A80036" points="3748.5,4120.6699,3758.5,4124.6699,3748.5,4128.6699,3752.5,4124.6699" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3469.5" x2="3754.5" y1="4124.6699" y2="4124.6699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3476.5" y="4120.2383">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="3498.5" y="4120.2383">Publishes Notifications event for Payer</text><polygon fill="#FFFF00" filter="url(#falvgq7rmgcqk)" points="3474,4137.9805,3474,4514.9805,3736,4514.9805,3736,4147.9805,3726,4137.9805,3474,4137.9805" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3726" x2="3726" y1="4137.9805" y2="4147.9805"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3736" x2="3726" y1="4147.9805" y2="4147.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3480" y="4155.5488">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3480" y="4170.8594">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3496" y="4186.1699">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3496" y="4201.4805">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="3496" y="4216.791">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3496" y="4232.1016">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3496" y="4247.4121">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3512" y="4262.7227">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3512" y="4278.0332">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3496" y="4293.3438">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3496" y="4308.6543">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3512" y="4323.9648">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3528" y="4339.2754">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3528" y="4354.5859">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3528" y="4369.8965">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3528" y="4385.207">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3528" y="4400.5176">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3528" y="4415.8281">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3544" y="4431.1387">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3544" y="4446.4492">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3528" y="4461.7598">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3512" y="4477.0703">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3496" y="4492.3809">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3480" y="4507.6914">}</text><polygon fill="#A80036" points="3748.5,4541.4336,3758.5,4545.4336,3748.5,4549.4336,3752.5,4545.4336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3464.5" x2="3754.5" y1="4545.4336" y2="4545.4336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3471.5" y="4541.002">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="3493.5" y="4541.002">Publishes Notifications event for Payee</text><rect fill="none" height="400.3477" style="stroke: #000000; stroke-width: 2.0;" width="4633" x="38" y="4560.7441"/><polygon fill="#EEEEEE" points="38,4560.7441,100,4560.7441,100,4567.7441,90,4577.7441,38,4577.7441,38,4560.7441" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="53" y="4574.3125">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="115" y="4573.3789">[Send notification for Payer]</text><polygon fill="#A80036" points="779.5,4595.0547,769.5,4599.0547,779.5,4603.0547,775.5,4599.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="3759.5" y1="4599.0547" y2="4599.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="785.5" y="4594.623">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="807.5" y="4594.623">Consumes Notifications event</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4024" x="637" y="4614.3652"/><polygon fill="#EEEEEE" points="637,4614.3652,699,4614.3652,699,4621.3652,689,4631.3652,637,4631.3652,637,4614.3652" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="652" y="4627.9336">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="714" y="4627">[Persist Event Information]</text><polygon fill="#A80036" points="1276.5,4648.6758,1286.5,4652.6758,1276.5,4656.6758,1280.5,4652.6758" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1282.5" y1="4652.6758" y2="4652.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="775.5" y="4648.2441">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="797.5" y="4648.2441">Requests to persist event information - POST - HTTP://events/</text><polygon fill="#A80036" points="3977,4677.9863,3987,4681.9863,3977,4685.9863,3981,4681.9863" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1288.5" x2="3983" y1="4681.9863" y2="4681.9863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1295.5" y="4677.5547">53</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1317.5" y="4677.5547">Request to persist event information</text><polygon fill="#A80036" points="4000,4707.2969,3990,4711.2969,4000,4715.2969,3996,4711.2969" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,4707.2969,4601,4711.2969,4591,4715.2969,4595,4711.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3994" x2="4597" y1="4711.2969" y2="4711.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4006" y="4706.8652">54</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4028" y="4706.8652">Persist event information</text><polygon fill="#A80036" points="1299.5,4736.6074,1289.5,4740.6074,1299.5,4744.6074,1295.5,4740.6074" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="3988" y1="4740.6074" y2="4740.6074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1305.5" y="4736.1758">55</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1327.5" y="4736.1758">return success</text><polygon fill="#A80036" points="779.5,4765.918,769.5,4769.918,779.5,4773.918,775.5,4769.918" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1287.5" y1="4769.918" y2="4769.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="785.5" y="4765.4863">56</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="807.5" y="4765.4863">return success</text><polygon fill="#A80036" points="1276.5,4802.2285,1286.5,4806.2285,1276.5,4810.2285,1280.5,4806.2285" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1282.5" y1="4806.2285" y2="4806.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="775.5" y="4801.7969">57</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="474" x="797.5" y="4801.7969">Requests Notification details for Payer - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="4195,4831.5391,4205,4835.5391,4195,4839.5391,4199,4835.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1288.5" x2="4201" y1="4835.5391" y2="4835.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1295.5" y="4831.1074">58</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1317.5" y="4831.1074">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="4218,4860.8496,4208,4864.8496,4218,4868.8496,4214,4864.8496" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,4860.8496,4601,4864.8496,4591,4868.8496,4595,4864.8496" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4212" x2="4597" y1="4864.8496" y2="4864.8496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4224" y="4860.418">59</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="4246" y="4860.418">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="1299.5,4890.1602,1289.5,4894.1602,1299.5,4898.1602,1295.5,4894.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="4206" y1="4894.1602" y2="4894.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1305.5" y="4889.7285">60</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1327.5" y="4889.7285">Returns Notifications details for Payer</text><polygon fill="#A80036" points="779.5,4919.4707,769.5,4923.4707,779.5,4927.4707,775.5,4923.4707" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1287.5" y1="4923.4707" y2="4923.4707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="785.5" y="4919.0391">61</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="807.5" y="4919.0391">Returns Notifications details for Payer</text><polygon fill="#A80036" points="80.5,4948.7813,70.5,4952.7813,80.5,4956.7813,76.5,4952.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74.5" x2="762.5" y1="4952.7813" y2="4952.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="86.5" y="4948.3496">62</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="108.5" y="4948.3496">HTTP Callback with Prepare result to Payer</text><rect fill="none" height="400.3477" style="stroke: #000000; stroke-width: 2.0;" width="4580" x="91" y="4975.0918"/><polygon fill="#EEEEEE" points="91,4975.0918,153,4975.0918,153,4982.0918,143,4992.0918,91,4992.0918,91,4975.0918" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="106" y="4988.6602">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="159" x="168" y="4987.7266">[Send notification for Payee]</text><polygon fill="#A80036" points="774.5,5009.4023,764.5,5013.4023,774.5,5017.4023,770.5,5013.4023" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="3759.5" y1="5013.4023" y2="5013.4023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="780.5" y="5008.9707">63</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="802.5" y="5008.9707">Consumes Notifications event</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4024" x="637" y="5028.7129"/><polygon fill="#EEEEEE" points="637,5028.7129,699,5028.7129,699,5035.7129,689,5045.7129,637,5045.7129,637,5028.7129" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="652" y="5042.2813">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="714" y="5041.3477">[Persist Event Information]</text><polygon fill="#A80036" points="1276.5,5063.0234,1286.5,5067.0234,1276.5,5071.0234,1280.5,5067.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="763.5" x2="1282.5" y1="5067.0234" y2="5067.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="770.5" y="5062.5918">64</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="792.5" y="5062.5918">Requests to persist event information - POST - HTTP://events/</text><polygon fill="#A80036" points="3977,5092.334,3987,5096.334,3977,5100.334,3981,5096.334" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1288.5" x2="3983" y1="5096.334" y2="5096.334"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1295.5" y="5091.9023">65</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1317.5" y="5091.9023">Request to persist event information</text><polygon fill="#A80036" points="4000,5121.6445,3990,5125.6445,4000,5129.6445,3996,5125.6445" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,5121.6445,4601,5125.6445,4591,5129.6445,4595,5125.6445" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3994" x2="4597" y1="5125.6445" y2="5125.6445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4006" y="5121.2129">66</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4028" y="5121.2129">Persist event information</text><polygon fill="#A80036" points="1299.5,5150.9551,1289.5,5154.9551,1299.5,5158.9551,1295.5,5154.9551" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="3988" y1="5154.9551" y2="5154.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1305.5" y="5150.5234">67</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1327.5" y="5150.5234">return success</text><polygon fill="#A80036" points="774.5,5180.2656,764.5,5184.2656,774.5,5188.2656,770.5,5184.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1287.5" y1="5184.2656" y2="5184.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="780.5" y="5179.834">68</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="802.5" y="5179.834">return success</text><polygon fill="#A80036" points="1276.5,5216.5762,1286.5,5220.5762,1276.5,5224.5762,1280.5,5220.5762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="763.5" x2="1282.5" y1="5220.5762" y2="5220.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="770.5" y="5216.1445">69</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="476" x="792.5" y="5216.1445">Requests Notification details for Payee - GET - HTTP://notifications/DFPS2</text><polygon fill="#A80036" points="1299.5,5245.8867,1289.5,5249.8867,1299.5,5253.8867,1295.5,5249.8867" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4195,5245.8867,4205,5249.8867,4195,5253.8867,4199,5249.8867" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="4201" y1="5249.8867" y2="5249.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1305.5" y="5245.4551">70</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1327.5" y="5245.4551">Fetches Notifications details for Payee</text><polygon fill="#A80036" points="4218,5275.1973,4208,5279.1973,4218,5283.1973,4214,5279.1973" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4591,5275.1973,4601,5279.1973,4591,5283.1973,4595,5279.1973" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4212" x2="4597" y1="5279.1973" y2="5279.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4224" y="5274.7656">71</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="4246" y="5274.7656">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="1299.5,5304.5078,1289.5,5308.5078,1299.5,5312.5078,1295.5,5308.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1293.5" x2="4206" y1="5308.5078" y2="5308.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1305.5" y="5304.0762">72</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1327.5" y="5304.0762">Returns Notifications details for Payer</text><polygon fill="#A80036" points="774.5,5333.8184,764.5,5337.8184,774.5,5341.8184,770.5,5337.8184" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1287.5" y1="5337.8184" y2="5337.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="780.5" y="5333.3867">73</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="802.5" y="5333.3867">Returns Notifications details for Payer</text><polygon fill="#A80036" points="134.5,5363.1289,124.5,5367.1289,134.5,5371.1289,130.5,5367.1289" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="128.5" x2="762.5" y1="5367.1289" y2="5367.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="140.5" y="5362.6973">74</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="162.5" y="5362.6973">HTTP Callback with Prepare result to Payer</text><!--
@startuml
' declate title
title 1.1 DFSP1 sends a Prepare Transfer request to DFSP2

autonumber

' Actor Keys:
'   boundary - APIs/Interfaces, etc
'   collections - Kafka Topics
'   control - Kafka Consumers
'   entity - Database Access Objects
'   database - Database Persistance Store

' declare actors
actor "Payer" as DFSP1
actor "Payee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Prepare-Topic-dfsp1" as TOPIC_PREPARE_DFSP1
control "Prepare Event Handler" as PREP_HANDLER
collections "Position-Topic-dfsp1" as TOPIC_POSITION_DFSP1
control "Position Event Handler" as POS_HANDLER
collections "Transfer-Topic" as TOPIC_TRANSFERS
control "Transfer Event Handler" as TRANS_HANDLER
collections "Notification-Topic" as TOPIC_NOTIFICATIONS
' collections "Errors-Topic" as ERRORS_NOTIFICATIONS
entity "Position DAO" as POS_DAO
entity "Event DAO" as EVENT_DAO
entity "Transfer DAO" as TRANS_DAO
entity "Notification DAO" as NOTIFY_DAO
entity "Participant DAO" as PARTICIPANT_DAO
database "Central Store" as DB

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_PREPARE_DFSP1
    participant PREP_HANDLER
    participant TOPIC_POSITION_DFSP1
    participant POS_HANDLER
    participant TOPIC_TRANSFERS
    participant TRANS_HANDLER
    participant TOPIC_NOTIFICATIONS
    ' participant ERRORS_NOTIFICATIONS
    participant POS_DAO
    participant EVENT_DAO
    participant TRANS_DAO
    participant NOTIFY_DAO
    participant PARTICIPANT_DAO
    participant DB
end box

' start flow
alt DFSP1 sends a Prepare Transfer request to Payee
    activate MLAPI
    note right of DFSP1 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - transferMessage:
        {
            "transferId": <uuid>,
            "payeeFsp": dfsp1,
            "payerFsp": dfsp1,
            "amount": {
                "currency": "AED",
                "amount": "string"
            },
            "ilpPacket": "string",
            "condition": "string",
            "expiration": "string",
            "extensionList": {
                "extension": [
                    {
                        "key": "string",
                        "value": "string"
                    }
                ]
            }
        }
    end note
    DFSP1 -> MLAPI: POST - http://transfers
    MLAPI -> MLAPI: validates incoming token, and the originator matches Payer
    note right of MLAPI #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: prepare,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for Payer
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI

    activate PREP_HANDLER
    TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for Payer
    alt Persist Event Information
        PREP_HANDLER -> EVENT_DAO: Request to persist event information
        EVENT_DAO <-> DB: Persist event information
        EVENT_DAO -> PREP_HANDLER: return success
    end
    alt Validate Prepare Transfer
        alt Validate Payer
            PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve Payer Participant details (if it exists)
            PARTICIPANT_DAO <-> DB: return Participant details if it exists
            PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
            PREP_HANDLER <-> PREP_HANDLER: Validates payer
        end
        alt Validate Payee
            PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve Payee Participant details (if it exists)
            PARTICIPANT_DAO <-> DB: return Participant details if it exists
            PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
            PREP_HANDLER <-> PREP_HANDLER: Validates payee
        end
        alt Duplicate check
            PREP_HANDLER -> TRANS_DAO: Request to retrieve Transfer (if it exists)
            TRANS_DAO <-> DB: return Transfer if it exists
            TRANS_DAO -> PREP_HANDLER: return Transfer if it exists
            PREP_HANDLER <-> PREP_HANDLER: Validates duplicate Check
        end
        PREP_HANDLER <-> PREP_HANDLER: Validates crypto-condition
        PREP_HANDLER <-> PREP_HANDLER: Validates message signature (to be confirmed in future requirement)
    end
    note right of PREP_HANDLER #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: position,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for Payer
    deactivate PREP_HANDLER

    activate POS_HANDLER
    TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event message for Payer

    alt Persist Event Information
        POS_HANDLER -> EVENT_DAO: Request to persist event information
        EVENT_DAO <-> DB: Persist event information
        EVENT_DAO -> POS_HANDLER: return success
    end

    alt Persist Prepare Transfer State with transferState='pending'
        POS_HANDLER -> TRANS_DAO: Request to persist transfer
        TRANS_DAO <-> DB: Persist transfer
        TRANS_DAO -> POS_HANDLER: return success
    end

    alt Calculate position and persist change
        POS_HANDLER -> POS_DAO: Request latest position from DB for Payer
        POS_DAO <-> DB: Retrieves latest position from DB for Payer
        POS_DAO -> POS_HANDLER: Return latest position

        POS_HANDLER <-> POS_HANDLER: Calculates latest position (lpos) by incrementing transfer for prepare
        POS_HANDLER <-> POS_HANDLER: Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos < netcap
        
        POS_HANDLER -> POS_DAO: Request to persist latest position for Payer
        POS_DAO <-> DB: Persists latest position to DB for Payer
        POS_DAO -> POS_HANDLER: return success
    end
    note right of POS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: transfer,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    POS_HANDLER -> TOPIC_TRANSFERS: Publishes Transfer event
    deactivate POS_HANDLER

    activate TRANS_HANDLER
    TOPIC_TRANSFERS -> TRANS_HANDLER: Consumes Transfer event
    alt Persist Event Information
        TRANS_HANDLER -> EVENT_DAO: Request to persist event information
        EVENT_DAO <-> DB: Persist event information
        EVENT_DAO -> TRANS_HANDLER: return success
    end
    alt Update Prepare Transfer State with transferState='accepted'
        TRANS_HANDLER -> TRANS_DAO: Request to update transfer
        TRANS_DAO <-> DB: Update transfer
        TRANS_DAO -> TRANS_HANDLER: return success
    end
    note right of TRANS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payerFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: notification,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payer
    note right of TRANS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    responseTo: <previous.uuid>,
                    type: notification,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payee
    deactivate TRANS_HANDLER

    alt Send notification for Payer
        activate NOTIFY_HANDLER
        TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
        alt Persist Event Information
            NOTIFY_HANDLER -> CSAPI: Requests to persist event information - POST - HTTP://events/
            CSAPI -> EVENT_DAO: Request to persist event information
            EVENT_DAO <-> DB: Persist event information
            EVENT_DAO -> CSAPI: return success
            CSAPI -> NOTIFY_HANDLER: return success
        end
        NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payer - GET - HTTP://notifications/DFPS1
        CSAPI -> NOTIFY_DAO: Fetches Notifications details for Payer
        NOTIFY_DAO <-> DB: Fetches Notifications details for Payer
        NOTIFY_DAO -> CSAPI: Returns Notifications details for Payer
        CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payer
        NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to Payer
        deactivate NOTIFY_HANDLER
    end

    alt Send notification for Payee
        activate NOTIFY_HANDLER
        TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
        alt Persist Event Information
            NOTIFY_HANDLER -> CSAPI: Requests to persist event information - POST - HTTP://events/
            CSAPI -> EVENT_DAO: Request to persist event information
            EVENT_DAO <-> DB: Persist event information
            EVENT_DAO -> CSAPI: return success
            CSAPI -> NOTIFY_HANDLER: return success
        end
        NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payee - GET - HTTP://notifications/DFPS2
        CSAPI <-> NOTIFY_DAO: Fetches Notifications details for Payee
        NOTIFY_DAO <-> DB: Fetches Notifications details for Payer
        NOTIFY_DAO -> CSAPI: Returns Notifications details for Payer
        CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payer
        NOTIFY_HANDLER -> DFSP2: HTTP Callback with Prepare result to Payer
        deactivate NOTIFY_HANDLER
    end
end
@enduml

PlantUML version 1.2017.18(Fri Oct 06 18:56:32 SAST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_152-b16
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>