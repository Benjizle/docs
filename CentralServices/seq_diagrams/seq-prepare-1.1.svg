<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2339px" preserveAspectRatio="none" style="width:3902px;height:2339px;" version="1.1" viewBox="0 0 3902 2339" width="3902px" zoomAndPan="magnify"><defs><filter height="300%" id="flrupg3k8c64u" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="385" x="1759.75" y="23.5352">1.1 DFSP1 sends a Prepare Transfer request to DFSP2</text><rect fill="#ADD8E6" height="2293.5469" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="4" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="7" y="47.0566">Financial Service Providers</text><rect fill="#90EE90" height="2293.5469" style="stroke: #A80036; stroke-width: 1.0;" width="361" x="286.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="388.5" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="2293.5469" style="stroke: #A80036; stroke-width: 1.0;" width="2898.5" x="987" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="2385.75" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="367.9688" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="263.7949" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="522" y="1952.4414"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="377.9688" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1628.5" y="515.2559"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="498.5215" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2291.5" y="893.2246"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="2070.2598" style="stroke: #000000; stroke-width: 2.0;" width="3858.5" x="33" y="154.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="67" x2="67" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="126" x2="126" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="345.5" x2="345.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="526.5" x2="526.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1058" x2="1058" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1249" x2="1249" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1633.5" x2="1633.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1962" x2="1962" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2296.5" x2="2296.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2737" x2="2737" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2943" x2="2943" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3238.5" x2="3238.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3400.5" x2="3400.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3497.5" x2="3497.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3595.5" x2="3595.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3715.5" x2="3715.5" y1="137.2871" y2="2241.5469"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3833.5" x2="3833.5" y1="137.2871" y2="2241.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="134.334">DFSP1</text><ellipse cx="67.5" cy="63.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,71.7988 L67.5,98.7988 M54.5,79.7988 L80.5,79.7988 M67.5,98.7988 L54.5,113.7988 M67.5,98.7988 L80.5,113.7988 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="43" y="2254.082">DFSP1</text><ellipse cx="67.5" cy="2267.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M67.5,2275.0352 L67.5,2302.0352 M54.5,2283.0352 L80.5,2283.0352 M67.5,2302.0352 L54.5,2317.0352 M67.5,2302.0352 L80.5,2317.0352 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="134.334">DFSP2</text><ellipse cx="126.5" cy="63.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,71.7988 L126.5,98.7988 M113.5,79.7988 L139.5,79.7988 M126.5,98.7988 L113.5,113.7988 M126.5,98.7988 L139.5,113.7988 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="102" y="2254.082">DFSP2</text><ellipse cx="126.5" cy="2267.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M126.5,2275.0352 L126.5,2302.0352 M113.5,2283.0352 L139.5,2283.0352 M126.5,2302.0352 L113.5,2317.0352 M126.5,2302.0352 L139.5,2317.0352 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="290.5" y="134.334">ML API Adapter</text><path d="M325,92.7988 L325,116.7988 M325,104.7988 L342,104.7988 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="354" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="290.5" y="2254.082">ML API Adapter</text><path d="M325,2261.0352 L325,2285.0352 M325,2273.0352 L342,2273.0352 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="354" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="410.5" y="134.334">ML API Notification Event Handler</text><ellipse cx="527" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="523,92.7988,529,87.7988,527,92.7988,529,97.7988,523,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="410.5" y="2254.082">ML API Notification Event Handler</text><ellipse cx="527" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="523,2261.0352,529,2256.0352,527,2261.0352,529,2266.0352,523,2261.0352" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="991" y="134.334">Central Service API</text><path d="M1037.5,92.7988 L1037.5,116.7988 M1037.5,104.7988 L1054.5,104.7988 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1066.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="991" y="2254.082">Central Service API</text><path d="M1037.5,2261.0352 L1037.5,2285.0352 M1037.5,2273.0352 L1054.5,2273.0352 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1066.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="1139" y="97.7988"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="1135" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="207" x="1142" y="122.334">Prepare-Topic-handler-dfsp1</text><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="1139" y="2240.5469"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="1135" y="2244.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="207" x="1142" y="2265.082">Prepare-Topic-handler-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1554.5" y="134.334">Prepare Event Handler</text><ellipse cx="1633.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1629.5,92.7988,1635.5,87.7988,1633.5,92.7988,1635.5,97.7988,1629.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1554.5" y="2254.082">Prepare Event Handler</text><ellipse cx="1633.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1629.5,2261.0352,1635.5,2256.0352,1633.5,2261.0352,1635.5,2266.0352,1629.5,2261.0352" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1851" y="97.7988"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1847" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="209" x="1854" y="122.334">Position-Topic-handler-dfsp1</text><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1851" y="2240.5469"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="223" x="1847" y="2244.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="209" x="1854" y="2265.082">Position-Topic-handler-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2216.5" y="134.334">Position Event Handler</text><ellipse cx="2296.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2292.5,92.7988,2298.5,87.7988,2296.5,92.7988,2298.5,97.7988,2292.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2216.5" y="2254.082">Position Event Handler</text><ellipse cx="2296.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2292.5,2261.0352,2298.5,2256.0352,2296.5,2261.0352,2298.5,2266.0352,2292.5,2261.0352" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2648" y="97.7988"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2644" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="2651" y="122.334">Transfer-Topic-handler</text><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2648" y="2240.5469"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="2644" y="2244.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="2651" y="2265.082">Transfer-Topic-handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="2862" y="134.334">Transfer Event Handler</text><ellipse cx="2943.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2939.5,92.7988,2945.5,87.7988,2943.5,92.7988,2945.5,97.7988,2939.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="2862" y="2254.082">Transfer Event Handler</text><ellipse cx="2943.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2939.5,2261.0352,2945.5,2256.0352,2943.5,2261.0352,2945.5,2266.0352,2939.5,2261.0352" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="3138.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="3134.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="3141.5" y="122.334">Notification-Topic-handler</text><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="3138.5" y="2240.5469"/><rect fill="#FEFECE" filter="url(#flrupg3k8c64u)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="200" x="3134.5" y="2244.5469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="3141.5" y="2265.082">Notification-Topic-handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3352.5" y="134.334">Position DAO</text><ellipse cx="3400.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3388.5" x2="3412.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3352.5" y="2254.082">Position DAO</text><ellipse cx="3400.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3388.5" x2="3412.5" y1="2287.0352" y2="2287.0352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3458.5" y="134.334">Event DAO</text><ellipse cx="3497.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3485.5" x2="3509.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="3458.5" y="2254.082">Event DAO</text><ellipse cx="3497.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3485.5" x2="3509.5" y1="2287.0352" y2="2287.0352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="3546.5" y="134.334">Transfer DAO</text><ellipse cx="3596" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3584" x2="3608" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="3546.5" y="2254.082">Transfer DAO</text><ellipse cx="3596" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3584" x2="3608" y1="2287.0352" y2="2287.0352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="3655.5" y="134.334">Notification DAO</text><ellipse cx="3715.5" cy="104.7988" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3703.5" x2="3727.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="3655.5" y="2254.082">Notification DAO</text><ellipse cx="3715.5" cy="2273.0352" fill="#FEFECE" filter="url(#flrupg3k8c64u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="3703.5" x2="3727.5" y1="2287.0352" y2="2287.0352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3785.5" y="134.334">Central Store</text><path d="M3815.5,84.7988 C3815.5,74.7988 3833.5,74.7988 3833.5,74.7988 C3833.5,74.7988 3851.5,74.7988 3851.5,84.7988 L3851.5,110.7988 C3851.5,120.7988 3833.5,120.7988 3833.5,120.7988 C3833.5,120.7988 3815.5,120.7988 3815.5,110.7988 L3815.5,84.7988 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M3815.5,84.7988 C3815.5,94.7988 3833.5,94.7988 3833.5,94.7988 C3833.5,94.7988 3851.5,94.7988 3851.5,84.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="3785.5" y="2254.082">Central Store</text><path d="M3815.5,2267.0352 C3815.5,2257.0352 3833.5,2257.0352 3833.5,2257.0352 C3833.5,2257.0352 3851.5,2257.0352 3851.5,2267.0352 L3851.5,2293.0352 C3851.5,2303.0352 3833.5,2303.0352 3833.5,2303.0352 C3833.5,2303.0352 3815.5,2303.0352 3815.5,2293.0352 L3815.5,2267.0352 " fill="#FEFECE" filter="url(#flrupg3k8c64u)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M3815.5,2267.0352 C3815.5,2277.0352 3833.5,2277.0352 3833.5,2277.0352 C3833.5,2277.0352 3851.5,2277.0352 3851.5,2267.0352 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="367.9688" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="340.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="263.7949" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="522" y="1952.4414"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="377.9688" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1628.5" y="515.2559"/><rect fill="#FFFFFF" filter="url(#flrupg3k8c64u)" height="498.5215" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2291.5" y="893.2246"/><rect fill="none" height="2070.2598" style="stroke: #000000; stroke-width: 2.0;" width="3858.5" x="33" y="154.2871"/><polygon fill="#EEEEEE" points="33,154.2871,95,154.2871,95,161.2871,85,171.2871,33,171.2871,33,154.2871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="48" y="167.8555">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="110" y="166.9219">[DFSP1 sends a Prepare Transfer request to DFSP2]</text><polygon fill="#A80036" points="328.5,188.5977,338.5,192.5977,328.5,196.5977,332.5,192.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="67.5" x2="334.5" y1="192.5977" y2="192.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="74.5" y="188.166">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="87.5" y="188.166">POST - http://transfers</text><polygon fill="#FFFF00" filter="url(#flrupg3k8c64u)" points="355,205.9082,355,383.9082,575,383.9082,575,215.9082,565,205.9082,355,205.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="565" x2="565" y1="205.9082" y2="215.9082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="575" x2="565" y1="215.9082" y2="215.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="361" y="223.4766">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="361" y="238.7871">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="377" y="254.0977">id: &lt;transferMessage.id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="377" y="269.4082">from: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="377" y="284.7188">to: http://ledger/dfsp2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="377" y="300.0293">content: &lt;transferMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="377" y="315.3398">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="393" y="330.6504">eventType: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="393" y="345.9609">eventAction: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="377" y="361.2715">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="361" y="376.582">}</text><polygon fill="#A80036" points="1237.5,410.3242,1247.5,414.3242,1237.5,418.3242,1241.5,414.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350.5" x2="1243.5" y1="414.3242" y2="414.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="357.5" y="409.8926">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="273" x="370.5" y="409.8926">Routes &amp; Publishes Prepare event for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249.5" x2="1291.5" y1="443.9453" y2="443.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1291.5" x2="1291.5" y1="443.9453" y2="456.9453"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1250.5" x2="1291.5" y1="456.9453" y2="456.9453"/><polygon fill="#A80036" points="1260.5,452.9453,1250.5,456.9453,1260.5,460.9453,1256.5,456.9453" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1256.5" y="439.2031">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1269.5" y="439.2031">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="361.5,481.9453,351.5,485.9453,361.5,489.9453,357.5,485.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355.5" x2="1248.5" y1="485.9453" y2="485.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="367.5" y="481.5137">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="380.5" y="481.5137">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="78.5,511.2559,68.5,515.2559,78.5,519.2559,74.5,515.2559" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="344.5" y1="515.2559" y2="515.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="84.5" y="510.8242">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="97.5" y="510.8242">Respond HTTP - 202 (Accepted)</text><polygon fill="#A80036" points="1616.5,540.5664,1626.5,544.5664,1616.5,548.5664,1620.5,544.5664" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1249.5" x2="1622.5" y1="544.5664" y2="544.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1256.5" y="540.1348">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1269.5" y="540.1348">Consumes Prepare event message for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1638.5" x2="1680.5" y1="574.1875" y2="574.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1680.5" x2="1680.5" y1="574.1875" y2="587.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1639.5" x2="1680.5" y1="587.1875" y2="587.1875"/><polygon fill="#A80036" points="1649.5,583.1875,1639.5,587.1875,1649.5,591.1875,1645.5,587.1875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1645.5" y="569.4453">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="1658.5" y="569.4453">Validates from - DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1638.5" x2="1680.5" y1="616.498" y2="616.498"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1680.5" x2="1680.5" y1="616.498" y2="629.498"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1639.5" x2="1680.5" y1="629.498" y2="629.498"/><polygon fill="#A80036" points="1649.5,625.498,1639.5,629.498,1649.5,633.498,1645.5,629.498" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1645.5" y="611.7559">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="1658.5" y="611.7559">Validates to - DFSP2</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1638.5" x2="1680.5" y1="658.8086" y2="658.8086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1680.5" x2="1680.5" y1="658.8086" y2="671.8086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1639.5" x2="1680.5" y1="671.8086" y2="671.8086"/><polygon fill="#A80036" points="1649.5,667.8086,1639.5,671.8086,1649.5,675.8086,1645.5,671.8086" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1645.5" y="654.0664">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="1658.5" y="654.0664">Validates message signature</text><polygon fill="#FFFF00" filter="url(#flrupg3k8c64u)" points="1643,684.8086,1643,862.8086,1863,862.8086,1863,694.8086,1853,684.8086,1643,684.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1853" x2="1853" y1="684.8086" y2="694.8086"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1863" x2="1853" y1="694.8086" y2="694.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="1649" y="702.377">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1649" y="717.6875">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="1665" y="732.998">id: &lt;transferMessage.id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="1665" y="748.3086">from: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="1665" y="763.6191">to: http://ledger/dfsp2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="1665" y="778.9297">content: &lt;transferMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1665" y="794.2402">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="1681" y="809.5508">eventType: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="1681" y="824.8613">eventAction: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1665" y="840.1719">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1649" y="855.4824">}</text><polygon fill="#A80036" points="1950.5,889.2246,1960.5,893.2246,1950.5,897.2246,1954.5,893.2246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1633.5" x2="1956.5" y1="893.2246" y2="893.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1640.5" y="888.793">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1662.5" y="888.793">Routes &amp; Publishes Position event for DFSP1</text><polygon fill="#A80036" points="2279.5,918.5352,2289.5,922.5352,2279.5,926.5352,2283.5,922.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1962.5" x2="2285.5" y1="922.5352" y2="922.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1969.5" y="918.1035">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="1991.5" y="918.1035">Consumes Position event message for DFSP1</text><polygon fill="#A80036" points="3485.5,947.8457,3495.5,951.8457,3485.5,955.8457,3489.5,951.8457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2301.5" x2="3491.5" y1="951.8457" y2="951.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2308.5" y="947.4141">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="2330.5" y="947.4141">Request to persist event information</text><polygon fill="#A80036" points="3508.5,977.1563,3498.5,981.1563,3508.5,985.1563,3504.5,981.1563" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3821.5,977.1563,3831.5,981.1563,3821.5,985.1563,3825.5,981.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3502.5" x2="3827.5" y1="981.1563" y2="981.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3514.5" y="976.7246">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="3536.5" y="976.7246">Persist event information</text><polygon fill="#A80036" points="2312.5,1006.4668,2302.5,1010.4668,2312.5,1014.4668,2308.5,1010.4668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2306.5" x2="3496.5" y1="1010.4668" y2="1010.4668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2318.5" y="1006.0352">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2340.5" y="1006.0352">return success</text><polygon fill="#A80036" points="2312.5,1035.7773,2302.5,1039.7773,2312.5,1043.7773,2308.5,1039.7773" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3821.5,1035.7773,3831.5,1039.7773,3821.5,1043.7773,3825.5,1039.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2306.5" x2="3827.5" y1="1039.7773" y2="1039.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2318.5" y="1035.3457">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="2340.5" y="1035.3457">Retrieves latest position from DB for DFSP1</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2301.5" x2="2343.5" y1="1069.3984" y2="1069.3984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2343.5" x2="2343.5" y1="1069.3984" y2="1082.3984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2302.5" x2="2343.5" y1="1082.3984" y2="1082.3984"/><polygon fill="#A80036" points="2312.5,1078.3984,2302.5,1082.3984,2312.5,1086.3984,2308.5,1082.3984" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2308.5" y="1064.6563">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="395" x="2330.5" y="1064.6563">Calculates latest position by decrementing transfer for prepare</text><polygon fill="#A80036" points="3388.5,1107.3984,3398.5,1111.3984,3388.5,1115.3984,3392.5,1111.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2301.5" x2="3394.5" y1="1111.3984" y2="1111.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2308.5" y="1106.9668">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="2330.5" y="1106.9668">Request to persist latest position for DFSP1</text><polygon fill="#A80036" points="3411.5,1136.709,3401.5,1140.709,3411.5,1144.709,3407.5,1140.709" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3821.5,1136.709,3831.5,1140.709,3821.5,1144.709,3825.5,1140.709" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3405.5" x2="3827.5" y1="1140.709" y2="1140.709"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3417.5" y="1136.2773">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="3439.5" y="1136.2773">Persists latest position to DB for DFSP1</text><polygon fill="#A80036" points="2312.5,1166.0195,2302.5,1170.0195,2312.5,1174.0195,2308.5,1170.0195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2306.5" x2="3399.5" y1="1170.0195" y2="1170.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2318.5" y="1165.5879">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2340.5" y="1165.5879">return success</text><polygon fill="#FFFF00" filter="url(#flrupg3k8c64u)" points="2306,1183.3301,2306,1361.3301,2526,1361.3301,2526,1193.3301,2516,1183.3301,2306,1183.3301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2516" x2="2516" y1="1183.3301" y2="1193.3301"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2526" x2="2516" y1="1193.3301" y2="1193.3301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2312" y="1200.8984">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2312" y="1216.209">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2328" y="1231.5195">id: &lt;transferMessage.id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="2328" y="1246.8301">from: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="2328" y="1262.1406">to: http://ledger/dfsp2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="183" x="2328" y="1277.4512">content: &lt;transferMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2328" y="1292.7617">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="2344" y="1308.0723">eventType: transfer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="2344" y="1323.3828">eventAction: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2328" y="1338.6934">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2312" y="1354.0039">}</text><polygon fill="#A80036" points="2725.5,1387.7461,2735.5,1391.7461,2725.5,1395.7461,2729.5,1391.7461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2296.5" x2="2731.5" y1="1391.7461" y2="1391.7461"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2303.5" y="1387.3145">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="2325.5" y="1387.3145">Publishes Transfer event</text><polygon fill="#A80036" points="2931.5,1417.0566,2941.5,1421.0566,2931.5,1425.0566,2935.5,1421.0566" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2737.5" x2="2937.5" y1="1421.0566" y2="1421.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2744.5" y="1416.625">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="2766.5" y="1416.625">Consumes Transfer event</text><polygon fill="#A80036" points="3584,1446.3672,3594,1450.3672,3584,1454.3672,3588,1450.3672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2943.5" x2="3590" y1="1450.3672" y2="1450.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2950.5" y="1445.9355">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="2972.5" y="1445.9355">Request to Transfer status to DB</text><polygon fill="#A80036" points="3607,1475.6777,3597,1479.6777,3607,1483.6777,3603,1479.6777" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3821.5,1475.6777,3831.5,1479.6777,3821.5,1483.6777,3825.5,1479.6777" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3601" x2="3827.5" y1="1479.6777" y2="1479.6777"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3613" y="1475.2461">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3635" y="1475.2461">return success</text><polygon fill="#A80036" points="2954.5,1504.9883,2944.5,1508.9883,2954.5,1512.9883,2950.5,1508.9883" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2948.5" x2="3595" y1="1508.9883" y2="1508.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2960.5" y="1504.5566">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="2982.5" y="1504.5566">Persists Transfer status to DB</text><polygon fill="#FFFF00" filter="url(#flrupg3k8c64u)" points="2948,1522.2988,2948,1700.2988,3228,1700.2988,3228,1532.2988,3218,1522.2988,2948,1522.2988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3218" x2="3218" y1="1522.2988" y2="1532.2988"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3228" x2="3218" y1="1532.2988" y2="1532.2988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2954" y="1539.8672">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2954" y="1555.1777">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2970" y="1570.4883">id: &lt;transferMessage.id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="2970" y="1585.7988">from: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="2970" y="1601.1094">to: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="2970" y="1616.4199">content: &lt;transferResponseMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2970" y="1631.7305">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="2986" y="1647.041">eventType: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="2986" y="1662.3516">eventAction: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2970" y="1677.6621">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2954" y="1692.9727">}</text><polygon fill="#A80036" points="3226.5,1726.7148,3236.5,1730.7148,3226.5,1734.7148,3230.5,1730.7148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2943.5" x2="3232.5" y1="1730.7148" y2="1730.7148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2950.5" y="1726.2832">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="2972.5" y="1726.2832">Publishes Notifications event for DFSP1</text><polygon fill="#FFFF00" filter="url(#flrupg3k8c64u)" points="2948,1744.0254,2948,1922.0254,3228,1922.0254,3228,1754.0254,3218,1744.0254,2948,1744.0254" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3218" x2="3218" y1="1744.0254" y2="1754.0254"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3228" x2="3218" y1="1754.0254" y2="1754.0254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2954" y="1761.5938">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2954" y="1776.9043">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2970" y="1792.2148">id: &lt;transferMessage.id&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="2970" y="1807.5254">from: http://ledger/dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="2970" y="1822.8359">to: http://ledger/dfsp2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="2970" y="1838.1465">content: &lt;transferResponseMessage&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2970" y="1853.457">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="2986" y="1868.7676">eventType: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="2986" y="1884.0781">eventAction: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2970" y="1899.3887">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2954" y="1914.6992">}</text><polygon fill="#A80036" points="3226.5,1948.4414,3236.5,1952.4414,3226.5,1956.4414,3230.5,1952.4414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2943.5" x2="3232.5" y1="1952.4414" y2="1952.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2950.5" y="1948.0098">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="2972.5" y="1948.0098">Publishes Notifications event for DFSP2</text><polygon fill="#A80036" points="543,1977.752,533,1981.752,543,1985.752,539,1981.752" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="3237.5" y1="1981.752" y2="1981.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549" y="1977.3203">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="571" y="1977.3203">Consumes Notifications event</text><polygon fill="#A80036" points="1046,2007.0625,1056,2011.0625,1046,2015.0625,1050,2011.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="1052" y1="2011.0625" y2="2011.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="539" y="2006.6309">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="480" x="561" y="2006.6309">Requests Notification details for DFSP1 - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="1069,2036.373,1059,2040.373,1069,2044.373,1065,2040.373" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3703.5,2036.373,3713.5,2040.373,3703.5,2044.373,3707.5,2040.373" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1063" x2="3709.5" y1="2040.373" y2="2040.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1075" y="2035.9414">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="1097" y="2035.9414">Fetches Notifications details for DFSP1</text><polygon fill="#A80036" points="543,2065.6836,533,2069.6836,543,2073.6836,539,2069.6836" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="1057" y1="2069.6836" y2="2069.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549" y="2065.252">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="571" y="2065.252">Returns Notifications details for DFSP1</text><polygon fill="#A80036" points="78.5,2094.9941,68.5,2098.9941,78.5,2102.9941,74.5,2098.9941" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="72.5" x2="521" y1="2098.9941" y2="2098.9941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="84.5" y="2094.5625">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="106.5" y="2094.5625">HTTP Callback with Prepare result to DFSP1</text><polygon fill="#A80036" points="1046,2124.3047,1056,2128.3047,1046,2132.3047,1050,2128.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="532" x2="1052" y1="2128.3047" y2="2128.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="539" y="2123.873">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="480" x="561" y="2123.873">Requests Notification details for DFSP2 - GET - HTTP://notifications/DFPS2</text><polygon fill="#A80036" points="1069,2153.6152,1059,2157.6152,1069,2161.6152,1065,2157.6152" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="3703.5,2153.6152,3713.5,2157.6152,3703.5,2161.6152,3707.5,2157.6152" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1063" x2="3709.5" y1="2157.6152" y2="2157.6152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1075" y="2153.1836">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="1097" y="2153.1836">Fetches Notifications details for DFSP2</text><polygon fill="#A80036" points="543,2182.9258,533,2186.9258,543,2190.9258,539,2186.9258" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="537" x2="1057" y1="2186.9258" y2="2186.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="549" y="2182.4941">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="571" y="2182.4941">Returns Notifications details for DFSP2</text><polygon fill="#A80036" points="137.5,2212.2363,127.5,2216.2363,137.5,2220.2363,133.5,2216.2363" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="131.5" x2="526" y1="2216.2363" y2="2216.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="143.5" y="2211.8047">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="165.5" y="2211.8047">HTTP Callback with Prepare result to DFSP2</text><!--
@startuml
' declate title
title 1.1 DFSP1 sends a Prepare Transfer request to DFSP2

autonumber

' Actor Keys:
'   boundary - APIs/Interfaces, etc
'   collections - Kafka Topics
'   control - Kafka Consumers
'   entity - Database Access Objects
'   database - Database Persistance Store

' declare actors
actor DFSP1
actor DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Prepare-Topic-handler-dfsp1" as TOPIC_PREPARE_DFSP1
control "Prepare Event Handler" as PREP_HANDLER
collections "Position-Topic-handler-dfsp1" as TOPIC_POSITION_DFSP1
control "Position Event Handler" as POS_HANDLER
collections "Transfer-Topic-handler" as TOPIC_TRANSFERS
control "Transfer Event Handler" as TRANS_HANDLER
collections "Notification-Topic-handler" as TOPIC_NOTIFICATIONS
entity "Position DAO" as POS_DAO
entity "Event DAO" as EVENT_DAO
entity "Transfer DAO" as TRANS_DAO
entity "Notification DAO" as NOTIFY_DAO
database "Central Store" as DB

box "Financial Service Providers" #LightBlue
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightGreen
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_PREPARE_DFSP1
    participant PREP_HANDLER
    participant TOPIC_POSITION_DFSP1
    participant POS_HANDLER
    participant TOPIC_TRANSFERS
    participant TRANS_HANDLER
    participant TOPIC_NOTIFICATIONS
    participant POS_DAO
    participant EVENT_DAO
    participant TRANS_DAO
    participant NOTIFY_DAO
    participant DB
end box

' start flow
alt DFSP1 sends a Prepare Transfer request to DFSP2
    activate MLAPI
    DFSP1 -> MLAPI: POST - http://transfers
    note right of MLAPI #yellow
        Message:
        {
            id: <transferMessage.id>
            from: http://ledger/dfsp1,
            to: http://ledger/dfsp2,
            content: <transferMessage>,
            metadata: {
                eventType: prepare,
                eventAction: prepare,
            }
        }
    end note
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for DFSP1
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI
    activate PREP_HANDLER
    TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates from - DFSP1
    PREP_HANDLER <-> PREP_HANDLER: Validates to - DFSP2
    PREP_HANDLER <-> PREP_HANDLER: Validates message signature
    note right of PREP_HANDLER #yellow
        Message:
        {
            id: <transferMessage.id>
            from: http://ledger/dfsp1,
            to: http://ledger/dfsp2,
            content: <transferMessage>,
            metadata: {
                eventType: position,
                eventAction: prepare,
            }
        }
    end note
    PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for DFSP1
    deactivate PREP_HANDLER
    activate POS_HANDLER
    TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event message for DFSP1
    POS_HANDLER -> EVENT_DAO: Request to persist event information
    EVENT_DAO <-> DB: Persist event information
    EVENT_DAO -> POS_HANDLER: return success
    POS_HANDLER <-> DB: Retrieves latest position from DB for DFSP1
    POS_HANDLER <-> POS_HANDLER: Calculates latest position by decrementing transfer for prepare
    POS_HANDLER -> POS_DAO: Request to persist latest position for DFSP1
    POS_DAO <-> DB: Persists latest position to DB for DFSP1
    POS_DAO -> POS_HANDLER: return success
    note right of POS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.id>
            from: http://ledger/dfsp1,
            to: http://ledger/dfsp2,
            content: <transferMessage>,
            metadata: {
                eventType: transfer,
                eventAction: prepare,
            }
        }
    end note
    POS_HANDLER -> TOPIC_TRANSFERS: Publishes Transfer event
    deactivate POS_HANDLER
    deactivate TRANS_HANDLER
    TOPIC_TRANSFERS -> TRANS_HANDLER: Consumes Transfer event
    TRANS_HANDLER -> TRANS_DAO: Request to Transfer status to DB
    TRANS_DAO <-> DB: return success
    TRANS_DAO -> TRANS_HANDLER: Persists Transfer status to DB
    note right of TRANS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.id>
            from: http://ledger/dfsp1,
            to: http://ledger/dfsp1,
            content: <transferResponseMessage>,
            metadata: {
                eventType: notification,
                eventAction: prepare,
            }
        }
    end note
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for DFSP1
    note right of TRANS_HANDLER #yellow
        Message:
        {
            id: <transferMessage.id>
            from: http://ledger/dfsp1,
            to: http://ledger/dfsp2,
            content: <transferResponseMessage>,
            metadata: {
                eventType: notification,
                eventAction: prepare,
            }
        }
    end note
    TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for DFSP2
    deactivate TRANS_HANDLER
    activate NOTIFY_HANDLER
    TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
    NOTIFY_HANDLER -> CSAPI: Requests Notification details for DFSP1 - GET - HTTP://notifications/DFPS1
    CSAPI <-> NOTIFY_DAO: Fetches Notifications details for DFSP1
    CSAPI -> NOTIFY_HANDLER: Returns Notifications details for DFSP1
    NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to DFSP1
    NOTIFY_HANDLER -> CSAPI: Requests Notification details for DFSP2 - GET - HTTP://notifications/DFPS2
    CSAPI <-> NOTIFY_DAO: Fetches Notifications details for DFSP2
    CSAPI -> NOTIFY_HANDLER: Returns Notifications details for DFSP2
    NOTIFY_HANDLER -> DFSP2: HTTP Callback with Prepare result to DFSP2
    deactivate NOTIFY_HANDLER
end
@enduml

PlantUML version 1.2017.18(Fri Oct 06 18:56:32 SAST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_152-b16
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>