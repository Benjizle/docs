<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="10215px" preserveAspectRatio="none" style="width:5016px;height:10215px;" version="1.1" viewBox="0 0 5016 10215" width="5016px" zoomAndPan="magnify"><defs><filter height="300%" id="fjuogvs6sjqud" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="385" x="2316.5" y="23.5352">1.1 DFSP1 sends a Prepare Transfer request to DFSP2</text><rect fill="#D3D3D3" height="10170.4609" style="stroke: #A80036; stroke-width: 1.0;" width="186" x="9" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="12" y="47.0566">Financial Service Providers</text><rect fill="#ADD8E6" height="10170.4609" style="stroke: #A80036; stroke-width: 1.0;" width="590.5" x="298.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="157" x="515.25" y="47.0566">ML API Adapter Service</text><rect fill="#FFFFE0" height="10170.4609" style="stroke: #A80036; stroke-width: 1.0;" width="3737.5" x="1231.5" y="34.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="3049.75" y="47.0566">Central Service</text><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="1138.5645" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="352.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="9072.2129" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="763.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="2731.1836" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1844.5" y="1285.8516"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="5908.0313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2764.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="8204.252" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3773.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="9947.1738" style="stroke: #000000; stroke-width: 2.0;" width="4992" x="13" y="154.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="2708.873" style="stroke: #000000; stroke-width: 2.0;" width="3625.5" x="1369.5" y="1301.1621"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1354.7832"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="586.5898" style="stroke: #000000; stroke-width: 2.0;" width="3234.5" x="1750.5" y="1474.0254"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1498.3359"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1659.8887"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1821.4414"/><rect fill="#FFFFFF" height="1521.6563" style="stroke: none; stroke-width: 1.0;" width="3625.5" x="1369.5" y="2488.3789"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2539.6445"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="189.8633" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2658.8867"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="189.8633" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2862.75"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="3066.6133"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="774.8691" style="stroke: #000000; stroke-width: 2.0;" width="733" x="1740.5" y="3228.166"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="322.7949" style="stroke: #000000; stroke-width: 2.0;" width="638" x="1750.5" y="3252.4766"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="617" x="1760.5" y="3276.7871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="618" x="1760.5" y="3350.4082"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="561" x="1760.5" y="3424.0293"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="2024.2832" style="stroke: #000000; stroke-width: 2.0;" width="2711.5" x="2283.5" y="4024.0352"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4077.6563"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4196.8984"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4316.1406"/><rect fill="#FFFFFF" height="1026.6191" style="stroke: none; stroke-width: 1.0;" width="2711.5" x="2283.5" y="5021.6992"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5072.9648"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5192.207"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="729.8691" style="stroke: #000000; stroke-width: 2.0;" width="2315.5" x="2669.5" y="5311.4492"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5335.7598"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="2282.2207" style="stroke: #000000; stroke-width: 2.0;" width="2315.5" x="2669.5" y="6062.3184"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="6115.9395"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="6235.1816"/><rect fill="#FFFFFF" height="1155.5879" style="stroke: none; stroke-width: 1.0;" width="2315.5" x="2669.5" y="7188.9512"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="7240.2168"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="7359.459"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="858.8379" style="stroke: #000000; stroke-width: 2.0;" width="471" x="3687" y="7478.7012"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="860.9609" style="stroke: #000000; stroke-width: 2.0;" width="4972" x="23" y="8358.5391"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="829.6504" style="stroke: #000000; stroke-width: 2.0;" width="4952" x="33" y="8382.8496"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="8436.4707"/><rect fill="#FFFFFF" height="429.3027" style="stroke: none; stroke-width: 1.0;" width="4952" x="33" y="8783.1973"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="8834.4629"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="193.1738" style="stroke: #000000; stroke-width: 2.0;" width="4932" x="43" y="9012.3262"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="860.9609" style="stroke: #000000; stroke-width: 2.0;" width="4972" x="23" y="9233.5"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="829.6504" style="stroke: #000000; stroke-width: 2.0;" width="4952" x="33" y="9257.8105"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="9311.4316"/><rect fill="#FFFFFF" height="429.3027" style="stroke: none; stroke-width: 1.0;" width="4952" x="33" y="9658.1582"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="9709.4238"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="193.1738" style="stroke: #000000; stroke-width: 2.0;" width="4932" x="43" y="9887.2871"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="74" x2="74" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="128" x2="128" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="357.5" x2="357.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="768" x2="768" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1302.5" x2="1302.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1463.5" x2="1463.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1849.5" x2="1849.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2378.5" x2="2378.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2769.5" x2="2769.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3386.5" x2="3386.5" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="3778" x2="3778" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4074" x2="4074" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4206" x2="4206" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4303" x2="4303" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4401" x2="4401" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4521" x2="4521" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4648" x2="4648" y1="137.2871" y2="10118.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="4917" x2="4917" y1="137.2871" y2="10118.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="53" y="134.334">Payer</text><ellipse cx="74.5" cy="63.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M74.5,71.7988 L74.5,98.7988 M61.5,79.7988 L87.5,79.7988 M74.5,98.7988 L61.5,113.7988 M74.5,98.7988 L87.5,113.7988 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="53" y="10130.9961">Payer</text><ellipse cx="74.5" cy="10143.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M74.5,10151.9492 L74.5,10178.9492 M61.5,10159.9492 L87.5,10159.9492 M74.5,10178.9492 L61.5,10193.9492 M74.5,10178.9492 L87.5,10193.9492 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="106" y="134.334">Payee</text><ellipse cx="128.5" cy="63.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M128.5,71.7988 L128.5,98.7988 M115.5,79.7988 L141.5,79.7988 M128.5,98.7988 L115.5,113.7988 M128.5,98.7988 L141.5,113.7988 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="106" y="10130.9961">Payee</text><ellipse cx="128.5" cy="10143.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M128.5,10151.9492 L128.5,10178.9492 M115.5,10159.9492 L141.5,10159.9492 M128.5,10178.9492 L115.5,10193.9492 M128.5,10178.9492 L141.5,10193.9492 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="302.5" y="134.334">ML API Adapter</text><path d="M337,92.7988 L337,116.7988 M337,104.7988 L354,104.7988 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="366" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="302.5" y="10130.9961">ML API Adapter</text><path d="M337,10137.9492 L337,10161.9492 M337,10149.9492 L354,10149.9492 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="366" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="652" y="134.334">ML API Notification Event Handler</text><ellipse cx="768.5" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="764.5,92.7988,770.5,87.7988,768.5,92.7988,770.5,97.7988,764.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="652" y="10130.9961">ML API Notification Event Handler</text><ellipse cx="768.5" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="764.5,10137.9492,770.5,10132.9492,768.5,10137.9492,770.5,10142.9492,764.5,10137.9492" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1235.5" y="134.334">Central Service API</text><path d="M1282,92.7988 L1282,116.7988 M1282,104.7988 L1299,104.7988 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1311" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="1235.5" y="10130.9961">Central Service API</text><path d="M1282,10137.9492 L1282,10161.9492 M1282,10149.9492 L1299,10149.9492 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="1311" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1383.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1379.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="1386.5" y="122.334">Prepare-Topic-dfsp1</text><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1383.5" y="10117.4609"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="160" x="1379.5" y="10121.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="1386.5" y="10141.9961">Prepare-Topic-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1770.5" y="134.334">Prepare Event Handler</text><ellipse cx="1849.5" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1845.5,92.7988,1851.5,87.7988,1849.5,92.7988,1851.5,97.7988,1845.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="152" x="1770.5" y="10130.9961">Prepare Event Handler</text><ellipse cx="1849.5" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="1845.5,10137.9492,1851.5,10132.9492,1849.5,10137.9492,1851.5,10142.9492,1845.5,10137.9492" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2297.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2293.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="148" x="2300.5" y="122.334">Position-Topic-dfsp1</text><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2297.5" y="10117.4609"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="2293.5" y="10121.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="148" x="2300.5" y="10141.9961">Position-Topic-dfsp1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2689.5" y="134.334">Position Event Handler</text><ellipse cx="2769.5" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2765.5,92.7988,2771.5,87.7988,2769.5,92.7988,2771.5,97.7988,2765.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="154" x="2689.5" y="10130.9961">Position Event Handler</text><ellipse cx="2769.5" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2765.5,10137.9492,2771.5,10132.9492,2769.5,10137.9492,2771.5,10142.9492,2765.5,10137.9492" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3327.5" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3323.5" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="3330.5" y="122.334">Transfer-Topic</text><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3327.5" y="10117.4609"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="118" x="3323.5" y="10121.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="3330.5" y="10141.9961">Transfer-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="3697" y="134.334">Transfer Event Handler</text><ellipse cx="3778.5" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="3774.5,92.7988,3780.5,87.7988,3778.5,92.7988,3780.5,97.7988,3774.5,92.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="157" x="3697" y="10130.9961">Transfer Event Handler</text><ellipse cx="3778.5" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="3774.5,10137.9492,3780.5,10132.9492,3778.5,10137.9492,3780.5,10142.9492,3774.5,10137.9492" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="4005" y="97.7988"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="4001" y="101.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="4008" y="122.334">Notification-Topic</text><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="4005" y="10117.4609"/><rect fill="#FEFECE" filter="url(#fjuogvs6sjqud)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="139" x="4001" y="10121.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="125" x="4008" y="10141.9961">Notification-Topic</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4158" y="134.334">Position DAO</text><ellipse cx="4206" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4194" x2="4218" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4158" y="10130.9961">Position DAO</text><ellipse cx="4206" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4194" x2="4218" y1="10163.9492" y2="10163.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="4264" y="134.334">Event DAO</text><ellipse cx="4303" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4291" x2="4315" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="4264" y="10130.9961">Event DAO</text><ellipse cx="4303" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4291" x2="4315" y1="10163.9492" y2="10163.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="4352" y="134.334">Transfer DAO</text><ellipse cx="4401.5" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4389.5" x2="4413.5" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="93" x="4352" y="10130.9961">Transfer DAO</text><ellipse cx="4401.5" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4389.5" x2="4413.5" y1="10163.9492" y2="10163.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="4461" y="134.334">Notification DAO</text><ellipse cx="4521" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4509" x2="4533" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="4461" y="10130.9961">Notification DAO</text><ellipse cx="4521" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4509" x2="4533" y1="10163.9492" y2="10163.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="4591" y="134.334">Participant DAO</text><ellipse cx="4648" cy="104.7988" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4636" x2="4660" y1="118.7988" y2="118.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="4591" y="10130.9961">Participant DAO</text><ellipse cx="4648" cy="10149.9492" fill="#FEFECE" filter="url(#fjuogvs6sjqud)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="4636" x2="4660" y1="10163.9492" y2="10163.9492"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4869" y="134.334">Central Store</text><path d="M4899,84.7988 C4899,74.7988 4917,74.7988 4917,74.7988 C4917,74.7988 4935,74.7988 4935,84.7988 L4935,110.7988 C4935,120.7988 4917,120.7988 4917,120.7988 C4917,120.7988 4899,120.7988 4899,110.7988 L4899,84.7988 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M4899,84.7988 C4899,94.7988 4917,94.7988 4917,94.7988 C4917,94.7988 4935,94.7988 4935,84.7988 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="4869" y="10130.9961">Central Store</text><path d="M4899,10143.9492 C4899,10133.9492 4917,10133.9492 4917,10133.9492 C4917,10133.9492 4935,10133.9492 4935,10143.9492 L4935,10169.9492 C4935,10179.9492 4917,10179.9492 4917,10179.9492 C4917,10179.9492 4899,10179.9492 4899,10169.9492 L4899,10143.9492 " fill="#FEFECE" filter="url(#fjuogvs6sjqud)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M4899,10143.9492 C4899,10153.9492 4917,10153.9492 4917,10153.9492 C4917,10153.9492 4935,10153.9492 4935,10143.9492 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="1138.5645" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="352.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="9072.2129" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="763.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="2731.1836" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1844.5" y="1285.8516"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="5908.0313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2764.5" y="147.2871"/><rect fill="#FFFFFF" filter="url(#fjuogvs6sjqud)" height="8204.252" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="3773.5" y="147.2871"/><rect fill="none" height="9947.1738" style="stroke: #000000; stroke-width: 2.0;" width="4992" x="13" y="154.2871"/><polygon fill="#EEEEEE" points="13,154.2871,391,154.2871,391,161.2871,381,171.2871,13,171.2871,13,154.2871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="333" x="28" y="167.8555">DFSP1 sends a Prepare Transfer request to Payee</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="79,176.5977,79,706.5977,420,706.5977,420,186.5977,410,176.5977,79,176.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="410" x2="410" y1="176.5977" y2="186.5977"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="420" x2="410" y1="186.5977" y2="186.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="85" y="194.166">Headers - transferHeaders: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="101" y="209.4766">Content-Length: &lt;Content-Length&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="101" y="224.7871">Content-Type: &lt;Content-Type&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="101" y="240.0977">Date: &lt;Date&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="101" y="255.4082">X-Forwarded-For: &lt;X-Forwarded-For&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="216" x="101" y="270.7188">FSPIOP-Source: &lt;FSPIOP-Source&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="101" y="286.0293">FSPIOP-Destination: &lt;FSPIOP-Destination&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="101" y="301.3398">FSPIOP-Encryption: &lt;FSPIOP-Encryption&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="101" y="316.6504">FSPIOP-Signature: &lt;FSPIOP-Signature&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="101" y="331.9609">FSPIOP-URI: &lt;FSPIOP-URI&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="101" y="347.2715">FSPIOP-HTTP-Method: &lt;FSPIOP-HTTP-Method&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="85" y="362.582">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="89" y="377.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="85" y="393.2031">Payload - transferMessage:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="85" y="408.5137">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="101" y="423.8242">"transferId": &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="101" y="439.1348">"payeeFsp": dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="101" y="454.4453">"payerFsp": dfsp1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="101" y="469.7559">"amount": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="117" y="485.0664">"currency": "AED",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="117" y="500.377">"amount": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="101" y="515.6875">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="101" y="530.998">"ilpPacket": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="101" y="546.3086">"condition": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="101" y="561.6191">"expiration": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="101" y="576.9297">"extensionList": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="117" y="592.2402">"extension": [</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="133" y="607.5508">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="149" y="622.8613">"key": "string",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="149" y="638.1719">"value": "string"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="133" y="653.4824">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="117" y="668.793">]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="101" y="684.1035">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="85" y="699.4141">}</text><polygon fill="#A80036" points="340.5,733.1563,350.5,737.1563,340.5,741.1563,344.5,737.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74.5" x2="346.5" y1="737.1563" y2="737.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="81.5" y="732.7246">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="94.5" y="732.7246">POST - http://transfers</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="404.5" y1="766.7773" y2="766.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="404.5" x2="404.5" y1="766.7773" y2="779.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="363.5" x2="404.5" y1="779.7773" y2="779.7773"/><polygon fill="#A80036" points="373.5,775.7773,363.5,779.7773,373.5,783.7773,369.5,779.7773" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="762.0352">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="382.5" y="762.0352">validates incoming token, and the originator matches Payer</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="367,792.7773,367,1154.7773,629,1154.7773,629,802.7773,619,792.7773,367,792.7773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="619" x2="619" y1="792.7773" y2="802.7773"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="629" x2="619" y1="802.7773" y2="802.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="373" y="810.3457">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="373" y="825.6563">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="389" y="840.9668">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="389" y="856.2773">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="389" y="871.5879">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="389" y="886.8984">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="389" y="902.209">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="405" y="917.5195">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="405" y="932.8301">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="389" y="948.1406">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="389" y="963.4512">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="405" y="978.7617">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="421" y="994.0723">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="421" y="1009.3828">type: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="421" y="1024.6934">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="421" y="1040.0039">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="421" y="1055.3145">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="437" y="1070.625">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="437" y="1085.9355">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="421" y="1101.2461">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="405" y="1116.5566">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="389" y="1131.8672">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="373" y="1147.1777">}</text><polygon fill="#A80036" points="1451.5,1180.9199,1461.5,1184.9199,1451.5,1188.9199,1455.5,1184.9199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="362.5" x2="1457.5" y1="1184.9199" y2="1184.9199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="369.5" y="1180.4883">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="382.5" y="1180.4883">Routes &amp; Publishes Prepare event for Payer</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1463.5" x2="1505.5" y1="1214.541" y2="1214.541"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1505.5" x2="1505.5" y1="1214.541" y2="1227.541"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1464.5" x2="1505.5" y1="1227.541" y2="1227.541"/><polygon fill="#A80036" points="1474.5,1223.541,1464.5,1227.541,1474.5,1231.541,1470.5,1227.541" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1470.5" y="1209.7988">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="1483.5" y="1209.7988">Ensures that event is replicated as configured (ACKS=all)</text><polygon fill="#A80036" points="373.5,1252.541,363.5,1256.541,373.5,1260.541,369.5,1256.541" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="367.5" x2="1462.5" y1="1256.541" y2="1256.541"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="379.5" y="1252.1094">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="370" x="392.5" y="1252.1094">Responds replication acknoledgements have been received</text><polygon fill="#A80036" points="85.5,1281.8516,75.5,1285.8516,85.5,1289.8516,81.5,1285.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="356.5" y1="1285.8516" y2="1285.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="91.5" y="1281.4199">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="104.5" y="1281.4199">Respond HTTP - 202 (Accepted)</text><rect fill="none" height="2708.873" style="stroke: #000000; stroke-width: 2.0;" width="3625.5" x="1369.5" y="1301.1621"/><polygon fill="#EEEEEE" points="1369.5,1301.1621,1431.5,1301.1621,1431.5,1308.1621,1421.5,1318.1621,1369.5,1318.1621,1369.5,1301.1621" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="1384.5" y="1314.7305">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="241" x="1446.5" y="1313.7969">[Prepare Handler consume Single Message]</text><polygon fill="#A80036" points="1832.5,1335.4727,1842.5,1339.4727,1832.5,1343.4727,1836.5,1339.4727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1463.5" x2="1838.5" y1="1339.4727" y2="1339.4727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1470.5" y="1335.041">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="1483.5" y="1335.041">Consumes Prepare event message for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1354.7832"/><polygon fill="#EEEEEE" points="1760.5,1354.7832,1975.5,1354.7832,1975.5,1361.7832,1965.5,1371.7832,1760.5,1371.7832,1760.5,1354.7832" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="1775.5" y="1368.3516">Persist Event Information</text><polygon fill="#A80036" points="4291,1389.0938,4301,1393.0938,4291,1397.0938,4295,1393.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4297" y1="1393.0938" y2="1393.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1861.5" y="1388.6621">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1874.5" y="1388.6621">Request to persist event information</text><polygon fill="#A80036" points="4314,1418.4043,4304,1422.4043,4314,1426.4043,4310,1422.4043" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,1418.4043,4915,1422.4043,4905,1426.4043,4909,1422.4043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="1422.4043" y2="1422.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="4320" y="1417.9727">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4333" y="1417.9727">Persist event information</text><polygon fill="#A80036" points="1865.5,1447.7148,1855.5,1451.7148,1865.5,1455.7148,1861.5,1451.7148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4302" y1="1451.7148" y2="1451.7148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="1447.2832">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1893.5" y="1447.2832">return success</text><rect fill="none" height="586.5898" style="stroke: #000000; stroke-width: 2.0;" width="3234.5" x="1750.5" y="1474.0254"/><polygon fill="#EEEEEE" points="1750.5,1474.0254,1969.5,1474.0254,1969.5,1481.0254,1959.5,1491.0254,1750.5,1491.0254,1750.5,1474.0254" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="1765.5" y="1487.5938">Validate Prepare Transfer</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1498.3359"/><polygon fill="#EEEEEE" points="1760.5,1498.3359,1902.5,1498.3359,1902.5,1505.3359,1892.5,1515.3359,1760.5,1515.3359,1760.5,1498.3359" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="1775.5" y="1511.9043">Validate Payer</text><polygon fill="#A80036" points="4636,1532.6465,4646,1536.6465,4636,1540.6465,4640,1536.6465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4642" y1="1536.6465" y2="1536.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1532.2148">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="348" x="1883.5" y="1532.2148">Request to retrieve Payer Participant details (if it exists)</text><polygon fill="#A80036" points="4659,1561.957,4649,1565.957,4659,1569.957,4655,1565.957" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,1561.957,4915,1565.957,4905,1569.957,4909,1565.957" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4653" x2="4911" y1="1565.957" y2="1565.957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4665" y="1561.5254">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4687" y="1561.5254">return Participant details if it exists</text><polygon fill="#A80036" points="1865.5,1591.2676,1855.5,1595.2676,1865.5,1599.2676,1861.5,1595.2676" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4647" y1="1595.2676" y2="1595.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="1590.8359">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1893.5" y="1590.8359">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="1624.8887" y2="1624.8887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="1624.8887" y2="1637.8887"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="1637.8887" y2="1637.8887"/><polygon fill="#A80036" points="1865.5,1633.8887,1855.5,1637.8887,1865.5,1641.8887,1861.5,1637.8887" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1620.1465">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1883.5" y="1620.1465">Validates Payer</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1659.8887"/><polygon fill="#EEEEEE" points="1760.5,1659.8887,1904.5,1659.8887,1904.5,1666.8887,1894.5,1676.8887,1760.5,1676.8887,1760.5,1659.8887" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="1775.5" y="1673.457">Validate Payee</text><polygon fill="#A80036" points="4636,1694.1992,4646,1698.1992,4636,1702.1992,4640,1698.1992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4642" y1="1698.1992" y2="1698.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1693.7676">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="350" x="1883.5" y="1693.7676">Request to retrieve Payee Participant details (if it exists)</text><polygon fill="#A80036" points="4659,1723.5098,4649,1727.5098,4659,1731.5098,4655,1727.5098" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,1723.5098,4915,1727.5098,4905,1731.5098,4909,1727.5098" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4653" x2="4911" y1="1727.5098" y2="1727.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4665" y="1723.0781">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4687" y="1723.0781">return Participant details if it exists</text><polygon fill="#A80036" points="1865.5,1752.8203,1855.5,1756.8203,1865.5,1760.8203,1861.5,1756.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4647" y1="1756.8203" y2="1756.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="1752.3887">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1893.5" y="1752.3887">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="1786.4414" y2="1786.4414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="1786.4414" y2="1799.4414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="1799.4414" y2="1799.4414"/><polygon fill="#A80036" points="1865.5,1795.4414,1855.5,1799.4414,1865.5,1803.4414,1861.5,1799.4414" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1781.6992">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="1883.5" y="1781.6992">Validates Payee</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="1821.4414"/><polygon fill="#EEEEEE" points="1760.5,1821.4414,1912.5,1821.4414,1912.5,1828.4414,1902.5,1838.4414,1760.5,1838.4414,1760.5,1821.4414" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="1775.5" y="1835.0098">Duplicate check</text><polygon fill="#A80036" points="4389.5,1855.752,4399.5,1859.752,4389.5,1863.752,4393.5,1859.752" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4395.5" y1="1859.752" y2="1859.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1855.3203">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="250" x="1883.5" y="1855.3203">Request to retrieve Transfer (if it exists)</text><polygon fill="#A80036" points="4412.5,1885.0625,4402.5,1889.0625,4412.5,1893.0625,4408.5,1889.0625" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,1885.0625,4915,1889.0625,4905,1893.0625,4909,1889.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="1889.0625" y2="1889.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="1884.6309">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="4440.5" y="1884.6309">return Transfer if it exists</text><polygon fill="#A80036" points="1865.5,1914.373,1855.5,1918.373,1865.5,1922.373,1861.5,1918.373" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4400.5" y1="1918.373" y2="1918.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="1913.9414">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1893.5" y="1913.9414">return Transfer if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="1947.9941" y2="1947.9941"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="1947.9941" y2="1960.9941"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="1960.9941" y2="1960.9941"/><polygon fill="#A80036" points="1865.5,1956.9941,1855.5,1960.9941,1865.5,1964.9941,1861.5,1960.9941" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1943.252">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="1883.5" y="1943.252">Validates duplicate Check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="1997.3047" y2="1997.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="1997.3047" y2="2010.3047"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="2010.3047" y2="2010.3047"/><polygon fill="#A80036" points="1865.5,2006.3047,1855.5,2010.3047,1865.5,2014.3047,1861.5,2010.3047" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="1992.5625">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1883.5" y="1992.5625">Validates crypto-condition</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="2039.6152" y2="2039.6152"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="2039.6152" y2="2052.6152"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="2052.6152" y2="2052.6152"/><polygon fill="#A80036" points="1865.5,2048.6152,1855.5,2052.6152,1865.5,2056.6152,1861.5,2052.6152" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2034.873">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="1883.5" y="2034.873">Validates message signature (to be confirmed in future requirement)</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="1859,2072.6152,1859,2449.6152,2121,2449.6152,2121,2082.6152,2111,2072.6152,1859,2072.6152" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2111" x2="2111" y1="2072.6152" y2="2082.6152"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2121" x2="2111" y1="2082.6152" y2="2082.6152"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="1865" y="2090.1836">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1865" y="2105.4941">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="1881" y="2120.8047">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="1881" y="2136.1152">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1881" y="2151.4258">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1881" y="2166.7363">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="1881" y="2182.0469">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="1897" y="2197.3574">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="1897" y="2212.668">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1881" y="2227.9785">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1881" y="2243.2891">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1897" y="2258.5996">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1913" y="2273.9102">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1913" y="2289.2207">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="1913" y="2304.5313">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="1913" y="2319.8418">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="1913" y="2335.1523">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1913" y="2350.4629">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1929" y="2365.7734">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1929" y="2381.084">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1913" y="2396.3945">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1897" y="2411.7051">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1881" y="2427.0156">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1865" y="2442.3262">}</text><polygon fill="#A80036" points="2366.5,2476.0684,2376.5,2480.0684,2366.5,2484.0684,2370.5,2480.0684" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="2372.5" y1="2480.0684" y2="2480.0684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2475.6367">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="1883.5" y="2475.6367">Routes &amp; Publishes Position event for Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1369.5" x2="4995" y1="2489.3789" y2="2489.3789"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="243" x="1374.5" y="2500.0137">[Prepare Handler consume batch Messages]</text><polygon fill="#A80036" points="1832.5,2520.334,1842.5,2524.334,1832.5,2528.334,1836.5,2524.334" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1463.5" x2="1838.5" y1="2524.334" y2="2524.334"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1470.5" y="2519.9023">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="335" x="1492.5" y="2519.9023">Consumes Prepare event batch of messages for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2539.6445"/><polygon fill="#EEEEEE" points="1760.5,2539.6445,2017.5,2539.6445,2017.5,2546.6445,2007.5,2556.6445,1760.5,2556.6445,1760.5,2539.6445" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="1775.5" y="2553.2129">Persist batch Event Information</text><polygon fill="#A80036" points="4291,2573.9551,4301,2577.9551,4291,2581.9551,4295,2577.9551" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4297" y1="2577.9551" y2="2577.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2573.5234">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="1883.5" y="2573.5234">Request to persist event information for batch of messages</text><polygon fill="#A80036" points="4314,2603.2656,4304,2607.2656,4314,2611.2656,4310,2607.2656" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,2603.2656,4915,2607.2656,4905,2611.2656,4909,2607.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="2607.2656" y2="2607.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4320" y="2602.834">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="4342" y="2602.834">Persist event batch information</text><polygon fill="#A80036" points="1865.5,2632.5762,1855.5,2636.5762,1865.5,2640.5762,1861.5,2636.5762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4302" y1="2636.5762" y2="2636.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="2632.1445">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1893.5" y="2632.1445">return success</text><rect fill="none" height="189.8633" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2658.8867"/><polygon fill="#EEEEEE" points="1760.5,2658.8867,2008.5,2658.8867,2008.5,2665.8867,1998.5,2675.8867,1760.5,2675.8867,1760.5,2658.8867" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="1775.5" y="2672.4551">Fetch batch Payer information</text><polygon fill="#A80036" points="4636,2693.1973,4646,2697.1973,4636,2701.1973,4640,2697.1973" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4642" y1="2697.1973" y2="2697.1973"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2692.7656">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="404" x="1883.5" y="2692.7656">Request to retrieve batch of Payer Participant details (if it exists)</text><polygon fill="#A80036" points="4659,2722.5078,4649,2726.5078,4659,2730.5078,4655,2726.5078" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,2722.5078,4915,2726.5078,4905,2730.5078,4909,2726.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4653" x2="4911" y1="2726.5078" y2="2726.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4665" y="2722.0762">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4687" y="2722.0762">return Participant details if it exists</text><polygon fill="#A80036" points="1865.5,2751.8184,1855.5,2755.8184,1865.5,2759.8184,1861.5,2755.8184" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4647" y1="2755.8184" y2="2755.8184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="2751.3867">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1893.5" y="2751.3867">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="2785.4395" y2="2785.4395"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="2785.4395" y2="2798.4395"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="2798.4395" y2="2798.4395"/><polygon fill="#A80036" points="1865.5,2794.4395,1855.5,2798.4395,1865.5,2802.4395,1861.5,2798.4395" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2780.6973">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="1883.5" y="2780.6973">Validates Payer</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="2827.75" y2="2827.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="2827.75" y2="2840.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="2840.75" y2="2840.75"/><polygon fill="#A80036" points="1865.5,2836.75,1855.5,2840.75,1865.5,2844.75,1861.5,2840.75" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2823.0078">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="378" x="1883.5" y="2823.0078">store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYER</text><rect fill="none" height="189.8633" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="2862.75"/><polygon fill="#EEEEEE" points="1760.5,2862.75,2010.5,2862.75,2010.5,2869.75,2000.5,2879.75,1760.5,2879.75,1760.5,2862.75" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205" x="1775.5" y="2876.3184">Fetch batch Payee information</text><polygon fill="#A80036" points="4636,2897.0605,4646,2901.0605,4636,2905.0605,4640,2901.0605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4642" y1="2901.0605" y2="2901.0605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2896.6289">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="406" x="1883.5" y="2896.6289">Request to retrieve batch of Payee Participant details (if it exists)</text><polygon fill="#A80036" points="4659,2926.3711,4649,2930.3711,4659,2934.3711,4655,2930.3711" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,2926.3711,4915,2930.3711,4905,2934.3711,4909,2930.3711" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4653" x2="4911" y1="2930.3711" y2="2930.3711"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4665" y="2925.9395">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="4687" y="2925.9395">return Participant details if it exists</text><polygon fill="#A80036" points="1865.5,2955.6816,1855.5,2959.6816,1865.5,2963.6816,1861.5,2959.6816" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4647" y1="2959.6816" y2="2959.6816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="2955.25">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1893.5" y="2955.25">return Participant details if it exists</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="2989.3027" y2="2989.3027"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="2989.3027" y2="3002.3027"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3002.3027" y2="3002.3027"/><polygon fill="#A80036" points="1865.5,2998.3027,1855.5,3002.3027,1865.5,3006.3027,1861.5,3002.3027" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="2984.5605">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="1883.5" y="2984.5605">Validates Payee</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3031.6133" y2="3031.6133"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3031.6133" y2="3044.6133"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3044.6133" y2="3044.6133"/><polygon fill="#A80036" points="1865.5,3040.6133,1855.5,3044.6133,1865.5,3048.6133,1861.5,3044.6133" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3026.8711">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="377" x="1883.5" y="3026.8711">store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYEE</text><rect fill="none" height="147.5527" style="stroke: #000000; stroke-width: 2.0;" width="3214.5" x="1760.5" y="3066.6133"/><polygon fill="#EEEEEE" points="1760.5,3066.6133,1965.5,3066.6133,1965.5,3073.6133,1955.5,3083.6133,1760.5,3083.6133,1760.5,3066.6133" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="160" x="1775.5" y="3080.1816">Fetch batch of transfers</text><polygon fill="#A80036" points="4389.5,3100.9238,4399.5,3104.9238,4389.5,3108.9238,4393.5,3104.9238" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="4395.5" y1="3104.9238" y2="3104.9238"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3100.4922">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="313" x="1883.5" y="3100.4922">Request to retrieve batch of Transfers (if it exists)</text><polygon fill="#A80036" points="4412.5,3130.2344,4402.5,3134.2344,4412.5,3138.2344,4408.5,3134.2344" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,3130.2344,4915,3134.2344,4905,3138.2344,4909,3134.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="3134.2344" y2="3134.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="3129.8027">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="4440.5" y="3129.8027">return batch of Transfers (if it exists)</text><polygon fill="#A80036" points="1865.5,3159.5449,1855.5,3163.5449,1865.5,3167.5449,1861.5,3163.5449" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1859.5" x2="4400.5" y1="3163.5449" y2="3163.5449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1871.5" y="3159.1133">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="1893.5" y="3159.1133">return batch of Transfer (if it exists)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3193.166" y2="3193.166"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3193.166" y2="3206.166"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3206.166" y2="3206.166"/><polygon fill="#A80036" points="1865.5,3202.166,1855.5,3206.166,1865.5,3210.166,1861.5,3206.166" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3188.4238">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="1883.5" y="3188.4238">store result set in var: $LIST_TRANSFERS</text><rect fill="none" height="774.8691" style="stroke: #000000; stroke-width: 2.0;" width="733" x="1740.5" y="3228.166"/><polygon fill="#EEEEEE" points="1740.5,3228.166,1814.5,3228.166,1814.5,3235.166,1804.5,3245.166,1740.5,3245.166,1740.5,3228.166" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="1755.5" y="3241.7344">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="1829.5" y="3240.8008">[for each message in batch]</text><rect fill="none" height="322.7949" style="stroke: #000000; stroke-width: 2.0;" width="638" x="1750.5" y="3252.4766"/><polygon fill="#EEEEEE" points="1750.5,3252.4766,1969.5,3252.4766,1969.5,3259.4766,1959.5,3269.4766,1750.5,3269.4766,1750.5,3252.4766" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="1765.5" y="3266.0449">Validate Prepare Transfer</text><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="617" x="1760.5" y="3276.7871"/><polygon fill="#EEEEEE" points="1760.5,3276.7871,1902.5,3276.7871,1902.5,3283.7871,1892.5,3293.7871,1760.5,3293.7871,1760.5,3276.7871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="1775.5" y="3290.3555">Validate Payer</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3315.4082" y2="3315.4082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3315.4082" y2="3328.4082"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3328.4082" y2="3328.4082"/><polygon fill="#A80036" points="1865.5,3324.4082,1855.5,3328.4082,1865.5,3332.4082,1861.5,3328.4082" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3310.666">44</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="482" x="1883.5" y="3310.666">Validates Payer against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYER</text><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="618" x="1760.5" y="3350.4082"/><polygon fill="#EEEEEE" points="1760.5,3350.4082,1904.5,3350.4082,1904.5,3357.4082,1894.5,3367.4082,1760.5,3367.4082,1760.5,3350.4082" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="99" x="1775.5" y="3363.9766">Validate Payee</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3389.0293" y2="3389.0293"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3389.0293" y2="3402.0293"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3402.0293" y2="3402.0293"/><polygon fill="#A80036" points="1865.5,3398.0293,1855.5,3402.0293,1865.5,3406.0293,1861.5,3402.0293" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3384.2871">45</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="483" x="1883.5" y="3384.2871">Validates Payee against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYEE</text><rect fill="none" height="59.6211" style="stroke: #000000; stroke-width: 2.0;" width="561" x="1760.5" y="3424.0293"/><polygon fill="#EEEEEE" points="1760.5,3424.0293,1912.5,3424.0293,1912.5,3431.0293,1902.5,3441.0293,1760.5,3441.0293,1760.5,3424.0293" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="1775.5" y="3437.5977">Duplicate check</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3462.6504" y2="3462.6504"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3462.6504" y2="3475.6504"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3475.6504" y2="3475.6504"/><polygon fill="#A80036" points="1865.5,3471.6504,1855.5,3475.6504,1865.5,3479.6504,1861.5,3475.6504" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3457.9082">46</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="426" x="1883.5" y="3457.9082">Validates duplicate Check against in-memory var $LIST_TRANSFERS</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3511.9609" y2="3511.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3511.9609" y2="3524.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3524.9609" y2="3524.9609"/><polygon fill="#A80036" points="1865.5,3520.9609,1855.5,3524.9609,1865.5,3528.9609,1861.5,3524.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3507.2188">47</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="1883.5" y="3507.2188">Validates crypto-condition</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="1896.5" y1="3554.2715" y2="3554.2715"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1896.5" x2="1896.5" y1="3554.2715" y2="3567.2715"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1855.5" x2="1896.5" y1="3567.2715" y2="3567.2715"/><polygon fill="#A80036" points="1865.5,3563.2715,1855.5,3567.2715,1865.5,3571.2715,1861.5,3567.2715" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3549.5293">48</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="429" x="1883.5" y="3549.5293">Validates message signature (to be confirmed in future requirement)</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="1859,3587.2715,1859,3964.2715,2121,3964.2715,2121,3597.2715,2111,3587.2715,1859,3587.2715" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2111" x2="2111" y1="3587.2715" y2="3597.2715"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2121" x2="2111" y1="3597.2715" y2="3597.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="1865" y="3604.8398">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1865" y="3620.1504">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="1881" y="3635.4609">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="1881" y="3650.7715">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="1881" y="3666.082">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="1881" y="3681.3926">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="1881" y="3696.7031">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="1897" y="3712.0137">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="1897" y="3727.3242">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1881" y="3742.6348">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="1881" y="3757.9453">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1897" y="3773.2559">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="1913" y="3788.5664">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1913" y="3803.877">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="1913" y="3819.1875">type: position,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="1913" y="3834.498">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="1913" y="3849.8086">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1913" y="3865.1191">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="1929" y="3880.4297">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1929" y="3895.7402">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1913" y="3911.0508">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1897" y="3926.3613">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1881" y="3941.6719">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1865" y="3956.9824">}</text><polygon fill="#A80036" points="2366.5,3990.7246,2376.5,3994.7246,2366.5,3998.7246,2370.5,3994.7246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1854.5" x2="2372.5" y1="3994.7246" y2="3994.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="1861.5" y="3990.293">49</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="1883.5" y="3990.293">Routes &amp; Publishes Position event for Payer</text><rect fill="none" height="2024.2832" style="stroke: #000000; stroke-width: 2.0;" width="2711.5" x="2283.5" y="4024.0352"/><polygon fill="#EEEEEE" points="2283.5,4024.0352,2345.5,4024.0352,2345.5,4031.0352,2335.5,4041.0352,2283.5,4041.0352,2283.5,4024.0352" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="2298.5" y="4037.6035">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="245" x="2360.5" y="4036.6699">[Position Handler consume Single Message]</text><polygon fill="#A80036" points="2752.5,4058.3457,2762.5,4062.3457,2752.5,4066.3457,2756.5,4062.3457" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2378.5" x2="2758.5" y1="4062.3457" y2="4062.3457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2385.5" y="4057.9141">50</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="2407.5" y="4057.9141">Consumes Position event message for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4077.6563"/><polygon fill="#EEEEEE" points="2679.5,4077.6563,2894.5,4077.6563,2894.5,4084.6563,2884.5,4094.6563,2679.5,4094.6563,2679.5,4077.6563" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="2694.5" y="4091.2246">Persist Event Information</text><polygon fill="#A80036" points="4291,4111.9668,4301,4115.9668,4291,4119.9668,4295,4115.9668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4297" y1="4115.9668" y2="4115.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4111.5352">51</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="2803.5" y="4111.5352">Request to persist event information</text><polygon fill="#A80036" points="4314,4141.2773,4304,4145.2773,4314,4149.2773,4310,4145.2773" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,4141.2773,4915,4145.2773,4905,4149.2773,4909,4145.2773" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="4145.2773" y2="4145.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4320" y="4140.8457">52</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4342" y="4140.8457">Persist event information</text><polygon fill="#A80036" points="2785.5,4170.5879,2775.5,4174.5879,2785.5,4178.5879,2781.5,4174.5879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4302" y1="4174.5879" y2="4174.5879"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="4170.1563">53</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="4170.1563">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4196.8984"/><polygon fill="#EEEEEE" points="2679.5,4196.8984,3122.5,4196.8984,3122.5,4203.8984,3112.5,4213.8984,2679.5,4213.8984,2679.5,4196.8984" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="398" x="2694.5" y="4210.4668">Persist Prepare Transfer State with transferState='pending'</text><polygon fill="#A80036" points="4389.5,4231.209,4399.5,4235.209,4389.5,4239.209,4393.5,4235.209" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4395.5" y1="4235.209" y2="4235.209"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4230.7773">54</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="2803.5" y="4230.7773">Request to persist transfer</text><polygon fill="#A80036" points="4412.5,4260.5195,4402.5,4264.5195,4412.5,4268.5195,4408.5,4264.5195" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,4260.5195,4915,4264.5195,4905,4268.5195,4909,4264.5195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="4264.5195" y2="4264.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="4260.0879">55</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="4440.5" y="4260.0879">Persist transfer</text><polygon fill="#A80036" points="2785.5,4289.8301,2775.5,4293.8301,2785.5,4297.8301,2781.5,4293.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4400.5" y1="4293.8301" y2="4293.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="4289.3984">56</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="4289.3984">return success</text><rect fill="none" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="4316.1406"/><polygon fill="#EEEEEE" points="2679.5,4316.1406,2978.5,4316.1406,2978.5,4323.1406,2968.5,4333.1406,2679.5,4333.1406,2679.5,4316.1406" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="254" x="2694.5" y="4329.709">Calculate position and persist change</text><polygon fill="#A80036" points="4194,4350.4512,4204,4354.4512,4194,4358.4512,4198,4354.4512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4200" y1="4354.4512" y2="4354.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4350.0195">57</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="2803.5" y="4350.0195">Request latest position from DB for Payer</text><polygon fill="#A80036" points="4217,4379.7617,4207,4383.7617,4217,4387.7617,4213,4383.7617" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,4379.7617,4915,4383.7617,4905,4387.7617,4909,4383.7617" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4211" x2="4911" y1="4383.7617" y2="4383.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4223" y="4379.3301">58</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="4245" y="4379.3301">Retrieves latest position from DB for Payer</text><polygon fill="#A80036" points="2785.5,4409.0723,2775.5,4413.0723,2785.5,4417.0723,2781.5,4413.0723" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4205" y1="4413.0723" y2="4413.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="4408.6406">59</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="2813.5" y="4408.6406">Return latest position</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="2816.5" y1="4442.6934" y2="4442.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2816.5" x2="2816.5" y1="4442.6934" y2="4455.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2775.5" x2="2816.5" y1="4455.6934" y2="4455.6934"/><polygon fill="#A80036" points="2785.5,4451.6934,2775.5,4455.6934,2785.5,4459.6934,2781.5,4455.6934" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4437.9512">60</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="2803.5" y="4437.9512">Calculates latest position (lpos) by incrementing transfer for prepare</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="2816.5" y1="4485.0039" y2="4485.0039"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2816.5" x2="2816.5" y1="4485.0039" y2="4498.0039"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2775.5" x2="2816.5" y1="4498.0039" y2="4498.0039"/><polygon fill="#A80036" points="2785.5,4494.0039,2775.5,4498.0039,2785.5,4502.0039,2781.5,4498.0039" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4480.2617">61</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="571" x="2803.5" y="4480.2617">Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos &lt; netcap</text><polygon fill="#A80036" points="4194,4523.0039,4204,4527.0039,4194,4531.0039,4198,4527.0039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4200" y1="4527.0039" y2="4527.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="4522.5723">62</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="2803.5" y="4522.5723">Request to persist latest position for Payer</text><polygon fill="#A80036" points="4217,4552.3145,4207,4556.3145,4217,4560.3145,4213,4556.3145" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,4552.3145,4915,4556.3145,4905,4560.3145,4909,4556.3145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4211" x2="4911" y1="4556.3145" y2="4556.3145"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4223" y="4551.8828">63</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="4245" y="4551.8828">Persists latest position to DB for Payer</text><polygon fill="#A80036" points="2785.5,4581.625,2775.5,4585.625,2785.5,4589.625,2781.5,4585.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4205" y1="4585.625" y2="4585.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="4581.1934">64</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="4581.1934">return success</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="2779,4605.9355,2779,4982.9355,3041,4982.9355,3041,4615.9355,3031,4605.9355,2779,4605.9355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3031" x2="3031" y1="4605.9355" y2="4615.9355"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3041" x2="3031" y1="4615.9355" y2="4615.9355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2785" y="4623.5039">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2785" y="4638.8145">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="2801" y="4654.125">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="2801" y="4669.4355">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="2801" y="4684.7461">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="2801" y="4700.0566">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="2801" y="4715.3672">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="2817" y="4730.6777">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="2817" y="4745.9883">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="2801" y="4761.2988">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2801" y="4776.6094">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2817" y="4791.9199">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="2833" y="4807.2305">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="2833" y="4822.541">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="2833" y="4837.8516">type: transfer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="2833" y="4853.1621">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2833" y="4868.4727">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="2833" y="4883.7832">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="2849" y="4899.0938">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2849" y="4914.4043">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2833" y="4929.7148">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2817" y="4945.0254">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2801" y="4960.3359">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2785" y="4975.6465">}</text><polygon fill="#A80036" points="3374.5,5009.3887,3384.5,5013.3887,3374.5,5017.3887,3378.5,5013.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="3380.5" y1="5013.3887" y2="5013.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5008.957">65</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="2803.5" y="5008.957">Publishes Transfer event</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2283.5" x2="4995" y1="5022.6992" y2="5022.6992"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="247" x="2288.5" y="5033.334">[Position Handler consume batch Messages]</text><polygon fill="#A80036" points="2752.5,5053.6543,2762.5,5057.6543,2752.5,5061.6543,2756.5,5057.6543" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2378.5" x2="2758.5" y1="5057.6543" y2="5057.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2385.5" y="5053.2227">66</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="2407.5" y="5053.2227">Consumes Position event batch of messages for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5072.9648"/><polygon fill="#EEEEEE" points="2679.5,5072.9648,2936.5,5072.9648,2936.5,5079.9648,2926.5,5089.9648,2679.5,5089.9648,2679.5,5072.9648" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="2694.5" y="5086.5332">Persist batch Event Information</text><polygon fill="#A80036" points="4291,5107.2754,4301,5111.2754,4291,5115.2754,4295,5111.2754" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4297" y1="5111.2754" y2="5111.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5106.8438">67</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="2803.5" y="5106.8438">Request to persist event information for batch of messages</text><polygon fill="#A80036" points="4314,5136.5859,4304,5140.5859,4314,5144.5859,4310,5140.5859" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,5136.5859,4915,5140.5859,4905,5144.5859,4909,5140.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="5140.5859" y2="5140.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4320" y="5136.1543">68</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="4342" y="5136.1543">Persist event batch information</text><polygon fill="#A80036" points="2785.5,5165.8965,2775.5,5169.8965,2785.5,5173.8965,2781.5,5169.8965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4302" y1="5169.8965" y2="5169.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="5165.4648">69</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="5165.4648">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5192.207"/><polygon fill="#EEEEEE" points="2679.5,5192.207,3163.5,5192.207,3163.5,5199.207,3153.5,5209.207,2679.5,5209.207,2679.5,5192.207" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="439" x="2694.5" y="5205.7754">Persist Prepare Batch Transfer State with transferState='pending'</text><polygon fill="#A80036" points="4389.5,5226.5176,4399.5,5230.5176,4389.5,5234.5176,4393.5,5230.5176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4395.5" y1="5230.5176" y2="5230.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5226.0859">70</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="2803.5" y="5226.0859">Request to persist batch transfer</text><polygon fill="#A80036" points="4412.5,5255.8281,4402.5,5259.8281,4412.5,5263.8281,4408.5,5259.8281" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,5255.8281,4915,5259.8281,4905,5263.8281,4909,5259.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="5259.8281" y2="5259.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="5255.3965">71</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="4440.5" y="5255.3965">Persist batch transfer</text><polygon fill="#A80036" points="2785.5,5285.1387,2775.5,5289.1387,2785.5,5293.1387,2781.5,5289.1387" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4400.5" y1="5289.1387" y2="5289.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="5284.707">72</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="5284.707">return success</text><rect fill="none" height="729.8691" style="stroke: #000000; stroke-width: 2.0;" width="2315.5" x="2669.5" y="5311.4492"/><polygon fill="#EEEEEE" points="2669.5,5311.4492,2743.5,5311.4492,2743.5,5318.4492,2733.5,5328.4492,2669.5,5328.4492,2669.5,5311.4492" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="2684.5" y="5325.0176">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="2758.5" y="5324.084">[for each message in batch]</text><rect fill="none" height="277.7949" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="5335.7598"/><polygon fill="#EEEEEE" points="2679.5,5335.7598,2978.5,5335.7598,2978.5,5342.7598,2968.5,5352.7598,2679.5,5352.7598,2679.5,5335.7598" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="254" x="2694.5" y="5349.3281">Calculate position and persist change</text><polygon fill="#A80036" points="4194,5370.0703,4204,5374.0703,4194,5378.0703,4198,5374.0703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4200" y1="5374.0703" y2="5374.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5369.6387">73</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="259" x="2803.5" y="5369.6387">Request latest position from DB for Payer</text><polygon fill="#A80036" points="4217,5399.3809,4207,5403.3809,4217,5407.3809,4213,5403.3809" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,5399.3809,4915,5403.3809,4905,5407.3809,4909,5403.3809" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4211" x2="4911" y1="5403.3809" y2="5403.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4223" y="5398.9492">74</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="4245" y="5398.9492">Retrieves latest position from DB for Payer</text><polygon fill="#A80036" points="2785.5,5428.6914,2775.5,5432.6914,2785.5,5436.6914,2781.5,5432.6914" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4205" y1="5432.6914" y2="5432.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="5428.2598">75</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="2813.5" y="5428.2598">Return latest position</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="2816.5" y1="5462.3125" y2="5462.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2816.5" x2="2816.5" y1="5462.3125" y2="5475.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2775.5" x2="2816.5" y1="5475.3125" y2="5475.3125"/><polygon fill="#A80036" points="2785.5,5471.3125,2775.5,5475.3125,2785.5,5479.3125,2781.5,5475.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5457.5703">76</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="2803.5" y="5457.5703">Calculates latest position (lpos) by incrementing transfer for prepare</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="2816.5" y1="5504.623" y2="5504.623"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2816.5" x2="2816.5" y1="5504.623" y2="5517.623"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2775.5" x2="2816.5" y1="5517.623" y2="5517.623"/><polygon fill="#A80036" points="2785.5,5513.623,2775.5,5517.623,2785.5,5521.623,2781.5,5517.623" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5499.8809">77</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="571" x="2803.5" y="5499.8809">Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos &lt; netcap</text><polygon fill="#A80036" points="4194,5542.623,4204,5546.623,4194,5550.623,4198,5546.623" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4200" y1="5546.623" y2="5546.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="5542.1914">78</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="2803.5" y="5542.1914">Request to persist latest position for Payer</text><polygon fill="#A80036" points="4217,5571.9336,4207,5575.9336,4217,5579.9336,4213,5575.9336" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,5571.9336,4915,5575.9336,4905,5579.9336,4909,5575.9336" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4211" x2="4911" y1="5575.9336" y2="5575.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4223" y="5571.502">79</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="4245" y="5571.502">Persists latest position to DB for Payer</text><polygon fill="#A80036" points="2785.5,5601.2441,2775.5,5605.2441,2785.5,5609.2441,2781.5,5605.2441" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2779.5" x2="4205" y1="5605.2441" y2="5605.2441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2791.5" y="5600.8125">80</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2813.5" y="5600.8125">return success</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="2779,5625.5547,2779,6002.5547,3041,6002.5547,3041,5635.5547,3031,5625.5547,2779,5625.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3031" x2="3031" y1="5625.5547" y2="5635.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3041" x2="3031" y1="5635.5547" y2="5635.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="2785" y="5643.123">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2785" y="5658.4336">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="2801" y="5673.7441">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="2801" y="5689.0547">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="2801" y="5704.3652">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="2801" y="5719.6758">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="2801" y="5734.9863">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="2817" y="5750.2969">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="2817" y="5765.6074">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="2801" y="5780.918">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="2801" y="5796.2285">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2817" y="5811.5391">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="2833" y="5826.8496">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="2833" y="5842.1602">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="88" x="2833" y="5857.4707">type: transfer,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="2833" y="5872.7813">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="2833" y="5888.0918">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="2833" y="5903.4023">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="2849" y="5918.7129">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="2849" y="5934.0234">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2833" y="5949.334">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2817" y="5964.6445">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2801" y="5979.9551">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="2785" y="5995.2656">}</text><polygon fill="#A80036" points="3374.5,6029.0078,3384.5,6033.0078,3374.5,6037.0078,3378.5,6033.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="3380.5" y1="6033.0078" y2="6033.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2781.5" y="6028.5762">81</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="154" x="2803.5" y="6028.5762">Publishes Transfer event</text><rect fill="none" height="2282.2207" style="stroke: #000000; stroke-width: 2.0;" width="2315.5" x="2669.5" y="6062.3184"/><polygon fill="#EEEEEE" points="2669.5,6062.3184,2731.5,6062.3184,2731.5,6069.3184,2721.5,6079.3184,2669.5,6079.3184,2669.5,6062.3184" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="2684.5" y="6075.8867">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="247" x="2746.5" y="6074.9531">[Transfer Handler consume Single Message]</text><polygon fill="#A80036" points="3761.5,6096.6289,3771.5,6100.6289,3761.5,6104.6289,3765.5,6100.6289" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3386.5" x2="3767.5" y1="6100.6289" y2="6100.6289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3393.5" y="6096.1973">82</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="3415.5" y="6096.1973">Consumes Transfer event</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="6115.9395"/><polygon fill="#EEEEEE" points="3687,6115.9395,3902,6115.9395,3902,6122.9395,3892,6132.9395,3687,6132.9395,3687,6115.9395" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="3702" y="6129.5078">Persist Event Information</text><polygon fill="#A80036" points="4291,6150.25,4301,6154.25,4291,6158.25,4295,6154.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4297" y1="6154.25" y2="6154.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="6149.8184">83</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="3812.5" y="6149.8184">Request to persist event information</text><polygon fill="#A80036" points="4314,6179.5605,4304,6183.5605,4314,6187.5605,4310,6183.5605" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,6179.5605,4915,6183.5605,4905,6187.5605,4909,6183.5605" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="6183.5605" y2="6183.5605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4320" y="6179.1289">84</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4342" y="6179.1289">Persist event information</text><polygon fill="#A80036" points="3794.5,6208.8711,3784.5,6212.8711,3794.5,6216.8711,3790.5,6212.8711" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3788.5" x2="4302" y1="6212.8711" y2="6212.8711"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3800.5" y="6208.4395">85</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3822.5" y="6208.4395">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="6235.1816"/><polygon fill="#EEEEEE" points="3687,6235.1816,4138,6235.1816,4138,6242.1816,4128,6252.1816,3687,6252.1816,3687,6235.1816" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="406" x="3702" y="6248.75">Update Prepare Transfer State with transferState='accepted'</text><polygon fill="#A80036" points="4389.5,6269.4922,4399.5,6273.4922,4389.5,6277.4922,4393.5,6273.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4395.5" y1="6273.4922" y2="6273.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="6269.0605">86</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="3812.5" y="6269.0605">Request to update transfer</text><polygon fill="#A80036" points="4412.5,6298.8027,4402.5,6302.8027,4412.5,6306.8027,4408.5,6302.8027" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,6298.8027,4915,6302.8027,4905,6306.8027,4909,6302.8027" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="6302.8027" y2="6302.8027"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="6298.3711">87</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="4440.5" y="6298.3711">Update transfer</text><polygon fill="#A80036" points="3794.5,6328.1133,3784.5,6332.1133,3794.5,6336.1133,3790.5,6332.1133" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3788.5" x2="4400.5" y1="6332.1133" y2="6332.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3800.5" y="6327.6816">88</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3822.5" y="6327.6816">return success</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="3788,6352.4238,3788,6729.4238,4050,6729.4238,4050,6362.4238,4040,6352.4238,3788,6352.4238" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4040" x2="4040" y1="6352.4238" y2="6362.4238"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4050" x2="4040" y1="6362.4238" y2="6362.4238"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3794" y="6369.9922">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="6385.3027">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="6400.6133">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3810" y="6415.9238">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="6431.2344">to: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3810" y="6446.5449">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3810" y="6461.8555">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3826" y="6477.166">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3826" y="6492.4766">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3810" y="6507.7871">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3810" y="6523.0977">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3826" y="6538.4082">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3842" y="6553.7188">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3842" y="6569.0293">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3842" y="6584.3398">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3842" y="6599.6504">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3842" y="6614.9609">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3842" y="6630.2715">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3858" y="6645.582">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3858" y="6660.8926">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3842" y="6676.2031">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3826" y="6691.5137">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3810" y="6706.8242">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="6722.1348">}</text><polygon fill="#A80036" points="4062.5,6755.877,4072.5,6759.877,4062.5,6763.877,4066.5,6759.877" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4068.5" y1="6759.877" y2="6759.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="6755.4453">89</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="3812.5" y="6755.4453">Publishes Notifications event for Payer</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="3788,6773.1875,3788,7150.1875,4050,7150.1875,4050,6783.1875,4040,6773.1875,3788,6773.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4040" x2="4040" y1="6773.1875" y2="6783.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4050" x2="4040" y1="6783.1875" y2="6783.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3794" y="6790.7559">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="6806.0664">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="6821.377">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3810" y="6836.6875">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="3810" y="6851.998">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3810" y="6867.3086">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3810" y="6882.6191">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3826" y="6897.9297">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3826" y="6913.2402">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3810" y="6928.5508">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3810" y="6943.8613">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3826" y="6959.1719">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3842" y="6974.4824">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3842" y="6989.793">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3842" y="7005.1035">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3842" y="7020.4141">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3842" y="7035.7246">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3842" y="7051.0352">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3858" y="7066.3457">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3858" y="7081.6563">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3842" y="7096.9668">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3826" y="7112.2773">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3810" y="7127.5879">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="7142.8984">}</text><polygon fill="#A80036" points="4062.5,7176.6406,4072.5,7180.6406,4062.5,7184.6406,4066.5,7180.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4068.5" y1="7180.6406" y2="7180.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="7176.209">90</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="3812.5" y="7176.209">Publishes Notifications event for Payee</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2669.5" x2="4985" y1="7189.9512" y2="7189.9512"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="249" x="2674.5" y="7200.5859">[Transfer Handler consume batch Messages]</text><polygon fill="#A80036" points="3761.5,7220.9063,3771.5,7224.9063,3761.5,7228.9063,3765.5,7224.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3386.5" x2="3767.5" y1="7224.9063" y2="7224.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3393.5" y="7220.4746">91</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="341" x="3415.5" y="7220.4746">Consumes Transfer event batch of messages for Payer</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="2295.5" x="2679.5" y="7240.2168"/><polygon fill="#EEEEEE" points="2679.5,7240.2168,2936.5,7240.2168,2936.5,7247.2168,2926.5,7257.2168,2679.5,7257.2168,2679.5,7240.2168" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="2694.5" y="7253.7852">Persist batch Event Information</text><polygon fill="#A80036" points="4291,7274.5273,4301,7278.5273,4291,7282.5273,4295,7278.5273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2769.5" x2="4297" y1="7278.5273" y2="7278.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2776.5" y="7274.0957">92</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="2798.5" y="7274.0957">Request to persist event information for batch of messages</text><polygon fill="#A80036" points="4314,7303.8379,4304,7307.8379,4314,7311.8379,4310,7307.8379" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,7303.8379,4915,7307.8379,4905,7311.8379,4909,7307.8379" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="7307.8379" y2="7307.8379"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4320" y="7303.4063">93</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="4342" y="7303.4063">Persist event batch information</text><polygon fill="#A80036" points="2780.5,7333.1484,2770.5,7337.1484,2780.5,7341.1484,2776.5,7337.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2774.5" x2="4302" y1="7337.1484" y2="7337.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="2786.5" y="7332.7168">94</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="2808.5" y="7332.7168">return success</text><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="1288" x="3687" y="7359.459"/><polygon fill="#EEEEEE" points="3687,7359.459,4180,7359.459,4180,7366.459,4170,7376.459,3687,7376.459,3687,7359.459" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="448" x="3702" y="7373.0273">Update Prepare batch Transfer State with transferState='accepted'</text><polygon fill="#A80036" points="4389.5,7393.7695,4399.5,7397.7695,4389.5,7401.7695,4393.5,7397.7695" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4395.5" y1="7397.7695" y2="7397.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="7393.3379">95</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="3812.5" y="7393.3379">Request to update batch transfer</text><polygon fill="#A80036" points="4412.5,7423.0801,4402.5,7427.0801,4412.5,7431.0801,4408.5,7427.0801" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,7423.0801,4915,7427.0801,4905,7431.0801,4909,7427.0801" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4406.5" x2="4911" y1="7427.0801" y2="7427.0801"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="4418.5" y="7422.6484">96</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="4440.5" y="7422.6484">Update batch transfer</text><polygon fill="#A80036" points="3794.5,7452.3906,3784.5,7456.3906,3794.5,7460.3906,3790.5,7456.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3788.5" x2="4400.5" y1="7456.3906" y2="7456.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3800.5" y="7451.959">97</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="3822.5" y="7451.959">return success</text><rect fill="none" height="858.8379" style="stroke: #000000; stroke-width: 2.0;" width="471" x="3687" y="7478.7012"/><polygon fill="#EEEEEE" points="3687,7478.7012,3761,7478.7012,3761,7485.7012,3751,7495.7012,3687,7495.7012,3687,7478.7012" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="3702" y="7492.2695">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="3776" y="7491.3359">[for each message in batch]</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="3788,7501.0117,3788,7878.0117,4050,7878.0117,4050,7511.0117,4040,7501.0117,3788,7501.0117" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4040" x2="4040" y1="7501.0117" y2="7511.0117"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4050" x2="4040" y1="7511.0117" y2="7511.0117"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3794" y="7518.5801">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="7533.8906">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="7549.2012">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3810" y="7564.5117">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="7579.8223">to: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3810" y="7595.1328">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3810" y="7610.4434">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3826" y="7625.7539">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3826" y="7641.0645">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3810" y="7656.375">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3810" y="7671.6855">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3826" y="7686.9961">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3842" y="7702.3066">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3842" y="7717.6172">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3842" y="7732.9277">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3842" y="7748.2383">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3842" y="7763.5488">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3842" y="7778.8594">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3858" y="7794.1699">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3858" y="7809.4805">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3842" y="7824.791">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3826" y="7840.1016">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3810" y="7855.4121">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="7870.7227">}</text><polygon fill="#A80036" points="4062.5,7904.4648,4072.5,7908.4648,4062.5,7912.4648,4066.5,7908.4648" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4068.5" y1="7908.4648" y2="7908.4648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="7904.0332">98</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="3812.5" y="7904.0332">Publishes Notifications event for Payer</text><polygon fill="#FFFF00" filter="url(#fjuogvs6sjqud)" points="3788,7921.7754,3788,8298.7754,4050,8298.7754,4050,7931.7754,4040,7921.7754,3788,7921.7754" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4040" x2="4040" y1="7921.7754" y2="7931.7754"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4050" x2="4040" y1="7931.7754" y2="7931.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="3794" y="7939.3438">Message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="7954.6543">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="208" x="3810" y="7969.9648">id: &lt;transferMessage.transferId&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="225" x="3810" y="7985.2754">from: &lt;transferMessage.payerFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="3810" y="8000.5859">to: &lt;transferMessage.payeeFsp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="3810" y="8015.8965">type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="3810" y="8031.207">content: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="3826" y="8046.5176">headers: &lt;transferHeaders&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="3826" y="8061.8281">payload: &lt;transferMessage&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="3810" y="8077.1387">},</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="3810" y="8092.4492">metadata: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3826" y="8107.7598">event: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="3842" y="8123.0703">id: &lt;uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="3842" y="8138.3809">responseTo: &lt;previous.uuid&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="3842" y="8153.6914">type: notification,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="3842" y="8169.002">action: prepare,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="3842" y="8184.3125">createdAt: &lt;timestamp&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="3842" y="8199.623">state: {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="3858" y="8214.9336">status: "success",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="3858" y="8230.2441">code: 0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3842" y="8245.5547">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3826" y="8260.8652">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3810" y="8276.1758">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="3794" y="8291.4863">}</text><polygon fill="#A80036" points="4062.5,8325.2285,4072.5,8329.2285,4062.5,8333.2285,4066.5,8329.2285" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="3783.5" x2="4068.5" y1="8329.2285" y2="8329.2285"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="3790.5" y="8324.7969">99</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="245" x="3812.5" y="8324.7969">Publishes Notifications event for Payee</text><rect fill="none" height="860.9609" style="stroke: #000000; stroke-width: 2.0;" width="4972" x="23" y="8358.5391"/><polygon fill="#EEEEEE" points="23,8358.5391,246,8358.5391,246,8365.5391,236,8375.5391,23,8375.5391,23,8358.5391" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="38" y="8372.1074">Send notification for Payer</text><rect fill="none" height="829.6504" style="stroke: #000000; stroke-width: 2.0;" width="4952" x="33" y="8382.8496"/><polygon fill="#EEEEEE" points="33,8382.8496,95,8382.8496,95,8389.8496,85,8399.8496,33,8399.8496,33,8382.8496" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="48" y="8396.418">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="271" x="110" y="8395.4844">[Notifications Handler consume Single Message]</text><polygon fill="#A80036" points="784.5,8417.1602,774.5,8421.1602,784.5,8425.1602,780.5,8421.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="4073.5" y1="8421.1602" y2="8421.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="8416.7285">100</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="821.5" y="8416.7285">Consumes Notifications event</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="8436.4707"/><polygon fill="#EEEEEE" points="642,8436.4707,857,8436.4707,857,8443.4707,847,8453.4707,642,8453.4707,642,8436.4707" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="657" y="8450.0391">Persist Event Information</text><polygon fill="#A80036" points="1290.5,8470.7813,1300.5,8474.7813,1290.5,8478.7813,1294.5,8474.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1296.5" y1="8474.7813" y2="8474.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="780.5" y="8470.3496">101</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="811.5" y="8470.3496">Requests to persist event information - POST - HTTP://events/</text><polygon fill="#A80036" points="4291,8500.0918,4301,8504.0918,4291,8508.0918,4295,8504.0918" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4297" y1="8504.0918" y2="8504.0918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="8499.6602">102</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1340.5" y="8499.6602">Request to persist event information</text><polygon fill="#A80036" points="4314,8529.4023,4304,8533.4023,4314,8537.4023,4310,8533.4023" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,8529.4023,4915,8533.4023,4905,8537.4023,4909,8533.4023" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="8533.4023" y2="8533.4023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4320" y="8528.9707">103</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4351" y="8528.9707">Persist event information</text><polygon fill="#A80036" points="1313.5,8558.7129,1303.5,8562.7129,1313.5,8566.7129,1309.5,8562.7129" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4302" y1="8562.7129" y2="8562.7129"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="8558.2813">104</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1350.5" y="8558.2813">return success</text><polygon fill="#A80036" points="784.5,8588.0234,774.5,8592.0234,784.5,8596.0234,780.5,8592.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="1301.5" y1="8592.0234" y2="8592.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="8587.5918">105</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="821.5" y="8587.5918">return success</text><polygon fill="#A80036" points="1290.5,8624.334,1300.5,8628.334,1290.5,8632.334,1294.5,8628.334" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1296.5" y1="8628.334" y2="8628.334"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="780.5" y="8623.9023">106</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="474" x="811.5" y="8623.9023">Requests Notification details for Payer - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="4509,8653.6445,4519,8657.6445,4509,8661.6445,4513,8657.6445" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4515" y1="8657.6445" y2="8657.6445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="8653.2129">107</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1340.5" y="8653.2129">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="4532,8682.9551,4522,8686.9551,4532,8690.9551,4528,8686.9551" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,8682.9551,4915,8686.9551,4905,8690.9551,4909,8686.9551" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4526" x2="4911" y1="8686.9551" y2="8686.9551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4538" y="8682.5234">108</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="4569" y="8682.5234">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="1313.5,8712.2656,1303.5,8716.2656,1313.5,8720.2656,1309.5,8716.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4520" y1="8716.2656" y2="8716.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="8711.834">109</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1350.5" y="8711.834">Returns Notifications details for Payer</text><polygon fill="#A80036" points="784.5,8741.5762,774.5,8745.5762,784.5,8749.5762,780.5,8745.5762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="1301.5" y1="8745.5762" y2="8745.5762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="8741.1445">110</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="821.5" y="8741.1445">Returns Notifications details for Payer</text><polygon fill="#A80036" points="85.5,8770.8867,75.5,8774.8867,85.5,8778.8867,81.5,8774.8867" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="762.5" y1="8774.8867" y2="8774.8867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="91.5" y="8770.4551">111</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="122.5" y="8770.4551">HTTP Callback with Prepare result to Payer</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="4985" y1="8784.1973" y2="8784.1973"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="273" x="38" y="8794.832">[Notifications Handler consume batch Messages]</text><polygon fill="#A80036" points="784.5,8815.1523,774.5,8819.1523,784.5,8823.1523,780.5,8819.1523" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="4073.5" y1="8819.1523" y2="8819.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="8814.7207">112</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="371" x="821.5" y="8814.7207">Consumes Notifications event batch of messages for Payer</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="8834.4629"/><polygon fill="#EEEEEE" points="642,8834.4629,899,8834.4629,899,8841.4629,889,8851.4629,642,8851.4629,642,8834.4629" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="657" y="8848.0313">Persist batch Event Information</text><polygon fill="#A80036" points="1290.5,8868.7734,1300.5,8872.7734,1290.5,8876.7734,1294.5,8872.7734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1296.5" y1="8872.7734" y2="8872.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="780.5" y="8868.3418">113</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="439" x="811.5" y="8868.3418">Requests to persist batch event information - POST - HTTP://events/</text><polygon fill="#A80036" points="4291,8898.084,4301,8902.084,4291,8906.084,4295,8902.084" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4297" y1="8902.084" y2="8902.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="8897.6523">114</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="1340.5" y="8897.6523">Request to persist batch event information</text><polygon fill="#A80036" points="4314,8927.3945,4304,8931.3945,4314,8935.3945,4310,8931.3945" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,8927.3945,4915,8931.3945,4905,8935.3945,4909,8931.3945" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="8931.3945" y2="8931.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4320" y="8926.9629">115</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4351" y="8926.9629">Persist event information</text><polygon fill="#A80036" points="1313.5,8956.7051,1303.5,8960.7051,1313.5,8964.7051,1309.5,8960.7051" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4302" y1="8960.7051" y2="8960.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="8956.2734">116</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1350.5" y="8956.2734">return success</text><polygon fill="#A80036" points="784.5,8986.0156,774.5,8990.0156,784.5,8994.0156,780.5,8990.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="1301.5" y1="8990.0156" y2="8990.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="8985.584">117</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="821.5" y="8985.584">return success</text><rect fill="none" height="193.1738" style="stroke: #000000; stroke-width: 2.0;" width="4932" x="43" y="9012.3262"/><polygon fill="#EEEEEE" points="43,9012.3262,117,9012.3262,117,9019.3262,107,9029.3262,43,9029.3262,43,9012.3262" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="58" y="9025.8945">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="132" y="9024.9609">[for each message in batch]</text><polygon fill="#A80036" points="1290.5,9046.6367,1300.5,9050.6367,1290.5,9054.6367,1294.5,9050.6367" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1296.5" y1="9050.6367" y2="9050.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="780.5" y="9046.2051">118</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="474" x="811.5" y="9046.2051">Requests Notification details for Payer - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="4509,9075.9473,4519,9079.9473,4509,9083.9473,4513,9079.9473" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4515" y1="9079.9473" y2="9079.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="9075.5156">119</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1340.5" y="9075.5156">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="4532,9105.2578,4522,9109.2578,4532,9113.2578,4528,9109.2578" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,9105.2578,4915,9109.2578,4905,9113.2578,4909,9109.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4526" x2="4911" y1="9109.2578" y2="9109.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4538" y="9104.8262">120</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="4569" y="9104.8262">Fetches Notifications details for Payer</text><polygon fill="#A80036" points="1313.5,9134.5684,1303.5,9138.5684,1313.5,9142.5684,1309.5,9138.5684" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4520" y1="9138.5684" y2="9138.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="9134.1367">121</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="1350.5" y="9134.1367">Returns Notifications details for Payer</text><polygon fill="#A80036" points="784.5,9163.8789,774.5,9167.8789,784.5,9171.8789,780.5,9167.8789" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="778.5" x2="1301.5" y1="9167.8789" y2="9167.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="790.5" y="9163.4473">122</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="821.5" y="9163.4473">Returns Notifications details for Payer</text><polygon fill="#A80036" points="85.5,9193.1895,75.5,9197.1895,85.5,9201.1895,81.5,9197.1895" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="762.5" y1="9197.1895" y2="9197.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="91.5" y="9192.7578">123</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="266" x="122.5" y="9192.7578">HTTP Callback with Prepare result to Payer</text><rect fill="none" height="860.9609" style="stroke: #000000; stroke-width: 2.0;" width="4972" x="23" y="9233.5"/><polygon fill="#EEEEEE" points="23,9233.5,248,9233.5,248,9240.5,238,9250.5,23,9250.5,23,9233.5" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="38" y="9247.0684">Send notification for Payee</text><rect fill="none" height="829.6504" style="stroke: #000000; stroke-width: 2.0;" width="4952" x="33" y="9257.8105"/><polygon fill="#EEEEEE" points="33,9257.8105,95,9257.8105,95,9264.8105,85,9274.8105,33,9274.8105,33,9257.8105" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="48" y="9271.3789">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="271" x="110" y="9270.4453">[Notifications Handler consume Single Message]</text><polygon fill="#A80036" points="779.5,9292.1211,769.5,9296.1211,779.5,9300.1211,775.5,9296.1211" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="4073.5" y1="9296.1211" y2="9296.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="9291.6895">124</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="816.5" y="9291.6895">Consumes Notifications event</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="9311.4316"/><polygon fill="#EEEEEE" points="642,9311.4316,857,9311.4316,857,9318.4316,847,9328.4316,642,9328.4316,642,9311.4316" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="170" x="657" y="9325">Persist Event Information</text><polygon fill="#A80036" points="1290.5,9345.7422,1300.5,9349.7422,1290.5,9353.7422,1294.5,9349.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1296.5" y1="9349.7422" y2="9349.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="775.5" y="9345.3105">125</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="806.5" y="9345.3105">Requests to persist event information - POST - HTTP://events/</text><polygon fill="#A80036" points="4291,9375.0527,4301,9379.0527,4291,9383.0527,4295,9379.0527" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4297" y1="9379.0527" y2="9379.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="9374.6211">126</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1340.5" y="9374.6211">Request to persist event information</text><polygon fill="#A80036" points="4314,9404.3633,4304,9408.3633,4314,9412.3633,4310,9408.3633" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,9404.3633,4915,9408.3633,4905,9412.3633,4909,9408.3633" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="9408.3633" y2="9408.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4320" y="9403.9316">127</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4351" y="9403.9316">Persist event information</text><polygon fill="#A80036" points="1313.5,9433.6738,1303.5,9437.6738,1313.5,9441.6738,1309.5,9437.6738" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4302" y1="9437.6738" y2="9437.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="9433.2422">128</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1350.5" y="9433.2422">return success</text><polygon fill="#A80036" points="779.5,9462.9844,769.5,9466.9844,779.5,9470.9844,775.5,9466.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1301.5" y1="9466.9844" y2="9466.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="9462.5527">129</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="816.5" y="9462.5527">return success</text><polygon fill="#A80036" points="1290.5,9499.2949,1300.5,9503.2949,1290.5,9507.2949,1294.5,9503.2949" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1296.5" y1="9503.2949" y2="9503.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="775.5" y="9498.8633">130</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="476" x="806.5" y="9498.8633">Requests Notification details for Payee - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="4509,9528.6055,4519,9532.6055,4509,9536.6055,4513,9532.6055" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4515" y1="9532.6055" y2="9532.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="9528.1738">131</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1340.5" y="9528.1738">Fetches Notifications details for Payee</text><polygon fill="#A80036" points="4532,9557.916,4522,9561.916,4532,9565.916,4528,9561.916" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,9557.916,4915,9561.916,4905,9565.916,4909,9561.916" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4526" x2="4911" y1="9561.916" y2="9561.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4538" y="9557.4844">132</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="4569" y="9557.4844">Fetches Notifications details for Payee</text><polygon fill="#A80036" points="1313.5,9587.2266,1303.5,9591.2266,1313.5,9595.2266,1309.5,9591.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4520" y1="9591.2266" y2="9591.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="9586.7949">133</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1350.5" y="9586.7949">Returns Notifications details for Payee</text><polygon fill="#A80036" points="779.5,9616.5371,769.5,9620.5371,779.5,9624.5371,775.5,9620.5371" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1301.5" y1="9620.5371" y2="9620.5371"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="9616.1055">134</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="816.5" y="9616.1055">Returns Notifications details for Payee</text><polygon fill="#A80036" points="85.5,9645.8477,75.5,9649.8477,85.5,9653.8477,81.5,9649.8477" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="767.5" y1="9649.8477" y2="9649.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="91.5" y="9645.416">135</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="122.5" y="9645.416">HTTP Callback with Prepare result to Payee</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="33" x2="4985" y1="9659.1582" y2="9659.1582"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="273" x="38" y="9669.793">[Notifications Handler consume batch Messages]</text><polygon fill="#A80036" points="779.5,9690.1133,769.5,9694.1133,779.5,9698.1133,775.5,9694.1133" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="4073.5" y1="9694.1133" y2="9694.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="9689.6816">136</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="373" x="816.5" y="9689.6816">Consumes Notifications event batch of messages for Payee</text><rect fill="none" height="163.8633" style="stroke: #000000; stroke-width: 2.0;" width="4333" x="642" y="9709.4238"/><polygon fill="#EEEEEE" points="642,9709.4238,899,9709.4238,899,9716.4238,889,9726.4238,642,9726.4238,642,9709.4238" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="212" x="657" y="9722.9922">Persist batch Event Information</text><polygon fill="#A80036" points="1290.5,9743.7344,1300.5,9747.7344,1290.5,9751.7344,1294.5,9747.7344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1296.5" y1="9747.7344" y2="9747.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="775.5" y="9743.3027">137</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="439" x="806.5" y="9743.3027">Requests to persist batch event information - POST - HTTP://events/</text><polygon fill="#A80036" points="4291,9773.0449,4301,9777.0449,4291,9781.0449,4295,9777.0449" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4297" y1="9777.0449" y2="9777.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="9772.6133">138</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="269" x="1340.5" y="9772.6133">Request to persist batch event information</text><polygon fill="#A80036" points="4314,9802.3555,4304,9806.3555,4314,9810.3555,4310,9806.3555" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,9802.3555,4915,9806.3555,4905,9810.3555,4909,9806.3555" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4308" x2="4911" y1="9806.3555" y2="9806.3555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4320" y="9801.9238">139</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="4351" y="9801.9238">Persist event information</text><polygon fill="#A80036" points="1313.5,9831.666,1303.5,9835.666,1313.5,9839.666,1309.5,9835.666" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4302" y1="9835.666" y2="9835.666"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="9831.2344">140</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="1350.5" y="9831.2344">return success</text><polygon fill="#A80036" points="779.5,9860.9766,769.5,9864.9766,779.5,9868.9766,775.5,9864.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1301.5" y1="9864.9766" y2="9864.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="9860.5449">141</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="816.5" y="9860.5449">return success</text><rect fill="none" height="193.1738" style="stroke: #000000; stroke-width: 2.0;" width="4932" x="43" y="9887.2871"/><polygon fill="#EEEEEE" points="43,9887.2871,117,9887.2871,117,9894.2871,107,9904.2871,43,9904.2871,43,9887.2871" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="58" y="9900.8555">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="155" x="132" y="9899.9219">[for each message in batch]</text><polygon fill="#A80036" points="1290.5,9921.5977,1300.5,9925.5977,1290.5,9929.5977,1294.5,9925.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="768.5" x2="1296.5" y1="9925.5977" y2="9925.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="775.5" y="9921.166">142</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="476" x="806.5" y="9921.166">Requests Notification details for Payee - GET - HTTP://notifications/DFPS1</text><polygon fill="#A80036" points="4509,9950.9082,4519,9954.9082,4509,9958.9082,4513,9954.9082" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1302.5" x2="4515" y1="9954.9082" y2="9954.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1309.5" y="9950.4766">143</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1340.5" y="9950.4766">Fetches Notifications details for Payee</text><polygon fill="#A80036" points="4532,9980.2188,4522,9984.2188,4532,9988.2188,4528,9984.2188" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="4905,9980.2188,4915,9984.2188,4905,9988.2188,4909,9984.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="4526" x2="4911" y1="9984.2188" y2="9984.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="4538" y="9979.7871">144</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="4569" y="9979.7871">Fetches Notifications details for Payee</text><polygon fill="#A80036" points="1313.5,10009.5293,1303.5,10013.5293,1313.5,10017.5293,1309.5,10013.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1307.5" x2="4520" y1="10013.5293" y2="10013.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="1319.5" y="10009.0977">145</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="1350.5" y="10009.0977">Returns Notifications details for Payee</text><polygon fill="#A80036" points="779.5,10038.8398,769.5,10042.8398,779.5,10046.8398,775.5,10042.8398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="773.5" x2="1301.5" y1="10042.8398" y2="10042.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="785.5" y="10038.4082">146</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="241" x="816.5" y="10038.4082">Returns Notifications details for Payee</text><polygon fill="#A80036" points="85.5,10068.1504,75.5,10072.1504,85.5,10076.1504,81.5,10072.1504" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="79.5" x2="767.5" y1="10072.1504" y2="10072.1504"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="91.5" y="10067.7188">147</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="122.5" y="10067.7188">HTTP Callback with Prepare result to Payee</text><!--
@startuml
' declate title
title 1.1 DFSP1 sends a Prepare Transfer request to DFSP2

autonumber

' Actor Keys:
'   boundary - APIs/Interfaces, etc
'   collections - Kafka Topics
'   control - Kafka Consumers
'   entity - Database Access Objects
'   database - Database Persistance Store

' declare actors
actor "Payer" as DFSP1
actor "Payee" as DFSP2
boundary "ML API Adapter" as MLAPI
control "ML API Notification Event Handler" as NOTIFY_HANDLER
boundary "Central Service API" as CSAPI
collections "Prepare-Topic-dfsp1" as TOPIC_PREPARE_DFSP1
control "Prepare Event Handler" as PREP_HANDLER
collections "Position-Topic-dfsp1" as TOPIC_POSITION_DFSP1
control "Position Event Handler" as POS_HANDLER
collections "Transfer-Topic" as TOPIC_TRANSFERS
control "Transfer Event Handler" as TRANS_HANDLER
collections "Notification-Topic" as TOPIC_NOTIFICATIONS
' collections "Errors-Topic" as ERRORS_NOTIFICATIONS
entity "Position DAO" as POS_DAO
entity "Event DAO" as EVENT_DAO
entity "Transfer DAO" as TRANS_DAO
entity "Notification DAO" as NOTIFY_DAO
entity "Participant DAO" as PARTICIPANT_DAO
database "Central Store" as DB

box "Financial Service Providers" #lightGray
	participant DFSP1
	participant DFSP2
end box

box "ML API Adapter Service" #LightBlue
	participant MLAPI
	participant NOTIFY_HANDLER
end box

box "Central Service" #LightYellow
    participant CSAPI
	participant TOPIC_PREPARE_DFSP1
    participant PREP_HANDLER
    participant TOPIC_POSITION_DFSP1
    participant POS_HANDLER
    participant TOPIC_TRANSFERS
    participant TRANS_HANDLER
    participant TOPIC_NOTIFICATIONS
    ' participant ERRORS_NOTIFICATIONS
    participant POS_DAO
    participant EVENT_DAO
    participant TRANS_DAO
    participant NOTIFY_DAO
    participant PARTICIPANT_DAO
    participant DB
end box

' start flow
group DFSP1 sends a Prepare Transfer request to Payee
    activate MLAPI
    note right of DFSP1 #yellow
        Headers - transferHeaders: {
            Content-Length: <Content-Length>,
            Content-Type: <Content-Type>,
            Date: <Date>,
            X-Forwarded-For: <X-Forwarded-For>,
            FSPIOP-Source: <FSPIOP-Source>,
            FSPIOP-Destination: <FSPIOP-Destination>,
            FSPIOP-Encryption: <FSPIOP-Encryption>,
            FSPIOP-Signature: <FSPIOP-Signature>,
            FSPIOP-URI: <FSPIOP-URI>,
            FSPIOP-HTTP-Method: <FSPIOP-HTTP-Method>
        }

        Payload - transferMessage:
        {
            "transferId": <uuid>,
            "payeeFsp": dfsp1,
            "payerFsp": dfsp1,
            "amount": {
                "currency": "AED",
                "amount": "string"
            },
            "ilpPacket": "string",
            "condition": "string",
            "expiration": "string",
            "extensionList": {
                "extension": [
                    {
                        "key": "string",
                        "value": "string"
                    }
                ]
            }
        }
    end note
    DFSP1 -> MLAPI: POST - http://transfers
    MLAPI -> MLAPI: validates incoming token, and the originator matches Payer
    note right of MLAPI #yellow
        Message:
        {
            id: <transferMessage.transferId>
            from: <transferMessage.payerFsp>,
            to: <transferMessage.payeeFsp>,
            type: application/json
            content: {
                headers: <transferHeaders>,
                payload: <transferMessage>
            },
            metadata: {
                event: {
                    id: <uuid>,
                    type: prepare,
                    action: prepare,
                    createdAt: <timestamp>,
                    state: {
                        status: "success",
                        code: 0
                    }
                }
            }
        }
    end note
    MLAPI -> TOPIC_PREPARE_DFSP1: Routes & Publishes Prepare event for Payer
    TOPIC_PREPARE_DFSP1 <-> TOPIC_PREPARE_DFSP1: Ensures that event is replicated as configured (ACKS=all)
    TOPIC_PREPARE_DFSP1 -> MLAPI: Responds replication acknoledgements have been received
    MLAPI -> DFSP1: Respond HTTP - 202 (Accepted)
    deactivate MLAPI

    activate PREP_HANDLER
    alt Prepare Handler consume Single Message
        TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event message for Payer
        group Persist Event Information
            PREP_HANDLER -> EVENT_DAO: Request to persist event information
            EVENT_DAO <-> DB: Persist event information
            EVENT_DAO -> PREP_HANDLER: return success
        end
        group Validate Prepare Transfer
            group Validate Payer
                PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve Payer Participant details (if it exists)
                PARTICIPANT_DAO <-> DB: return Participant details if it exists
                PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
                PREP_HANDLER <-> PREP_HANDLER: Validates Payer
            end
            group Validate Payee
                PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve Payee Participant details (if it exists)
                PARTICIPANT_DAO <-> DB: return Participant details if it exists
                PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
                PREP_HANDLER <-> PREP_HANDLER: Validates Payee
            end
            group Duplicate check
                PREP_HANDLER -> TRANS_DAO: Request to retrieve Transfer (if it exists)
                TRANS_DAO <-> DB: return Transfer if it exists
                TRANS_DAO -> PREP_HANDLER: return Transfer if it exists
                PREP_HANDLER <-> PREP_HANDLER: Validates duplicate Check
            end
            PREP_HANDLER <-> PREP_HANDLER: Validates crypto-condition
            PREP_HANDLER <-> PREP_HANDLER: Validates message signature (to be confirmed in future requirement)
        end
        note right of PREP_HANDLER #yellow
            Message:
            {
                id: <transferMessage.transferId>
                from: <transferMessage.payerFsp>,
                to: <transferMessage.payeeFsp>,
                type: application/json
                content: {
                    headers: <transferHeaders>,
                    payload: <transferMessage>
                },
                metadata: {
                    event: {
                        id: <uuid>,
                        responseTo: <previous.uuid>,
                        type: position,
                        action: prepare,
                        createdAt: <timestamp>,
                        state: {
                            status: "success",
                            code: 0
                        }
                    }
                }
            }
        end note
        PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for Payer
    else Prepare Handler consume batch Messages
        TOPIC_PREPARE_DFSP1 -> PREP_HANDLER: Consumes Prepare event batch of messages for Payer
        group Persist batch Event Information
            PREP_HANDLER -> EVENT_DAO: Request to persist event information for batch of messages
            EVENT_DAO <-> DB: Persist event batch information
            EVENT_DAO -> PREP_HANDLER: return success
        end

        group Fetch batch Payer information
            PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve batch of Payer Participant details (if it exists)
            PARTICIPANT_DAO <-> DB: return Participant details if it exists
            PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
            PREP_HANDLER <-> PREP_HANDLER: Validates Payer
            PREP_HANDLER -> PREP_HANDLER: store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYER
        end

        group Fetch batch Payee information
            PREP_HANDLER -> PARTICIPANT_DAO: Request to retrieve batch of Payee Participant details (if it exists)
            PARTICIPANT_DAO <-> DB: return Participant details if it exists
            PARTICIPANT_DAO -> PREP_HANDLER: return Participant details if it exists
            PREP_HANDLER <-> PREP_HANDLER: Validates Payee
            PREP_HANDLER -> PREP_HANDLER: store result set in var: $LIST_PARTICIPANTS_DETAILS_PAYEE
        end

        group Fetch batch of transfers
            PREP_HANDLER -> TRANS_DAO: Request to retrieve batch of Transfers (if it exists)
            TRANS_DAO <-> DB: return batch of Transfers (if it exists)
            TRANS_DAO -> PREP_HANDLER: return batch of Transfer (if it exists)
            PREP_HANDLER -> PREP_HANDLER: store result set in var: $LIST_TRANSFERS
        end

        loop for each message in batch
            group Validate Prepare Transfer
                group Validate Payer
                    PREP_HANDLER <-> PREP_HANDLER: Validates Payer against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYER
                end
                group Validate Payee
                    PREP_HANDLER <-> PREP_HANDLER: Validates Payee against in-memory var $LIST_PARTICIPANTS_DETAILS_PAYEE
                end
                group Duplicate check
                    PREP_HANDLER <-> PREP_HANDLER: Validates duplicate Check against in-memory var $LIST_TRANSFERS
                end
                PREP_HANDLER <-> PREP_HANDLER: Validates crypto-condition
                PREP_HANDLER <-> PREP_HANDLER: Validates message signature (to be confirmed in future requirement)
            end
            note right of PREP_HANDLER #yellow
                Message:
                {
                    id: <transferMessage.transferId>
                    from: <transferMessage.payerFsp>,
                    to: <transferMessage.payeeFsp>,
                    type: application/json
                    content: {
                        headers: <transferHeaders>,
                        payload: <transferMessage>
                    },
                    metadata: {
                        event: {
                            id: <uuid>,
                            responseTo: <previous.uuid>,
                            type: position,
                            action: prepare,
                            createdAt: <timestamp>,
                            state: {
                                status: "success",
                                code: 0
                            }
                        }
                    }
                }
            end note
            PREP_HANDLER -> TOPIC_POSITION_DFSP1: Routes & Publishes Position event for Payer
        end
    end
    deactivate PREP_HANDLER

    activate POS_HANDLER
    alt Position Handler consume Single Message
        TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event message for Payer

        group Persist Event Information
            POS_HANDLER -> EVENT_DAO: Request to persist event information
            EVENT_DAO <-> DB: Persist event information
            EVENT_DAO -> POS_HANDLER: return success
        end

        group Persist Prepare Transfer State with transferState='pending'
            POS_HANDLER -> TRANS_DAO: Request to persist transfer
            TRANS_DAO <-> DB: Persist transfer
            TRANS_DAO -> POS_HANDLER: return success
        end

        group Calculate position and persist change
            POS_HANDLER -> POS_DAO: Request latest position from DB for Payer
            POS_DAO <-> DB: Retrieves latest position from DB for Payer
            POS_DAO -> POS_HANDLER: Return latest position

            POS_HANDLER <-> POS_HANDLER: Calculates latest position (lpos) by incrementing transfer for prepare
            POS_HANDLER <-> POS_HANDLER: Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos < netcap
            
            POS_HANDLER -> POS_DAO: Request to persist latest position for Payer
            POS_DAO <-> DB: Persists latest position to DB for Payer
            POS_DAO -> POS_HANDLER: return success
        end
        note right of POS_HANDLER #yellow
            Message:
            {
                id: <transferMessage.transferId>
                from: <transferMessage.payerFsp>,
                to: <transferMessage.payeeFsp>,
                type: application/json
                content: {
                    headers: <transferHeaders>,
                    payload: <transferMessage>
                },
                metadata: {
                    event: {
                        id: <uuid>,
                        responseTo: <previous.uuid>,
                        type: transfer,
                        action: prepare,
                        createdAt: <timestamp>,
                        state: {
                            status: "success",
                            code: 0
                        }
                    }
                }
            }
        end note
        POS_HANDLER -> TOPIC_TRANSFERS: Publishes Transfer event
    else Position Handler consume batch Messages
        TOPIC_POSITION_DFSP1 -> POS_HANDLER: Consumes Position event batch of messages for Payer

        group Persist batch Event Information
            POS_HANDLER -> EVENT_DAO: Request to persist event information for batch of messages
            EVENT_DAO <-> DB: Persist event batch information
            EVENT_DAO -> POS_HANDLER: return success
        end

        group Persist Prepare Batch Transfer State with transferState='pending'
            POS_HANDLER -> TRANS_DAO: Request to persist batch transfer
            TRANS_DAO <-> DB: Persist batch transfer
            TRANS_DAO -> POS_HANDLER: return success
        end

        loop for each message in batch
            group Calculate position and persist change
                POS_HANDLER -> POS_DAO: Request latest position from DB for Payer
                POS_DAO <-> DB: Retrieves latest position from DB for Payer
                POS_DAO -> POS_HANDLER: Return latest position

                POS_HANDLER <-> POS_HANDLER: Calculates latest position (lpos) by incrementing transfer for prepare
                POS_HANDLER <-> POS_HANDLER: Validate Calculated latest position against the net-debit cap (netcap) - Rule: lpos < netcap
                
                POS_HANDLER -> POS_DAO: Request to persist latest position for Payer
                POS_DAO <-> DB: Persists latest position to DB for Payer
                POS_DAO -> POS_HANDLER: return success
            end
            note right of POS_HANDLER #yellow
                Message:
                {
                    id: <transferMessage.transferId>
                    from: <transferMessage.payerFsp>,
                    to: <transferMessage.payeeFsp>,
                    type: application/json
                    content: {
                        headers: <transferHeaders>,
                        payload: <transferMessage>
                    },
                    metadata: {
                        event: {
                            id: <uuid>,
                            responseTo: <previous.uuid>,
                            type: transfer,
                            action: prepare,
                            createdAt: <timestamp>,
                            state: {
                                status: "success",
                                code: 0
                            }
                        }
                    }
                }
            end note
            POS_HANDLER -> TOPIC_TRANSFERS: Publishes Transfer event
        end
    end
    deactivate POS_HANDLER

    activate TRANS_HANDLER
    alt Transfer Handler consume Single Message
        TOPIC_TRANSFERS -> TRANS_HANDLER: Consumes Transfer event
        group Persist Event Information
            TRANS_HANDLER -> EVENT_DAO: Request to persist event information
            EVENT_DAO <-> DB: Persist event information
            EVENT_DAO -> TRANS_HANDLER: return success
        end
        group Update Prepare Transfer State with transferState='accepted'
            TRANS_HANDLER -> TRANS_DAO: Request to update transfer
            TRANS_DAO <-> DB: Update transfer
            TRANS_DAO -> TRANS_HANDLER: return success
        end
        
        note right of TRANS_HANDLER #yellow
            Message:
            {
                id: <transferMessage.transferId>
                from: <transferMessage.payerFsp>,
                to: <transferMessage.payerFsp>,
                type: application/json
                content: {
                    headers: <transferHeaders>,
                    payload: <transferMessage>
                },
                metadata: {
                    event: {
                        id: <uuid>,
                        responseTo: <previous.uuid>,
                        type: notification,
                        action: prepare,
                        createdAt: <timestamp>,
                        state: {
                            status: "success",
                            code: 0
                        }
                    }
                }
            }
        end note
        TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payer
        note right of TRANS_HANDLER #yellow
            Message:
            {
                id: <transferMessage.transferId>
                from: <transferMessage.payerFsp>,
                to: <transferMessage.payeeFsp>,
                type: application/json
                content: {
                    headers: <transferHeaders>,
                    payload: <transferMessage>
                },
                metadata: {
                    event: {
                        id: <uuid>,
                        responseTo: <previous.uuid>,
                        type: notification,
                        action: prepare,
                        createdAt: <timestamp>,
                        state: {
                            status: "success",
                            code: 0
                        }
                    }
                }
            }
        end note
        TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payee
    else Transfer Handler consume batch Messages
        TOPIC_TRANSFERS -> TRANS_HANDLER: Consumes Transfer event batch of messages for Payer

        group Persist batch Event Information
            POS_HANDLER -> EVENT_DAO: Request to persist event information for batch of messages
            EVENT_DAO <-> DB: Persist event batch information
            EVENT_DAO -> POS_HANDLER: return success
        end

        group Update Prepare batch Transfer State with transferState='accepted'
            TRANS_HANDLER -> TRANS_DAO: Request to update batch transfer
            TRANS_DAO <-> DB: Update batch transfer
            TRANS_DAO -> TRANS_HANDLER: return success
        end

        loop for each message in batch
            note right of TRANS_HANDLER #yellow
                Message:
                {
                    id: <transferMessage.transferId>
                    from: <transferMessage.payerFsp>,
                    to: <transferMessage.payerFsp>,
                    type: application/json
                    content: {
                        headers: <transferHeaders>,
                        payload: <transferMessage>
                    },
                    metadata: {
                        event: {
                            id: <uuid>,
                            responseTo: <previous.uuid>,
                            type: notification,
                            action: prepare,
                            createdAt: <timestamp>,
                            state: {
                                status: "success",
                                code: 0
                            }
                        }
                    }
                }
            end note
            TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payer
            note right of TRANS_HANDLER #yellow
                Message:
                {
                    id: <transferMessage.transferId>
                    from: <transferMessage.payerFsp>,
                    to: <transferMessage.payeeFsp>,
                    type: application/json
                    content: {
                        headers: <transferHeaders>,
                        payload: <transferMessage>
                    },
                    metadata: {
                        event: {
                            id: <uuid>,
                            responseTo: <previous.uuid>,
                            type: notification,
                            action: prepare,
                            createdAt: <timestamp>,
                            state: {
                                status: "success",
                                code: 0
                            }
                        }
                    }
                }
            end note
            TRANS_HANDLER -> TOPIC_NOTIFICATIONS: Publishes Notifications event for Payee
        end
    end
    deactivate TRANS_HANDLER

    group Send notification for Payer
        activate NOTIFY_HANDLER
        alt Notifications Handler consume Single Message
            TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
            group Persist Event Information
                NOTIFY_HANDLER -> CSAPI: Requests to persist event information - POST - HTTP://events/
                CSAPI -> EVENT_DAO: Request to persist event information
                EVENT_DAO <-> DB: Persist event information
                EVENT_DAO -> CSAPI: return success
                CSAPI -> NOTIFY_HANDLER: return success
            end
            NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payer - GET - HTTP://notifications/DFPS1
            CSAPI -> NOTIFY_DAO: Fetches Notifications details for Payer
            NOTIFY_DAO <-> DB: Fetches Notifications details for Payer
            NOTIFY_DAO -> CSAPI: Returns Notifications details for Payer
            CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payer
            NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to Payer
        else Notifications Handler consume batch Messages
            TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event batch of messages for Payer
            group Persist batch Event Information
                NOTIFY_HANDLER -> CSAPI: Requests to persist batch event information - POST - HTTP://events/
                CSAPI -> EVENT_DAO: Request to persist batch event information
                EVENT_DAO <-> DB: Persist event information
                EVENT_DAO -> CSAPI: return success
                CSAPI -> NOTIFY_HANDLER: return success
            end
            loop for each message in batch
                NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payer - GET - HTTP://notifications/DFPS1
                CSAPI -> NOTIFY_DAO: Fetches Notifications details for Payer
                NOTIFY_DAO <-> DB: Fetches Notifications details for Payer
                NOTIFY_DAO -> CSAPI: Returns Notifications details for Payer
                CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payer
                NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to Payer
            end
        end
        deactivate NOTIFY_HANDLER
    end

    group Send notification for Payee
        activate NOTIFY_HANDLER
        alt Notifications Handler consume Single Message
            TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event
            group Persist Event Information
                NOTIFY_HANDLER -> CSAPI: Requests to persist event information - POST - HTTP://events/
                CSAPI -> EVENT_DAO: Request to persist event information
                EVENT_DAO <-> DB: Persist event information
                EVENT_DAO -> CSAPI: return success
                CSAPI -> NOTIFY_HANDLER: return success
            end
            NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payee - GET - HTTP://notifications/DFPS1
            CSAPI -> NOTIFY_DAO: Fetches Notifications details for Payee
            NOTIFY_DAO <-> DB: Fetches Notifications details for Payee
            NOTIFY_DAO -> CSAPI: Returns Notifications details for Payee
            CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payee
            NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to Payee
        else Notifications Handler consume batch Messages
            TOPIC_NOTIFICATIONS -> NOTIFY_HANDLER: Consumes Notifications event batch of messages for Payee
            group Persist batch Event Information
                NOTIFY_HANDLER -> CSAPI: Requests to persist batch event information - POST - HTTP://events/
                CSAPI -> EVENT_DAO: Request to persist batch event information
                EVENT_DAO <-> DB: Persist event information
                EVENT_DAO -> CSAPI: return success
                CSAPI -> NOTIFY_HANDLER: return success
            end
            loop for each message in batch
                NOTIFY_HANDLER -> CSAPI: Requests Notification details for Payee - GET - HTTP://notifications/DFPS1
                CSAPI -> NOTIFY_DAO: Fetches Notifications details for Payee
                NOTIFY_DAO <-> DB: Fetches Notifications details for Payee
                NOTIFY_DAO -> CSAPI: Returns Notifications details for Payee
                CSAPI -> NOTIFY_HANDLER: Returns Notifications details for Payee
                NOTIFY_HANDLER -> DFSP1: HTTP Callback with Prepare result to Payee
            end
        end
        deactivate NOTIFY_HANDLER
    end
end
@enduml

PlantUML version 1.2017.18(Fri Oct 06 18:56:32 SAST 2017)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_152-b16
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: ZA
--></g></svg>